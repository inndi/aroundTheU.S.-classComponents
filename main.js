!function(){"use strict";var e={937:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,s),r.exports}s.p="",function(){var e=s(937);const t=document.querySelector(".page"),i=t.querySelector(".profile"),n=i.querySelector(".profile__name"),r=i.querySelector(".profile__about-me"),o=i.querySelector(".profile__edit-btn"),a=i.querySelector(".profile__add-btn"),l=t.querySelector(".popup_edit"),c=t.querySelector(".popup_add"),d=t.querySelector(".popup_delete"),_=document.querySelector(".profile__photo"),h=document.querySelector(".popup_edit-photo"),p=h.querySelector(".popup__form"),u=document.querySelector(".profile__edit-avatar-btn"),m=document.querySelector(".popup_card"),k=(h.querySelector(".popup__input_field_link"),l.querySelector(".popup__form")),v=l.querySelector(".popup__input_field_name"),f=l.querySelector(".popup__input_field_about-me"),L=c.querySelector(".popup__form"),y=(c.querySelector(".popup__input_field_title"),c.querySelector(".popup__input_field_link"),t.querySelector(".cards__list"));class C{constructor(e,t){this._formSelector=e.formSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._buttonElement=this._formElement.querySelector(e.submitButtonSelector)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableButton():(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class b{constructor(e){E(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),E(this,"_handleClickClose",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-btn")&&this.close()})),this._popup=e}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}setEventListeners(){this._popup.addEventListener("mousedown",this._handleClickClose)}}class g extends b{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._fields=this._popup.querySelectorAll(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn"),this._saveButtonText=this._saveBtn.textContent}getInputValues(){const e={};return this._fields.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack()})),super.setEventListeners()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._saveBtn.textContent=e?t:this._saveButtonText}close(){super.close(),this._popupForm.reset()}}class S{constructor(e){let{cardData:t,userId:s,cardTemplate:i,handleCardClick:n,handleBinClick:r,handleLikeClick:o}=e;var a,l;l=()=>{this._element.remove()},(a="handleDeleteButton")in this?Object.defineProperty(this,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):this[a]=l,this._name=t.name,this._link=t.link,this._handleCardClick=n,this._cardTemplate=i,this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__img"),this._cardTitle=this._element.querySelector(".card__title"),this._likeButton=this._element.querySelector(".card__like-btn"),this._likesAmount=this._element.querySelector(".card__likes-amount"),this._deleteButton=this._element.querySelector(".card__delete-btn"),this._handleBinClick=r,this._handleLikeClick=o,this._mineCard=t.isMine,this._myNewCard=t.myNewCard,this._cardLikes=t.likes,this._initialLikes=t.likes.length,this._userId=s}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".card").cloneNode(!0)}createCard(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._handleLikeInitAmount(),this._addDeleteButton(),this._checkLikes(),this._element}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeClick),this._deleteButton.addEventListener("click",this._handleBinClick),this._cardImage.addEventListener("mousedown",this._handleCardClick)}_updateLikes(e){this._likesAmount.textContent=e.length,this._cardLikes=e}addLike(e){this._likeButton.classList.add("card__like-btn_active"),this._updateLikes(e)}removeLike(e){this._likeButton.classList.remove("card__like-btn_active"),this._updateLikes(e)}isLiked(){return this._cardLikes.some((e=>e._id===this._userId))}_handleLikeInitAmount(){this._likesAmount.textContent=this._initialLikes}_addDeleteButton(){(this._mineCard||this._myNewCard)&&this._deleteButton.classList.add("card__delete-btn_active")}_checkLikes(){this._cardLikes.forEach((e=>{e._id===this._userId&&this._likeButton.classList.add("card__like-btn_active")}))}}document.getElementById("header-logo").src=e;const I={};I.name=n,I.info=r,I.avatar=_,I.popupFieldName=v,I.popupFieldInfo=f;const B=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}getMyProfile(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}delete(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}postNewCardData(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}patchProfileData(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.profileName,about:e.profileAbout})}).then(this._checkResponse)}patchAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatarLink})}).then(this._checkResponse)}removeLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"2f92e6f8-d3bf-4f0b-b7c9-ecb844a65d7b","Content-Type":"application/json"}}),q={};var w;w={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(w.formSelector)).forEach((e=>{const t=new C(w,e),s=e.getAttribute("name");q[s]=t,t.enableValidation()}));const A=new class extends b{constructor(e){super(e),this._popupCardImage=this._popup.querySelector(".popup__card-img"),this._popupCardTitle=this._popup.querySelector(".popup__card-title")}open(e){this._popupCardImage.src=e.link,this._popupCardImage.alt=e.name,this._popupCardTitle.textContent=e.name,super.open()}}(m);A.setEventListeners();const x=new class extends b{constructor(e){super(e),this._yesBtn=this._popup.querySelector(".popup__save-btn")}close(){super.close(),this._onDelete&&(this.removeEventListeners(this._onDelete),this._onDelete=null)}setEventListeners(e){this._onDelete=e,this._onDelete&&this._yesBtn.addEventListener("click",this._onDelete),super.setEventListeners()}removeEventListeners(e){this._yesBtn.removeEventListener("click",e)}}(d);x.setEventListeners();const T=new class{constructor(e){this._fieldName=e.name,this._fieldInfo=e.info,this._photoContainer=e.avatar}getUserInfo(){const e={};return e.name=this._fieldName.textContent,e.about=this._fieldInfo.textContent,e}setUserInfo(e){this._userId=e._id,this._photoContainer.src=e.avatar,this._fieldName.textContent=e.name,this._fieldInfo.textContent=e.about}}(I);function D(e,t){const s=new S({cardData:e,userId:t,cardTemplate:"#card-template",handleCardClick:()=>{A.open(e)},handleBinClick:()=>{x.open();const t=()=>B.delete(e._id).then((()=>{s.handleDeleteButton(),x.close(),x.removeEventListeners(t)})).catch((e=>{console.log(e)}));x.setEventListeners(t)},handleLikeClick:()=>{s.isLiked()?B.removeLike(e._id).then((e=>{s.removeLike(e.likes)})).catch((e=>{console.log(e)})):B.addLike(e._id).then((e=>{s.addLike(e.likes)})).catch((e=>{console.log(e)}))}});return s.createCard()}const U=new class{constructor(e,t){let{renderer:s}=e;this.renderer=s,this._container=t}_clear(){this._container.innerHTML=""}addPrependItem(e){this._container.prepend(e)}addAppendItem(e){this._container.append(e)}}({renderer:(e,t)=>{if(e.myNewCard){const s=D(e,t);U.addPrependItem(s)}else{const s=D(e,t);U.addAppendItem(s)}}},y),N=new g({somePopup:h,callBack:()=>{N.renderLoading(!0);const e=N.getInputValues();B.patchAvatar(e).then((e=>{T.setUserInfo(e),N.close()})).catch((e=>{console.log(e)})).finally((function(){N.renderLoading(!1)}))}});N.setEventListeners();const P=new g({somePopup:l,callBack:()=>{P.renderLoading(!0);const e=P.getInputValues();B.patchProfileData(e).then((e=>{T.setUserInfo(e),P.close()})).catch((e=>{console.log(e)})).finally((function(){P.renderLoading(!1)}))}});P.setEventListeners();const V=new g({somePopup:c,callBack:()=>{V.renderLoading(!0,"Creating...");const e=V.getInputValues(),t={};t.name=e.placeTitle,t.link=e.placeLink,B.postNewCardData(t).then((e=>{e.myNewCard=!0,U.renderer(e,e.owner._id),V.close()})).catch((e=>{console.log(e)})).finally((function(){V.renderLoading(!1)}))}});V.setEventListeners(),a.addEventListener("click",(()=>{q[L.getAttribute("name")].resetValidation(),V.open()})),u.addEventListener("click",(()=>{q[p.getAttribute("name")].resetValidation(),N.open()})),o.addEventListener("click",(()=>{q[k.getAttribute("name")].resetValidation();const e=T.getUserInfo();I.popupFieldName.value=e.name,I.popupFieldInfo.value=e.about,P.open()})),(async()=>{const e=await B.getMyProfile();T.setUserInfo(e),(await B.getInitialCards()).forEach((t=>{t.owner._id===e._id&&(t.isMine=!0),U.renderer(t,e._id)}))})()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWMsRUFBTSxlQUVyQyxNQUFNa0ksRUFBWUQsRUFBaUJ0SSxpQkFDN0J3SSxFQUFVLEdBQ2hCQSxFQUFRckksS0FBT29JLEVBQVVFLFdBQ3pCRCxFQUFRckgsS0FBT29ILEVBQVVHLFVBRXpCOUUsRUFBSW9CLGdCQUFnQndELEdBQ2pCN0QsTUFBTU0sSUFDTEEsRUFBS2hELFdBQVksRUFFakJzRixFQUFhRSxTQUFTeEMsRUFBTUEsRUFBSzBELE1BQU12RixLQUN2Q2tGLEVBQWlCdkosV0FFbEJvSSxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixNQUViZ0IsU0FBUSxXQUNQRSxFQUFpQmpJLGVBQWMsU0FJdkNpSSxFQUFpQmhKLG9CQUVqQjFFLEVBQVVvQyxpQkFBaUIsU0FBUyxLQUNsQzRJLEVBQWVwSyxFQUFhd0ssYUFBYSxTQUFTckgsa0JBRWxEMkosRUFBaUJuSixVQUduQmhFLEVBQWM2QixpQkFBaUIsU0FBUyxLQUN0QzRJLEVBQWUxSyxFQUFpQjhLLGFBQWEsU0FBU3JILGtCQUV0RHVKLEVBQXdCL0ksVUFHMUJ4RSxFQUFXcUMsaUJBQWlCLFNBQVMsS0FDbkM0SSxFQUFldkssRUFBYzJLLGFBQWEsU0FBU3JILGtCQUVuRCxNQUFNaUssRUFBV2xDLEVBQVNJLGNBQzFCdkQsRUFBZUcsZUFBZXRELE1BQVF3SSxFQUFTekksS0FDL0NvRCxFQUFlSSxlQUFldkQsTUFBUXdJLEVBQVN0RCxNQUUvQytDLEVBQWtCbEosVUFHSjBKLFdBQ2QsTUFBTTVCLFFBQWFyRCxFQUFJZ0IsZUFFdkI4QixFQUFTTSxZQUFZQyxVQUVEckQsRUFBSWEsbUJBRWxCcEgsU0FBUzRILElBQ1RBLEVBQUswRCxNQUFNdkYsTUFBUTZELEVBQUs3RCxNQUMxQjZCLEVBQUtsRCxRQUFTLEdBRWhCd0YsRUFBYUUsU0FBU3hDLEVBQU1nQyxFQUFLN0QsU0FLckMwRixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NvbmZpcm1hdGlvblBvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJyk7XG5cbmNvbnN0IHByb2ZpbGUgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlJyk7XG5jb25zdCBwcm9maWxlTmFtZSA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX25hbWUnKTtcbmNvbnN0IHByb2ZpbGVJbmZvID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWJvdXQtbWUnKTtcbmNvbnN0IGVkaXRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ0bicpO1xuY29uc3QgYWRkQnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ0bicpO1xuXG5jb25zdCBwb3B1cEVkaXQgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9lZGl0Jyk7XG5jb25zdCBwb3B1cEFkZCA9IGJvZHkucXVlcnlTZWxlY3RvcignLnBvcHVwX2FkZCcpO1xuY29uc3QgcG9wdXBEZWxldGUgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9kZWxldGUnKTtcblxuY29uc3QgcGhvdG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcGhvdG8nKTtcbmNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9lZGl0LXBob3RvJyk7XG5jb25zdCBwb3B1cEVkaXRBdmFGb3JtID0gcG9wdXBFZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuY29uc3QgZWRpdEF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWF2YXRhci1idG4nKTtcblxuY29uc3QgcG9wdXBDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2NhcmQnKTtcblxuY29uc3QgcG9wdXBBdmF0YXJMaW5rID0gcG9wdXBFZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfbGluaycpO1xuXG5jb25zdCBwb3B1cEVkaXRGb3JtID0gcG9wdXBFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuY29uc3QgZmllbGROYW1lID0gcG9wdXBFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfbmFtZScpO1xuY29uc3QgZmllbGRBYm91dE1lID0gcG9wdXBFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfYWJvdXQtbWUnKTtcblxuY29uc3QgcG9wdXBBZGRGb3JtID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG5jb25zdCBwb3B1cEFkZFRpdGxlID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF90aXRsZScpO1xuY29uc3QgcG9wdXBBZGRMaW5rID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF9saW5rJyk7XG5cbmNvbnN0IGNhcmRzTGlzdCA9IGJvZHkucXVlcnlTZWxlY3RvcignLmNhcmRzX19saXN0Jyk7XG5cbmNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc2F2ZS1idG5cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZS1idG5fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcblxuZXhwb3J0IHtcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVJbmZvLFxuICBlZGl0QnV0dG9uLFxuICBhZGRCdXR0b24sXG4gIHBvcHVwRWRpdCxcbiAgcG9wdXBBZGQsXG4gIHBvcHVwQ2FyZCxcbiAgcG9wdXBFZGl0Rm9ybSxcbiAgZmllbGROYW1lLFxuICBmaWVsZEFib3V0TWUsXG4gIHBvcHVwQWRkRm9ybSxcbiAgY2FyZHNMaXN0LFxuICB2YWxpZGF0aW9uQ29uZmlnLFxuICBwb3B1cERlbGV0ZSxcbiAgcGhvdG9Db250YWluZXIsXG4gIHBvcHVwRWRpdEF2YXRhcixcbiAgZWRpdEF2YXRhckJ0bixcbiAgcG9wdXBFZGl0QXZhRm9ybSxcbiAgcG9wdXBBZGRUaXRsZSxcbiAgcG9wdXBBZGRMaW5rLFxuICBwb3B1cEF2YXRhckxpbmtcbn07IiwiXG5leHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9ycywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZWxlY3RvcnMuZm9ybVNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZWxlY3RvcnMuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZWxlY3RvcnMuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZWxlY3RvcnMuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMuaW5wdXRTZWxlY3RvcikpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHsgZXZ0LnByZXZlbnREZWZhdWx0KCkgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBidXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9O1xuICB9O1xuXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9O1xuICB9O1xuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9O1xufVxuIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc29tZVBvcHVwKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBzb21lUG9wdXA7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gIH1cblxuICBfaGFuZGxlQ2xpY2tDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1idG4nKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcbiAgfVxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgc29tZVBvcHVwLCBjYWxsQmFjayB9KSB7XG4gICAgc3VwZXIoc29tZVBvcHVwKTtcbiAgICB0aGlzLl9jYWxsQmFjayA9IGNhbGxCYWNrO1xuICAgIHRoaXMuX2ZpZWxkcyA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICB0aGlzLl9zYXZlQnRuID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xuICAgIHRoaXMuX3NhdmVCdXR0b25UZXh0ID0gdGhpcy5fc2F2ZUJ0bi50ZXh0Q29udGVudDtcbiAgfVxuICBnZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBmaWVsZHNMaXN0ID0ge307XG5cbiAgICB0aGlzLl9maWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgIGZpZWxkc0xpc3RbZmllbGQubmFtZV0gPSBmaWVsZC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBmaWVsZHNMaXN0O1xuICB9XG5cblxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fY2FsbEJhY2soKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gJ1NhdmluZy4uLicpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zYXZlQnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NhdmVCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG5cbiAgY29uc3RydWN0b3IoeyBjYXJkRGF0YSwgdXNlcklkLCBjYXJkVGVtcGxhdGUsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlQmluQ2xpY2ssIGhhbmRsZUxpa2VDbGljayB9KSB7XG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGNhcmRUZW1wbGF0ZTtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWcnKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ0bicpO1xuICAgIHRoaXMuX2xpa2VzQW1vdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZXMtYW1vdW50Jyk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ0bicpO1xuICAgIHRoaXMuX2hhbmRsZUJpbkNsaWNrID0gaGFuZGxlQmluQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX21pbmVDYXJkID0gY2FyZERhdGEuaXNNaW5lO1xuICAgIHRoaXMuX215TmV3Q2FyZCA9IGNhcmREYXRhLm15TmV3Q2FyZDtcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSBjYXJkRGF0YS5saWtlcztcbiAgICB0aGlzLl9pbml0aWFsTGlrZXMgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRUZW1wbGF0ZSlcbiAgICAgIC5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VJbml0QW1vdW50KCk7XG4gICAgdGhpcy5fYWRkRGVsZXRlQnV0dG9uKCk7XG4gICAgdGhpcy5fY2hlY2tMaWtlcygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUxpa2VDbGljayk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlQmluQ2xpY2spO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xuICB9XG5cbiAgX3VwZGF0ZUxpa2VzKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXNBbW91bnQudGV4dENvbnRlbnQgPSBsaWtlcy5sZW5ndGg7XG4gICAgdGhpcy5fY2FyZExpa2VzID0gbGlrZXM7XG4gIH1cblxuICBhZGRMaWtlKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcbiAgICB0aGlzLl91cGRhdGVMaWtlcyhsaWtlcyk7XG4gIH1cblxuICByZW1vdmVMaWtlKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcbiAgICB0aGlzLl91cGRhdGVMaWtlcyhsaWtlcyk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIGNvbnN0IGlzTXlMaWtlID0gdGhpcy5fY2FyZExpa2VzLnNvbWUobGlrZSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgICByZXR1cm4gaXNNeUxpa2U7XG4gIH1cblxuICBfaGFuZGxlTGlrZUluaXRBbW91bnQoKSB7XG4gICAgdGhpcy5fbGlrZXNBbW91bnQudGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsTGlrZXM7XG4gIH1cblxuICBfYWRkRGVsZXRlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl9taW5lQ2FyZCB8fCB0aGlzLl9teU5ld0NhcmQpIHtcbiAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19kZWxldGUtYnRuX2FjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZURlbGV0ZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgX2NoZWNrTGlrZXMoKSB7XG4gICAgdGhpcy5fY2FyZExpa2VzLmZvckVhY2goKGxpa2UpID0+IHtcbiAgICAgIGlmIChsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idG5fYWN0aXZlJyk7XG4gICAgICB9O1xuICAgIH0pXG4gIH1cbn0iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IGhlYWRlckxvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xuXG5jb25zdCBoZWFkZXJMb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWFkZXItbG9nb1wiKTtcbmhlYWRlckxvZ28uc3JjID0gaGVhZGVyTG9nb1NyYztcblxuaW1wb3J0IHtcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVJbmZvLFxuICBlZGl0QnV0dG9uLFxuICBhZGRCdXR0b24sXG4gIHBvcHVwRWRpdCxcbiAgcG9wdXBBZGQsXG4gIHBvcHVwQ2FyZCxcbiAgcG9wdXBFZGl0Rm9ybSxcbiAgZmllbGROYW1lLFxuICBmaWVsZEFib3V0TWUsXG4gIHBvcHVwQWRkRm9ybSxcbiAgY2FyZHNMaXN0LFxuICB2YWxpZGF0aW9uQ29uZmlnLFxuICBwb3B1cERlbGV0ZSxcbiAgcGhvdG9Db250YWluZXIsXG4gIHBvcHVwRWRpdEF2YXRhcixcbiAgZWRpdEF2YXRhckJ0bixcbiAgcG9wdXBFZGl0QXZhRm9ybSxcbn0gZnJvbSAnLi4vc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMnO1xuXG5jb25zdCB1c2VyRGF0YUZpZWxkcyA9IHt9O1xudXNlckRhdGFGaWVsZHMubmFtZSA9IHByb2ZpbGVOYW1lO1xudXNlckRhdGFGaWVsZHMuaW5mbyA9IHByb2ZpbGVJbmZvO1xudXNlckRhdGFGaWVsZHMuYXZhdGFyID0gcGhvdG9Db250YWluZXI7XG51c2VyRGF0YUZpZWxkcy5wb3B1cEZpZWxkTmFtZSA9IGZpZWxkTmFtZTtcbnVzZXJEYXRhRmllbGRzLnBvcHVwRmllbGRJbmZvID0gZmllbGRBYm91dE1lO1xuXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VzLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XG5pbXBvcnQgeyBDb25maXJtYXRpb25Qb3B1cCB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ29uZmlybWF0aW9uUG9wdXAuanNcIjtcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcbmltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjJmOTJlNmY4LWQzYmYtNGYwYi1iN2M5LWVjYjg0NGE2NWQ3YlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gIH1cbn0pO1xuXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKTtcblxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XG5cbmNvbnN0IHBvcHVwQ2FyZFJlbmRlcmVyID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwQ2FyZCk7XG5wb3B1cENhcmRSZW5kZXJlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cERlbGV0ZVJlbmRlcmVyID0gbmV3IENvbmZpcm1hdGlvblBvcHVwKHBvcHVwRGVsZXRlKTtcbnBvcHVwRGVsZXRlUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh1c2VyRGF0YUZpZWxkcyk7XG5cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtLCB1c2VySWQpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBjYXJkRGF0YTogaXRlbSxcbiAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICBjYXJkVGVtcGxhdGU6ICcjY2FyZC10ZW1wbGF0ZScsXG4gICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XG4gICAgICBwb3B1cENhcmRSZW5kZXJlci5vcGVuKGl0ZW0pO1xuICAgIH0sXG4gICAgaGFuZGxlQmluQ2xpY2s6ICgpID0+IHtcbiAgICAgIHBvcHVwRGVsZXRlUmVuZGVyZXIub3BlbigpO1xuXG4gICAgICBjb25zdCBvbkRlbGV0ZSA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGFwaS5kZWxldGUoaXRlbS5faWQpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVCdXR0b24oKTtcbiAgICAgICAgICAgIHBvcHVwRGVsZXRlUmVuZGVyZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIHBvcHVwRGVsZXRlUmVuZGVyZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcnMob25EZWxldGUpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHBvcHVwRGVsZXRlUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMob25EZWxldGUpO1xuICAgIH0sXG4gICAgaGFuZGxlTGlrZUNsaWNrOiAoKSA9PiB7XG4gICAgICBjb25zdCBpc015TGlrZSA9IGNhcmQuaXNMaWtlZCgpO1xuICAgICAgaWYgKGlzTXlMaWtlKSB7XG4gICAgICAgIGFwaS5yZW1vdmVMaWtlKGl0ZW0uX2lkKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlTGlrZShyZXMubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGkuYWRkTGlrZShpdGVtLl9pZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmFkZExpa2UocmVzLmxpa2VzKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgfSk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5jcmVhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudFxufVxuXG5jb25zdCBjYXJkUmVuZGVyZXIgPSBuZXcgU2VjdGlvbih7XG4gIHJlbmRlcmVyOiAoaXRlbSwgdXNlcklkKSA9PiB7XG4gICAgaWYgKGl0ZW0ubXlOZXdDYXJkKSB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSwgdXNlcklkKTtcbiAgICAgIGNhcmRSZW5kZXJlci5hZGRQcmVwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtLCB1c2VySWQpO1xuICAgICAgY2FyZFJlbmRlcmVyLmFkZEFwcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgIH1cbiAgfVxufSwgY2FyZHNMaXN0KTtcblxuXG5jb25zdCBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlciA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgc29tZVBvcHVwOiBwb3B1cEVkaXRBdmF0YXIsXG4gIGNhbGxCYWNrOiAoKSA9PiB7XG4gICAgcG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBjb25zdCBmaWVsZFZhbHVlID0gcG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIuZ2V0SW5wdXRWYWx1ZXMoKTtcblxuICAgIGFwaS5wYXRjaEF2YXRhcihmaWVsZFZhbHVlKVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XG4gICAgICAgIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG4gIH1cbn0pO1xucG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuXG5cbmNvbnN0IGVkaXRQb3B1cEJlaGF2aW9yID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBzb21lUG9wdXA6IHBvcHVwRWRpdCxcbiAgY2FsbEJhY2s6ICgpID0+IHtcbiAgICBlZGl0UG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKHRydWUpO1xuXG4gICAgY29uc3QgZWRpdEZpZWxkcyA9IGVkaXRQb3B1cEJlaGF2aW9yLmdldElucHV0VmFsdWVzKCk7XG5cbiAgICBhcGkucGF0Y2hQcm9maWxlRGF0YShlZGl0RmllbGRzKVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XG4gICAgICAgIGVkaXRQb3B1cEJlaGF2aW9yLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVkaXRQb3B1cEJlaGF2aW9yLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG5cbiAgfVxuXG59KTtcbmVkaXRQb3B1cEJlaGF2aW9yLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZFBvcHVwQmVoYXZpb3IgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHNvbWVQb3B1cDogcG9wdXBBZGQsXG4gIGNhbGxCYWNrOiAoKSA9PiB7XG4gICAgYWRkUG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKHRydWUsICdDcmVhdGluZy4uLicpO1xuXG4gICAgY29uc3QgYWRkRmllbGRzID0gYWRkUG9wdXBCZWhhdmlvci5nZXRJbnB1dFZhbHVlcygpO1xuICAgIGNvbnN0IG5ld0NhcmQgPSB7fTtcbiAgICBuZXdDYXJkLm5hbWUgPSBhZGRGaWVsZHMucGxhY2VUaXRsZTtcbiAgICBuZXdDYXJkLmxpbmsgPSBhZGRGaWVsZHMucGxhY2VMaW5rO1xuXG4gICAgYXBpLnBvc3ROZXdDYXJkRGF0YShuZXdDYXJkKVxuICAgICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgY2FyZC5teU5ld0NhcmQgPSB0cnVlO1xuXG4gICAgICAgIGNhcmRSZW5kZXJlci5yZW5kZXJlcihjYXJkLCBjYXJkLm93bmVyLl9pZCk7XG4gICAgICAgIGFkZFBvcHVwQmVoYXZpb3IuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYWRkUG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9XG59KTtcbmFkZFBvcHVwQmVoYXZpb3Iuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEFkZEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIGFkZFBvcHVwQmVoYXZpb3Iub3BlbigpO1xufSk7XG5cbmVkaXRBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW3BvcHVwRWRpdEF2YUZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLm9wZW4oKTtcbn0pO1xuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEVkaXRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcblxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHVzZXJEYXRhRmllbGRzLnBvcHVwRmllbGROYW1lLnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgdXNlckRhdGFGaWVsZHMucG9wdXBGaWVsZEluZm8udmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcblxuICBlZGl0UG9wdXBCZWhhdmlvci5vcGVuKCk7XG59KTtcblxuY29uc3QgaW5pdEFwcCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGFwaS5nZXRNeVByb2ZpbGUoKTtcblxuICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcblxuICBjb25zdCBjYXJkcyA9IGF3YWl0IGFwaS5nZXRJbml0aWFsQ2FyZHMoKTtcblxuICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgaWYgKGNhcmQub3duZXIuX2lkID09PSB1c2VyLl9pZCkge1xuICAgICAgY2FyZC5pc01pbmUgPSB0cnVlO1xuICAgIH1cbiAgICBjYXJkUmVuZGVyZXIucmVuZGVyZXIoY2FyZCwgdXNlci5faWQpXG4gIH0pO1xufTtcblxuXG5pbml0QXBwKCk7IiwiZXhwb3J0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGZldGNoRGF0YSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBmZXRjaERhdGEuYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gZmV0Y2hEYXRhLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRNeVByb2ZpbGUoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBwb3N0TmV3Q2FyZERhdGEoY2FyZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxuICAgICAgICBsaW5rOiBjYXJkLmxpbmtcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcGF0Y2hQcm9maWxlRGF0YShlZGl0RmllbGRzKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZWRpdEZpZWxkcy5wcm9maWxlTmFtZSxcbiAgICAgICAgYWJvdXQ6IGVkaXRGaWVsZHMucHJvZmlsZUFib3V0XG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBhdGNoQXZhdGFyKGZpZWxkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogZmllbGQuYXZhdGFyTGluayxcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZShpdGVtSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpdGVtSWR9YCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRMaWtlKGl0ZW1JZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2l0ZW1JZH1gLCB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihzb21lUG9wdXApIHtcbiAgICBzdXBlcihzb21lUG9wdXApO1xuICAgIHRoaXMuX3BvcHVwQ2FyZEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXJkLWltZycpO1xuICAgIHRoaXMuX3BvcHVwQ2FyZFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXJkLXRpdGxlJyk7XG4gIH1cblxuICBvcGVuKGl0ZW0pIHtcbiAgICB0aGlzLl9wb3B1cENhcmRJbWFnZS5zcmMgPSBpdGVtLmxpbms7XG4gICAgdGhpcy5fcG9wdXBDYXJkSW1hZ2UuYWx0ID0gaXRlbS5uYW1lO1xuICAgIHRoaXMuX3BvcHVwQ2FyZFRpdGxlLnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfTtcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBDb25maXJtYXRpb25Qb3B1cCBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc29tZVBvcHVwKSB7XG4gICAgc3VwZXIoc29tZVBvcHVwKTtcbiAgICB0aGlzLl95ZXNCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICBpZiAodGhpcy5fb25EZWxldGUpIHtcbiAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnModGhpcy5fb25EZWxldGUpO1xuICAgICAgdGhpcy5fb25EZWxldGUgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKG9uRGVsZXRlKSB7XG4gICAgdGhpcy5fb25EZWxldGUgPSBvbkRlbGV0ZTtcbiAgICBpZiAodGhpcy5fb25EZWxldGUpIHtcbiAgICAgIHRoaXMuX3llc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uRGVsZXRlKTtcbiAgICB9XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuICB9XG5cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMob25EZWxldGUpIHtcbiAgICB0aGlzLl95ZXNCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkRlbGV0ZSk7XG4gIH1cbn0iLCJcbmV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHVzZXJEYXRhRmllbGRzKSB7XG4gICAgdGhpcy5fZmllbGROYW1lID0gdXNlckRhdGFGaWVsZHMubmFtZTtcbiAgICB0aGlzLl9maWVsZEluZm8gPSB1c2VyRGF0YUZpZWxkcy5pbmZvO1xuICAgIHRoaXMuX3Bob3RvQ29udGFpbmVyID0gdXNlckRhdGFGaWVsZHMuYXZhdGFyO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdXNlckluZm9MaXN0ID0ge307XG4gICAgdXNlckluZm9MaXN0Lm5hbWUgPSB0aGlzLl9maWVsZE5hbWUudGV4dENvbnRlbnQ7XG4gICAgdXNlckluZm9MaXN0LmFib3V0ID0gdGhpcy5fZmllbGRJbmZvLnRleHRDb250ZW50O1xuICAgIHJldHVybiB1c2VySW5mb0xpc3Q7XG4gIH1cblxuICBzZXRVc2VySW5mbyh1c2VyKSB7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlci5faWQ7XG4gICAgdGhpcy5fcGhvdG9Db250YWluZXIuc3JjID0gdXNlci5hdmF0YXI7XG4gICAgdGhpcy5fZmllbGROYW1lLnRleHRDb250ZW50ID0gdXNlci5uYW1lO1xuICAgIHRoaXMuX2ZpZWxkSW5mby50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gIH1cbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIF9jbGVhcigpIHtcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgfVxuXG4gIGFkZFByZXBlbmRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxuXG4gIGFkZEFwcGVuZEl0ZW0oaXRlbSkge1xuXG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChpdGVtKTtcblxuICB9XG59OyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInAiLCJib2R5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUluZm8iLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwicG9wdXBFZGl0IiwicG9wdXBBZGQiLCJwb3B1cERlbGV0ZSIsInBob3RvQ29udGFpbmVyIiwicG9wdXBFZGl0QXZhdGFyIiwicG9wdXBFZGl0QXZhRm9ybSIsImVkaXRBdmF0YXJCdG4iLCJwb3B1cENhcmQiLCJwb3B1cEVkaXRGb3JtIiwiZmllbGROYW1lIiwiZmllbGRBYm91dE1lIiwicG9wdXBBZGRGb3JtIiwiY2FyZHNMaXN0IiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwic2VsZWN0b3JzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZGlzYWJsZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJfaGFzSW52YWxpZElucHV0IiwicmVtb3ZlIiwicmVtb3ZlQXR0cmlidXRlIiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInNvbWVQb3B1cCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZUNsaWNrQ2xvc2UiLCJQb3B1cFdpdGhGb3JtIiwiY2FsbEJhY2siLCJzdXBlciIsIl9jYWxsQmFjayIsIl9maWVsZHMiLCJfcG9wdXBGb3JtIiwiX3NhdmVCdG4iLCJfc2F2ZUJ1dHRvblRleHQiLCJnZXRJbnB1dFZhbHVlcyIsImZpZWxkc0xpc3QiLCJmaWVsZCIsIm5hbWUiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsInJlc2V0IiwiQ2FyZCIsImNhcmREYXRhIiwidXNlcklkIiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQmluQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfZWxlbWVudCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUNhcmRDbGljayIsIl9jYXJkVGVtcGxhdGUiLCJfZ2V0VGVtcGxhdGUiLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsIl9saWtlQnV0dG9uIiwiX2xpa2VzQW1vdW50IiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVCaW5DbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfbWluZUNhcmQiLCJpc01pbmUiLCJfbXlOZXdDYXJkIiwibXlOZXdDYXJkIiwiX2NhcmRMaWtlcyIsImxpa2VzIiwiX2luaXRpYWxMaWtlcyIsImxlbmd0aCIsIl91c2VySWQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY3JlYXRlQ2FyZCIsInNyYyIsImFsdCIsIl9oYW5kbGVMaWtlSW5pdEFtb3VudCIsIl9hZGREZWxldGVCdXR0b24iLCJfY2hlY2tMaWtlcyIsIl91cGRhdGVMaWtlcyIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiaXNMaWtlZCIsImxpa2UiLCJfaWQiLCJnZXRFbGVtZW50QnlJZCIsImhlYWRlckxvZ29TcmMiLCJ1c2VyRGF0YUZpZWxkcyIsImluZm8iLCJhdmF0YXIiLCJwb3B1cEZpZWxkTmFtZSIsInBvcHVwRmllbGRJbmZvIiwiYXBpIiwiZmV0Y2hEYXRhIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0TXlQcm9maWxlIiwiZGVsZXRlIiwiY2FyZElkIiwibWV0aG9kIiwicG9zdE5ld0NhcmREYXRhIiwiY2FyZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXRjaFByb2ZpbGVEYXRhIiwiZWRpdEZpZWxkcyIsImFib3V0IiwicHJvZmlsZUFib3V0IiwicGF0Y2hBdmF0YXIiLCJhdmF0YXJMaW5rIiwiaXRlbUlkIiwiYXV0aG9yaXphdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiY29uZmlnIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJwb3B1cENhcmRSZW5kZXJlciIsIl9wb3B1cENhcmRJbWFnZSIsIl9wb3B1cENhcmRUaXRsZSIsIml0ZW0iLCJwb3B1cERlbGV0ZVJlbmRlcmVyIiwiX3llc0J0biIsIl9vbkRlbGV0ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXJzIiwib25EZWxldGUiLCJ1c2VySW5mbyIsIl9maWVsZE5hbWUiLCJfZmllbGRJbmZvIiwiX3Bob3RvQ29udGFpbmVyIiwiZ2V0VXNlckluZm8iLCJ1c2VySW5mb0xpc3QiLCJzZXRVc2VySW5mbyIsInVzZXIiLCJoYW5kbGVEZWxldGVCdXR0b24iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjYXJkUmVuZGVyZXIiLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9jb250YWluZXIiLCJfY2xlYXIiLCJpbm5lckhUTUwiLCJhZGRQcmVwZW5kSXRlbSIsInByZXBlbmQiLCJhZGRBcHBlbmRJdGVtIiwiYXBwZW5kIiwiY2FyZEVsZW1lbnQiLCJwb3B1cEVkaXRBdmF0YXJSZW5kZXJlciIsImZpZWxkVmFsdWUiLCJmaW5hbGx5IiwiZWRpdFBvcHVwQmVoYXZpb3IiLCJhZGRQb3B1cEJlaGF2aW9yIiwiYWRkRmllbGRzIiwibmV3Q2FyZCIsInBsYWNlVGl0bGUiLCJwbGFjZUxpbmsiLCJvd25lciIsInVzZXJEYXRhIiwiYXN5bmMiLCJpbml0QXBwIl0sInNvdXJjZVJvb3QiOiIifQ==