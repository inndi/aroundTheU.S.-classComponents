!function(){"use strict";var e={937:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.p="",function(){var e=s(937);const t=document.querySelector(".page"),r=t.querySelector(".profile"),n=r.querySelector(".profile__name"),i=r.querySelector(".profile__about-me"),o=r.querySelector(".profile__edit-btn"),a=r.querySelector(".profile__add-btn"),l=t.querySelector(".popup_edit"),c=t.querySelector(".popup_add"),p=t.querySelector(".popup_delete"),h=document.querySelector(".profile__photo"),u=document.querySelector(".popup_edit-photo"),d=document.querySelector(".profile__edit-avatar-btn"),_=p.querySelector(".popup__save-btn"),m=document.querySelector(".popup_card"),v=l.querySelector(".popup__form"),k=l.querySelector(".popup__input_field_name"),f=l.querySelector(".popup__input_field_about-me"),C=c.querySelector(".popup__form"),b=t.querySelector(".cards__list");class L{constructor(e,t){this._formSelector=e.formSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._buttonElement=this._formElement.querySelector(e.submitButtonSelector)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableButton():(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class y{constructor(e){E(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),E(this,"_handleClickClose",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-btn")&&this.close()})),this._popup=e}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}setEventListeners(){this._popup.addEventListener("mousedown",this._handleClickClose)}}class g extends y{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._fields=this._popup.querySelectorAll(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn")}getInputValues(){const e={};return this._fields.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack(this._saveBtn)})),super.setEventListeners()}open(){super.setEventListeners(),this._popup.classList.add("popup_opened")}switchBtnToCreate(){this._saveBtn.textContent="Create"}switchBtnToSave(){this._saveBtn.textContent="Save"}close(){super.close(),this._popupForm.reset()}}class S{constructor(e){let{cardData:t,cardTemplate:s,handleCardClick:r,handleBinClick:n,handleLikeClick:i}=e;var o,a;a=()=>{this._element.remove()},(o="_handleDeleteButton")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._name=t.name,this._link=t.link,this._handleCardClick=r,this._cardTemplate=s,this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__img"),this._cardTitle=this._element.querySelector(".card__title"),this._likeButton=this._element.querySelector(".card__like-btn"),this._likesAmount=this._element.querySelector(".card__likes-amount"),this._deleteButton=this._element.querySelector(".card__delete-btn"),this._handleBinClick=n,this._handleLikeClick=i,this._mineCard=t.isMine,this._myNewCard=t.myNewCard,this._cardLikes=t.likes,this._initialLikes=t.likes.length}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".card").cloneNode(!0)}createCard(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._addDeleteButtonToNewCard(),this._handleLikeInitAmount(),this._element}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeClick),this._deleteButton.addEventListener("click",this._handleBinClick),this._cardImage.addEventListener("mousedown",this._handleCardClick)}addLike(e){this._likeButton.classList.add("card__like-btn_active"),this._likesAmount.textContent=e.length,this._cardLikes=e}removeLike(e){this._likeButton.classList.remove("card__like-btn_active"),this._likesAmount.textContent=e.length,this._cardLikes=e}toggleLike(e){return this._cardLikes.some((t=>t._id===e))}_handleLikeInitAmount(){this._likesAmount.textContent=this._initialLikes}_addDeleteButtonToNewCard(){this._myNewCard&&this._deleteButton.classList.add("card__delete-btn_active")}addDeleteButton(){this._mineCard&&this._deleteButton.classList.add("card__delete-btn_active")}myLike(e){this._cardLikes.forEach((t=>{t._id===e&&this._likeButton.classList.add("card__like-btn_active")}))}}document.getElementById("header-logo").src=e;const B=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}getMyProfile(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}delete(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}postNewCardData(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}patchProfileData(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.profileName,about:e.profileAbout})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}patchAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.value})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}removeLike(e){return fetch("https://around.nomoreparties.co/v1/group-12/cards/likes/".concat(e),{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}addLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"2f92e6f8-d3bf-4f0b-b7c9-ecb844a65d7b","Content-Type":"application/json"}}),q={};var w;w={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(w.formSelector)).forEach((e=>{const t=new L(w,e),s=e.getAttribute("name");q[s]=t,t.enableValidation()}));const I=new class extends y{constructor(e){var t,s;super(e),s=e=>{this._popupCardImage.src=e.target.src,this._popupCardImage.alt=e.target.alt,this._popupCardTitle.textContent=e.target.alt,super.open()},(t="open")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this.open=s,this._popupCardImage=this._popup.querySelector(".popup__card-img"),this._popupCardTitle=this._popup.querySelector(".popup__card-title")}}(m);I.setEventListeners();const P=new y(p);P.setEventListeners();const x=new class extends y{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._field=this._popup.querySelector(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn")}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack(this._field,this._saveBtn)})),super.setEventListeners()}switchBtnToSave(){this._saveBtn.textContent="Save"}open(){super.setEventListeners(),this._popup.classList.add("popup_opened")}close(){super.close(),this._popupForm.reset()}}({somePopup:u,callBack:(e,t)=>{t.textContent="Saving...",B.patchAvatar(e).then((()=>{h.src=e.value,x.close()}))}});function T(e){const t=new S({cardData:e,cardTemplate:"#card-template",handleCardClick:e=>{I.open(e)},handleBinClick:()=>{P.open(),_.onclick=()=>{B.delete(e._id).then((()=>{t._handleDeleteButton(),P.close()}))}},handleLikeClick:()=>{B.getMyProfile().then((s=>{t.toggleLike(s._id)?B.removeLike(e._id).then((e=>{t.removeLike(e.likes)})):B.addLike(e._id).then((e=>{t.addLike(e.likes)}))}))}});return B.getMyProfile().then((e=>{t.myLike(e._id)})),t.addDeleteButton(),t.createCard()}x.setEventListeners();const A=new class{constructor(e,t){let{renderer:s}=e;this.renderer=s,this._container=t}_clear(){this._container.innerHTML=""}addPrependItem(e){this._container.prepend(e)}addAppendItem(e){this._container.append(e)}}({renderer:e=>{if(e.myNewCard){const t=T(e);A.addPrependItem(t)}else{const t=T(e);A.addAppendItem(t)}}},b),j=new class{constructor(e,t){this._name=e,this._about=t}getUserInfo(){const e={};return e.name=this._name.textContent,e.about=this._about.textContent,e}setUserInfo(e){this._name.textContent=e.profileName,this._about.textContent=e.profileAbout}}(n,i),D=new g({somePopup:l,callBack:e=>{e.textContent="Saving...";const t=D.getInputValues();j.setUserInfo(t),B.patchProfileData(t).then((()=>{D.close()}))}});D.setEventListeners();const N=new g({somePopup:c,callBack:e=>{e.textContent="Creating...";const t=N.getInputValues(),s={};s.name=t.placeTitle,s.link=t.placeLink,B.postNewCardData(s).then((e=>{e.myNewCard=!0,A.renderer(e),N.close()}))}});N.setEventListeners(),o.addEventListener("click",(()=>{const e=j.getUserInfo();k.value=e.name,f.value=e.about,q[v.getAttribute("name")].resetValidation(),D.switchBtnToSave(),D.open()})),a.addEventListener("click",(()=>{q[C.getAttribute("name")].resetValidation(),N.switchBtnToCreate(),N.open()})),d.addEventListener("click",(()=>{q[C.getAttribute("name")].resetValidation(),x.switchBtnToSave(),x.open()})),(async()=>{await B.getMyProfile().then((e=>{h.src=e.avatar,n.textContent=e.name,i.textContent=e.about,B.getInitialCards().then((t=>{t.forEach((t=>{t.owner._id===e._id&&(t.isMine=!0),A.renderer(t)}))}))}))})()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoiK0ZBQ0lBLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWFFLFFBR3JCLElBQUlDLEVBQVNOLEVBQXlCRSxHQUFZLENBR2pERyxRQUFTLElBT1YsT0FIQUUsRUFBb0JMLEdBQVVJLEVBQVFBLEVBQU9ELFFBQVNKLEdBRy9DSyxFQUFPRCxRQ3JCZkosRUFBb0JPLEVBQUksRyx3QkNBeEIsTUFBTUMsRUFBT0MsU0FBU0MsY0FBYyxTQUU5QkMsRUFBVUgsRUFBS0UsY0FBYyxZQUM3QkUsRUFBY0QsRUFBUUQsY0FBYyxrQkFDcENHLEVBQWNGLEVBQVFELGNBQWMsc0JBQ3BDSSxFQUFhSCxFQUFRRCxjQUFjLHNCQUNuQ0ssRUFBWUosRUFBUUQsY0FBYyxxQkFFbENNLEVBQVlSLEVBQUtFLGNBQWMsZUFDL0JPLEVBQVdULEVBQUtFLGNBQWMsY0FDOUJRLEVBQWNWLEVBQUtFLGNBQWMsaUJBRWpDUyxFQUFpQlYsU0FBU0MsY0FBYyxtQkFDeENVLEVBQWtCWCxTQUFTQyxjQUFjLHFCQUN6Q1csRUFBZ0JaLFNBQVNDLGNBQWMsNkJBRXZDWSxFQUF1QkosRUFBWVIsY0FBYyxvQkFFakRhLEVBQVlkLFNBQVNDLGNBQWMsZUFFbkNjLEVBQWdCUixFQUFVTixjQUFjLGdCQUN4Q2UsRUFBWVQsRUFBVU4sY0FBYyw0QkFDcENnQixFQUFlVixFQUFVTixjQUFjLGdDQUV2Q2lCLEVBQWVWLEVBQVNQLGNBQWMsZ0JBRXRDa0IsRUFBWXBCLEVBQUtFLGNBQWMsZ0JDekI5QixNQUFNbUIsRUFDWEMsWUFBWUMsRUFBV0MsR0FDckJDLEtBQUtDLGNBQWdCSCxFQUFVSSxhQUMvQkYsS0FBS0cscUJBQXVCTCxFQUFVTSxvQkFDdENKLEtBQUtLLGlCQUFtQlAsRUFBVVEsZ0JBQ2xDTixLQUFLTyxZQUFjVCxFQUFVVSxXQUM3QlIsS0FBS1MsYUFBZVYsRUFDcEJDLEtBQUtVLFdBQWFDLE1BQU1DLEtBQUtaLEtBQUtTLGFBQWFJLGlCQUFpQmYsRUFBVWdCLGdCQUMxRWQsS0FBS2UsZUFBaUJmLEtBQUtTLGFBQWFoQyxjQUFjcUIsRUFBVWtCLHNCQUdsRUMsbUJBQ0VqQixLQUFLUyxhQUFhUyxpQkFBaUIsVUFBV0MsSUFBVUEsRUFBSUMsb0JBQzVEcEIsS0FBS3FCLHFCQUdQQSxxQkFDRXJCLEtBQUtzQixtQkFBbUJ0QixLQUFLVSxXQUFZVixLQUFLZSxnQkFFOUNmLEtBQUtVLFdBQVdhLFNBQVNDLElBQ3ZCQSxFQUFhTixpQkFBaUIsU0FBUyxLQUNyQ2xCLEtBQUt5QixvQkFBb0JELEdBQ3pCeEIsS0FBS3NCLG1CQUFtQnRCLEtBQUtVLFdBQVlWLEtBQUtlLHNCQUtwRFcsZ0JBQ0UxQixLQUFLZSxlQUFlWSxVQUFVQyxJQUFJNUIsS0FBS0csc0JBQ3ZDSCxLQUFLZSxlQUFlYyxhQUFhLFlBQVksR0FHL0NQLG1CQUFtQlEsRUFBV0MsR0FDeEIvQixLQUFLZ0MsaUJBQWlCRixHQUN4QjlCLEtBQUswQixpQkFFTEssRUFBY0osVUFBVU0sT0FBT2pDLEtBQUtHLHNCQUNwQzRCLEVBQWNHLGdCQUFnQixhQUlsQ0YsaUJBQWlCRixHQUNmLE9BQU9BLEVBQVVLLE1BQU1YLElBQ2JBLEVBQWFZLFNBQVNDLFFBSWxDWixvQkFBb0JELEdBQ2JBLEVBQWFZLFNBQVNDLE1BR3pCckMsS0FBS3NDLGdCQUFnQmQsR0FGckJ4QixLQUFLdUMsZ0JBQWdCZixFQUFjQSxFQUFhZ0IsbUJBTXBERCxnQkFBZ0JmLEVBQWNpQixHQUM1QixNQUFNQyxFQUFlMUMsS0FBS1MsYUFBYWhDLGNBQWxCLFdBQW9DK0MsRUFBYW1CLEdBQWpELFdBQ3JCbkIsRUFBYUcsVUFBVUMsSUFBSTVCLEtBQUtLLGtCQUNoQ3FDLEVBQWFFLFlBQWNILEVBQzNCQyxFQUFhZixVQUFVQyxJQUFJNUIsS0FBS08sYUFHbEMrQixnQkFBZ0JkLEdBQ2QsTUFBTWtCLEVBQWUxQyxLQUFLUyxhQUFhaEMsY0FBbEIsV0FBb0MrQyxFQUFhbUIsR0FBakQsV0FDckJuQixFQUFhRyxVQUFVTSxPQUFPakMsS0FBS0ssa0JBQ25DcUMsRUFBYUUsWUFBYyxHQUMzQkYsRUFBYWYsVUFBVU0sT0FBT2pDLEtBQUtPLGFBR3JDc0Msa0JBQ0U3QyxLQUFLc0IsbUJBQW1CdEIsS0FBS1UsV0FBWVYsS0FBS2UsZ0JBRTlDZixLQUFLVSxXQUFXYSxTQUFTQyxJQUN2QnhCLEtBQUtzQyxnQkFBZ0JkLE8sd0hDMUVwQixNQUFNc0IsRUFDWGpELFlBQVlrRCxHQUFXLDBCQWNKNUIsSUFDRCxXQUFaQSxFQUFJNkIsS0FDTmhELEtBQUtpRCxXQWhCYyw0QkFvQkY5QixJQUNmQSxFQUFJK0IsT0FBT3ZCLFVBQVV3QixTQUFTLGlCQUNoQ25ELEtBQUtpRCxRQUVIOUIsRUFBSStCLE9BQU92QixVQUFVd0IsU0FBUyxxQkFDaENuRCxLQUFLaUQsV0F4QlBqRCxLQUFLb0QsT0FBU0wsRUFHaEJNLE9BQ0U3RSxTQUFTMEMsaUJBQWlCLFVBQVdsQixLQUFLc0QsaUJBQzFDdEQsS0FBS29ELE9BQU96QixVQUFVQyxJQUFJLGdCQUc1QnFCLFFBQ0V6RSxTQUFTK0Usb0JBQW9CLFVBQVd2RCxLQUFLc0QsaUJBQzdDdEQsS0FBS29ELE9BQU96QixVQUFVTSxPQUFPLGdCQWtCL0J1QixvQkFDRXhELEtBQUtvRCxPQUFPbEMsaUJBQWlCLFlBQWFsQixLQUFLeUQsb0JDN0I1QyxNQUFNQyxVQUFzQlosRUFDakNqRCxZQUFZLEdBQXlCLElBQXpCLFVBQUVrRCxFQUFGLFNBQWFZLEdBQVksRUFDbkNDLE1BQU1iLEdBQ04vQyxLQUFLNkQsVUFBWUYsRUFDakIzRCxLQUFLOEQsUUFBVTlELEtBQUtvRCxPQUFPdkMsaUJBQWlCLGlCQUM1Q2IsS0FBSytELFdBQWEvRCxLQUFLb0QsT0FBTzNFLGNBQWMsZ0JBQzVDdUIsS0FBS2dFLFNBQVdoRSxLQUFLb0QsT0FBTzNFLGNBQWMsb0JBRTVDd0YsaUJBQ0UsTUFBTUMsRUFBYSxHQUluQixPQUhBbEUsS0FBSzhELFFBQVF2QyxTQUFTNEMsSUFDcEJELEVBQVdDLEVBQU1DLE1BQVFELEVBQU1FLFNBRTFCSCxFQUdUVixvQkFDRXhELEtBQUtvRCxPQUFPbEMsaUJBQWlCLFVBQVdDLElBQ3RDQSxFQUFJQyxpQkFDSnBCLEtBQUs2RCxVQUFVN0QsS0FBS2dFLGFBRXRCSixNQUFNSixvQkFHUkgsT0FDRU8sTUFBTUosb0JBQ054RCxLQUFLb0QsT0FBT3pCLFVBQVVDLElBQUksZ0JBRzVCMEMsb0JBQ0V0RSxLQUFLZ0UsU0FBU3BCLFlBQWMsU0FHOUIyQixrQkFDRXZFLEtBQUtnRSxTQUFTcEIsWUFBYyxPQUc5QkssUUFDRVcsTUFBTVgsUUFDTmpELEtBQUsrRCxXQUFXUyxTQ3pDYixNQUFNQyxFQUVYNUUsWUFBWSxHQUE4RSxJQUE5RSxTQUFFNkUsRUFBRixhQUFZQyxFQUFaLGdCQUEwQkMsRUFBMUIsZUFBMkNDLEVBQTNDLGdCQUEyREMsR0FBbUIsRSxVQWdGcEUsS0FDcEI5RSxLQUFLK0UsU0FBUzlDLFcsRUFqRjBFLDhCLHNCQUFBLEssdURBQUEsSyxLQUN4RmpDLEtBQUtnRixNQUFRTixFQUFTTixLQUN0QnBFLEtBQUtpRixNQUFRUCxFQUFTUSxLQUN0QmxGLEtBQUttRixpQkFBbUJQLEVBQ3hCNUUsS0FBS29GLGNBQWdCVCxFQUNyQjNFLEtBQUsrRSxTQUFXL0UsS0FBS3FGLGVBQ3JCckYsS0FBS3NGLFdBQWF0RixLQUFLK0UsU0FBU3RHLGNBQWMsY0FDOUN1QixLQUFLdUYsV0FBYXZGLEtBQUsrRSxTQUFTdEcsY0FBYyxnQkFDOUN1QixLQUFLd0YsWUFBY3hGLEtBQUsrRSxTQUFTdEcsY0FBYyxtQkFDL0N1QixLQUFLeUYsYUFBZXpGLEtBQUsrRSxTQUFTdEcsY0FBYyx1QkFDaER1QixLQUFLMEYsY0FBZ0IxRixLQUFLK0UsU0FBU3RHLGNBQWMscUJBQ2pEdUIsS0FBSzJGLGdCQUFrQmQsRUFDdkI3RSxLQUFLNEYsaUJBQW1CZCxFQUN4QjlFLEtBQUs2RixVQUFZbkIsRUFBU29CLE9BQzFCOUYsS0FBSytGLFdBQWFyQixFQUFTc0IsVUFDM0JoRyxLQUFLaUcsV0FBYXZCLEVBQVN3QixNQUMzQmxHLEtBQUttRyxjQUFnQnpCLEVBQVN3QixNQUFNRSxPQUd0Q2YsZUFPRSxPQU5vQjdHLFNBQ2pCQyxjQUFjdUIsS0FBS29GLGVBQ25CaUIsUUFDQTVILGNBQWMsU0FDZDZILFdBQVUsR0FLZkMsYUFRRSxPQVBBdkcsS0FBS3VGLFdBQVczQyxZQUFjNUMsS0FBS2dGLE1BQ25DaEYsS0FBS3NGLFdBQVdrQixJQUFNeEcsS0FBS2lGLE1BQzNCakYsS0FBS3NGLFdBQVdtQixJQUFNekcsS0FBS2dGLE1BQzNCaEYsS0FBS3FCLHFCQUNMckIsS0FBSzBHLDRCQUNMMUcsS0FBSzJHLHdCQUVFM0csS0FBSytFLFNBR2QxRCxxQkFDRXJCLEtBQUt3RixZQUFZdEUsaUJBQWlCLFFBQVNsQixLQUFLNEYsa0JBQ2hENUYsS0FBSzBGLGNBQWN4RSxpQkFBaUIsUUFBU2xCLEtBQUsyRixpQkFDbEQzRixLQUFLc0YsV0FBV3BFLGlCQUFpQixZQUFhbEIsS0FBS21GLGtCQUlyRHlCLFFBQVFWLEdBQ05sRyxLQUFLd0YsWUFBWTdELFVBQVVDLElBQUkseUJBQy9CNUIsS0FBS3lGLGFBQWE3QyxZQUFjc0QsRUFBTUUsT0FDdENwRyxLQUFLaUcsV0FBYUMsRUFHcEJXLFdBQVdYLEdBQ1RsRyxLQUFLd0YsWUFBWTdELFVBQVVNLE9BQU8seUJBQ2xDakMsS0FBS3lGLGFBQWE3QyxZQUFjc0QsRUFBTUUsT0FDdENwRyxLQUFLaUcsV0FBYUMsRUFHcEJZLFdBQVdDLEdBRVQsT0FEaUIvRyxLQUFLaUcsV0FBVzlELE1BQUs2RSxHQUFRQSxFQUFLQyxNQUFRRixJQUk3REosd0JBQ0UzRyxLQUFLeUYsYUFBYTdDLFlBQWM1QyxLQUFLbUcsY0FHdkNPLDRCQUNNMUcsS0FBSytGLFlBQ1AvRixLQUFLMEYsY0FBYy9ELFVBQVVDLElBQUksMkJBSXJDc0Ysa0JBQ01sSCxLQUFLNkYsV0FDUDdGLEtBQUswRixjQUFjL0QsVUFBVUMsSUFBSSwyQkFRckN1RixPQUFPSixHQUNML0csS0FBS2lHLFdBQVcxRSxTQUFTeUYsSUFDbkJBLEVBQUtDLE1BQVFGLEdBQ2YvRyxLQUFLd0YsWUFBWTdELFVBQVVDLElBQUksNkJDdEZwQnBELFNBQVM0SSxlQUFlLGVBQ2hDWixJQUFNYSxFQWlDakIsTUFBTUMsRUFBTSxJQ3JDTCxNQUNMekgsWUFBWTBILEdBQ1Z2SCxLQUFLd0gsU0FBV0QsRUFBVUUsUUFDMUJ6SCxLQUFLMEgsU0FBV0gsRUFBVUksUUFHNUJDLGtCQUNFLE9BQU9DLE1BQU0sR0FBRCxPQUFJN0gsS0FBS3dILFNBQVQsVUFBMkIsQ0FDckNHLFFBQVMzSCxLQUFLMEgsV0FFYkksTUFBS0MsR0FDQUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBUixpQkFBeUJKLEVBQUlLLFdBRXJDQyxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixNQUlsQkcsZUFDRSxPQUFPWixNQUFNLEdBQUQsT0FBSTdILEtBQUt3SCxTQUFULGFBQThCLENBQ3hDRyxRQUFTM0gsS0FBSzBILFdBRWJJLE1BQUtDLEdBQ0FBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsaUJBQXlCSixFQUFJSyxXQUVyQ0MsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsTUFJbEJJLE9BQU9DLEdBQ0wsT0FBT2QsTUFBTSxHQUFELE9BQUk3SCxLQUFLd0gsU0FBVCxrQkFBMkJtQixHQUFVLENBQy9DQyxPQUFRLFNBQ1JqQixRQUFTM0gsS0FBSzBILFdBRWJJLE1BQUtDLEdBQ0FBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsaUJBQXlCSixFQUFJSyxXQUVyQ0MsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsTUFJbEJPLGdCQUFnQkMsR0FDZCxPQUFPakIsTUFBTSxHQUFELE9BQUk3SCxLQUFLd0gsU0FBVCxVQUEyQixDQUNyQ29CLE9BQVEsT0FDUmpCLFFBQVMzSCxLQUFLMEgsU0FDZG5KLEtBQU13SyxLQUFLQyxVQUFVLENBQ25CNUUsS0FBTTBFLEVBQUsxRSxLQUNYYyxLQUFNNEQsRUFBSzVELFNBR1o0QyxNQUFLQyxHQUNBQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGlCQUF5QkosRUFBSUssV0FFckNDLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE1BSWxCVyxpQkFBaUJDLEdBQ2YsT0FBT3JCLE1BQU0sR0FBRCxPQUFJN0gsS0FBS3dILFNBQVQsYUFBOEIsQ0FDeENvQixPQUFRLFFBQ1JqQixRQUFTM0gsS0FBSzBILFNBQ2RuSixLQUFNd0ssS0FBS0MsVUFBVSxDQUNuQjVFLEtBQU04RSxFQUFXdkssWUFDakJ3SyxNQUFPRCxFQUFXRSxpQkFHbkJ0QixNQUFLQyxHQUNBQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGlCQUF5QkosRUFBSUssV0FFckNDLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE1BSWxCZSxZQUFZbEYsR0FDVixPQUFPMEQsTUFBTSxHQUFELE9BQUk3SCxLQUFLd0gsU0FBVCxvQkFBcUMsQ0FDL0NvQixPQUFRLFFBQ1JqQixRQUFTM0gsS0FBSzBILFNBQ2RuSixLQUFNd0ssS0FBS0MsVUFBVSxDQUNuQk0sT0FBUW5GLEVBQU1FLFVBR2Z5RCxNQUFLQyxHQUNBQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGlCQUF5QkosRUFBSUssV0FFckNDLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE1BSWxCekIsV0FBVzBDLEdBQ1QsT0FBTzFCLE1BQU0sMkRBQUQsT0FBNEQwQixHQUFVLENBQ2hGWCxPQUFRLFNBQ1JqQixRQUFTM0gsS0FBSzBILFdBRWJJLE1BQUtDLEdBQ0FBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsaUJBQXlCSixFQUFJSyxXQUVyQ0MsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsTUFJbEIxQixRQUFRMkMsR0FDTixPQUFPMUIsTUFBTSxHQUFELE9BQUk3SCxLQUFLd0gsU0FBVCx3QkFBaUMrQixHQUFVLENBQ3JEWCxPQUFRLE1BQ1JqQixRQUFTM0gsS0FBSzBILFdBRWJJLE1BQUtDLEdBQ0FBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsaUJBQXlCSixFQUFJSyxXQUVyQ0MsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsUUR0R0EsQ0FDbEJiLFFBQVMsOENBQ1RFLFFBQVMsQ0FDUDZCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBSWRDLEVBQWlCLEdBRUdDLElBQUFBLEVBQUFBLEVMbkJELENBQ3ZCeEosYUFBYyxlQUNkWSxjQUFlLGdCQUNmRSxxQkFBc0IsbUJBQ3RCWixvQkFBcUIsMkJBQ3JCRSxnQkFBaUIsMEJBQ2pCRSxXQUFZLDZCS2NLRyxNQUFNQyxLQUFLcEMsU0FBU3FDLGlCQUFpQjZJLEVBQU94SixlQUVwRHFCLFNBQVN4QixJQUNoQixNQUFNNEosRUFBWSxJQUFJL0osRUFBYzhKLEVBQVEzSixHQUN0QzZKLEVBQVc3SixFQUFZOEosYUFBYSxRQUUxQ0osRUFBZUcsR0FBWUQsRUFDM0JBLEVBQVUxSSxzQkFNZCxNQUFNNkksRUFBb0IsSUUzRG5CLGNBQTZCaEgsRUFDbENqRCxZQUFZa0QsRyxRQUNWYSxNQUFNYixHLEVBS0E1QixJQUNObkIsS0FBSytKLGdCQUFnQnZELElBQU1yRixFQUFJK0IsT0FBT3NELElBQ3RDeEcsS0FBSytKLGdCQUFnQnRELElBQU10RixFQUFJK0IsT0FBT3VELElBQ3RDekcsS0FBS2dLLGdCQUFnQnBILFlBQWN6QixFQUFJK0IsT0FBT3VELElBQzlDN0MsTUFBTVAsUyxFQVZlLGUsc0JBQUEsSyx1REFBQSxLLE9BRXJCckQsS0FBSytKLGdCQUFrQi9KLEtBQUtvRCxPQUFPM0UsY0FBYyxvQkFDakR1QixLQUFLZ0ssZ0JBQWtCaEssS0FBS29ELE9BQU8zRSxjQUFjLHdCRnVEUmEsR0FDN0N3SyxFQUFrQnRHLG9CQUVsQixNQUFNeUcsRUFBc0IsSUFBSW5ILEVBQU03RCxHQUN0Q2dMLEVBQW9Cekcsb0JBRXBCLE1BQU0wRyxFQUEwQixJR2pFekIsY0FBK0JwSCxFQUNwQ2pELFlBQVksR0FBeUIsSUFBekIsVUFBRWtELEVBQUYsU0FBYVksR0FBWSxFQUNuQ0MsTUFBTWIsR0FDTi9DLEtBQUs2RCxVQUFZRixFQUNqQjNELEtBQUttSyxPQUFTbkssS0FBS29ELE9BQU8zRSxjQUFjLGlCQUN4Q3VCLEtBQUsrRCxXQUFhL0QsS0FBS29ELE9BQU8zRSxjQUFjLGdCQUM1Q3VCLEtBQUtnRSxTQUFXaEUsS0FBS29ELE9BQU8zRSxjQUFjLG9CQUc1QytFLG9CQUNFeEQsS0FBS29ELE9BQU9sQyxpQkFBaUIsVUFBV0MsSUFDdENBLEVBQUlDLGlCQUNKcEIsS0FBSzZELFVBQVU3RCxLQUFLbUssT0FBUW5LLEtBQUtnRSxhQUVuQ0osTUFBTUosb0JBR1JlLGtCQUNFdkUsS0FBS2dFLFNBQVNwQixZQUFjLE9BRzlCUyxPQUNFTyxNQUFNSixvQkFDTnhELEtBQUtvRCxPQUFPekIsVUFBVUMsSUFBSSxnQkFHNUJxQixRQUNFVyxNQUFNWCxRQUNOakQsS0FBSytELFdBQVdTLFVIcUNpQyxDQUNuRHpCLFVBQVc1RCxFQUNYd0UsU0FBVSxDQUFDUSxFQUFPaUcsS0FDaEJBLEVBQVF4SCxZQUFjLFlBQ3RCMEUsRUFBSStCLFlBQVlsRixHQUNiMkQsTUFBSyxLQUNKNUksRUFBZXNILElBQU1yQyxFQUFNRSxNQUMzQjZGLEVBQXdCakgsY0FNaEMsU0FBU3NELEVBQVc4RCxHQUNsQixNQUFNdkIsRUFBTyxJQUFJckUsRUFBSyxDQUNwQkMsU0FBVTJGLEVBQ1YxRixhQUFjLGlCQUNkQyxnQkFBa0J6RCxJQUNoQjJJLEVBQWtCekcsS0FBS2xDLElBRXpCMEQsZUFBZ0IsS0FDZG9GLEVBQW9CNUcsT0FDcEJoRSxFQUFxQmlMLFFBQVUsS0FDN0JoRCxFQUFJb0IsT0FBTzJCLEVBQUtwRCxLQUNiYSxNQUFLLEtBQ0pnQixFQUFLeUIsc0JBQ0xOLEVBQW9CaEgsYUFJNUI2QixnQkFBaUIsS0FFZndDLEVBQUltQixlQUNEWCxNQUFNMEMsSUFDWTFCLEVBQUtoQyxXQUFXMEQsRUFBVXZELEtBRXpDSyxFQUFJVCxXQUFXd0QsRUFBS3BELEtBQ2pCYSxNQUFNQyxJQUNMZSxFQUFLakMsV0FBV2tCLEVBQUk3QixVQUd4Qm9CLEVBQUlWLFFBQVF5RCxFQUFLcEQsS0FDZGEsTUFBTUMsSUFDTGUsRUFBS2xDLFFBQVFtQixFQUFJN0IsZ0JBYy9CLE9BUEFvQixFQUFJbUIsZUFDRFgsTUFBTTBDLElBQ0wxQixFQUFLM0IsT0FBT3FELEVBQVV2RCxRQUcxQjZCLEVBQUs1QixrQkFDZTRCLEVBQUt2QyxhQTdDM0IyRCxFQUF3QjFHLG9CQWlEeEIsTUFBTWlILEVBQWUsSUkvSGQsTUFDTDVLLFlBQVksRUFBYzZLLEdBQVcsSUFBekIsU0FBRUMsR0FBdUIsRUFFbkMzSyxLQUFLMkssU0FBV0EsRUFDaEIzSyxLQUFLNEssV0FBYUYsRUFHcEJHLFNBQ0U3SyxLQUFLNEssV0FBV0UsVUFBWSxHQVU5QkMsZUFBZVYsR0FDYnJLLEtBQUs0SyxXQUFXSSxRQUFRWCxHQUcxQlksY0FBY1osR0FFWnJLLEtBQUs0SyxXQUFXTSxPQUFPYixLSnVHTSxDQUMvQk0sU0FBV04sSUFDVCxHQUFJQSxFQUFLckUsVUFBVyxDQUNsQixNQUFNbUYsRUFBYzVFLEVBQVc4RCxHQUMvQkksRUFBYU0sZUFBZUksT0FDdkIsQ0FDTCxNQUFNQSxFQUFjNUUsRUFBVzhELEdBQy9CSSxFQUFhUSxjQUFjRSxNQUc5QnhMLEdBRUd5TCxFQUFtQixJSzNJbEIsTUFDTHZMLFlBQVl3TCxFQUFVQyxHQUNwQnRMLEtBQUtnRixNQUFRcUcsRUFDYnJMLEtBQUt1TCxPQUFTRCxFQUVoQkUsY0FDRSxNQUFNQyxFQUFlLEdBR3JCLE9BRkFBLEVBQWFySCxLQUFPcEUsS0FBS2dGLE1BQU1wQyxZQUMvQjZJLEVBQWF0QyxNQUFRbkosS0FBS3VMLE9BQU8zSSxZQUMxQjZJLEVBRVRDLFlBQVlDLEdBQ1YzTCxLQUFLZ0YsTUFBTXBDLFlBQWMrSSxFQUFZaE4sWUFDckNxQixLQUFLdUwsT0FBTzNJLFlBQWMrSSxFQUFZdkMsZUw4SEp6SyxFQUFhQyxHQUU3Q2dOLEVBQW9CLElBQUlsSSxFQUFjLENBQzFDWCxVQUFXaEUsRUFDWDRFLFNBQVd5RyxJQUNUQSxFQUFReEgsWUFBYyxZQUN0QixNQUFNc0csRUFBYTBDLEVBQWtCM0gsaUJBRXJDbUgsRUFBaUJNLFlBQVl4QyxHQUM3QjVCLEVBQUkyQixpQkFBaUJDLEdBQ2xCcEIsTUFBSyxLQUNKOEQsRUFBa0IzSSxjQUkxQjJJLEVBQWtCcEksb0JBRWxCLE1BQU1xSSxFQUFtQixJQUFJbkksRUFBYyxDQUN6Q1gsVUFBVy9ELEVBQ1gyRSxTQUFXeUcsSUFDVEEsRUFBUXhILFlBQWMsY0FDdEIsTUFBTWtKLEVBQVlELEVBQWlCNUgsaUJBQzdCOEgsRUFBVSxHQUNoQkEsRUFBUTNILEtBQU8wSCxFQUFVRSxXQUN6QkQsRUFBUTdHLEtBQU80RyxFQUFVRyxVQUV6QjNFLEVBQUl1QixnQkFBZ0JrRCxHQUNqQmpFLE1BQU1nQixJQUNMQSxFQUFLOUMsV0FBWSxFQUNqQnlFLEVBQWFFLFNBQVM3QixHQUN0QitDLEVBQWlCNUksY0FJekI0SSxFQUFpQnJJLG9CQUVqQjNFLEVBQVdxQyxpQkFBaUIsU0FBUyxLQUNuQyxNQUFNZ0wsRUFBV2QsRUFBaUJJLGNBRWxDaE0sRUFBVTZFLE1BQVE2SCxFQUFTOUgsS0FDM0IzRSxFQUFhNEUsTUFBUTZILEVBQVMvQyxNQUM5Qk0sRUFBZWxLLEVBQWNzSyxhQUFhLFNBQVNoSCxrQkFFbkQrSSxFQUFrQnJILGtCQUNsQnFILEVBQWtCdkksVUFHcEJ2RSxFQUFVb0MsaUJBQWlCLFNBQVMsS0FDbEN1SSxFQUFlL0osRUFBYW1LLGFBQWEsU0FBU2hILGtCQUNsRGdKLEVBQWlCdkgsb0JBQ2pCdUgsRUFBaUJ4SSxVQUduQmpFLEVBQWM4QixpQkFBaUIsU0FBUyxLQUN0Q3VJLEVBQWUvSixFQUFhbUssYUFBYSxTQUFTaEgsa0JBRWxEcUgsRUFBd0IzRixrQkFDeEIyRixFQUF3QjdHLFVBR1Y4SSxpQkFDSzdFLEVBQUltQixlQUVwQlgsTUFBTTBDLElBRUx0TCxFQUFlc0gsSUFBTWdFLEVBQVVsQixPQUMvQjNLLEVBQVlpRSxZQUFjNEgsRUFBVXBHLEtBQ3BDeEYsRUFBWWdFLFlBQWM0SCxFQUFVckIsTUFDcEM3QixFQUFJTSxrQkFDREUsTUFBTXNFLElBQ0xBLEVBQU03SyxTQUFTdUgsSUFDVEEsRUFBS3VELE1BQU1wRixNQUFRdUQsRUFBVXZELE1BQy9CNkIsRUFBS2hELFFBQVMsR0FFaEIyRSxFQUFhRSxTQUFTN0IsYUFNbEN3RCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEF2YUZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2UnKTtcblxuY29uc3QgcHJvZmlsZSA9IGJvZHkucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xuY29uc3QgcHJvZmlsZUluZm8gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hYm91dC1tZScpO1xuY29uc3QgZWRpdEJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnRuJyk7XG5jb25zdCBhZGRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnRuJyk7XG5cbmNvbnN0IHBvcHVwRWRpdCA9IGJvZHkucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQnKTtcbmNvbnN0IHBvcHVwQWRkID0gYm9keS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfYWRkJyk7XG5jb25zdCBwb3B1cERlbGV0ZSA9IGJvZHkucXVlcnlTZWxlY3RvcignLnBvcHVwX2RlbGV0ZScpO1xuXG5jb25zdCBwaG90b0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19waG90bycpO1xuY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQtcGhvdG8nKTtcbmNvbnN0IGVkaXRBdmF0YXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1hdmF0YXItYnRuJyk7XG5cbmNvbnN0IHBvcHVwRGVsZXRlWWVzQnV0dG9uID0gcG9wdXBEZWxldGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xuXG5jb25zdCBwb3B1cENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfY2FyZCcpO1xuXG5jb25zdCBwb3B1cEVkaXRGb3JtID0gcG9wdXBFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuY29uc3QgZmllbGROYW1lID0gcG9wdXBFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfbmFtZScpO1xuY29uc3QgZmllbGRBYm91dE1lID0gcG9wdXBFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfYWJvdXQtbWUnKTtcblxuY29uc3QgcG9wdXBBZGRGb3JtID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG5cbmNvbnN0IGNhcmRzTGlzdCA9IGJvZHkucXVlcnlTZWxlY3RvcignLmNhcmRzX19saXN0Jyk7XG5cbmNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc2F2ZS1idG5cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZS1idG5fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcblxuZXhwb3J0IHtcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVJbmZvLFxuICBlZGl0QnV0dG9uLFxuICBhZGRCdXR0b24sXG4gIHBvcHVwRWRpdCxcbiAgcG9wdXBBZGQsXG4gIHBvcHVwQ2FyZCxcbiAgcG9wdXBFZGl0Rm9ybSxcbiAgZmllbGROYW1lLFxuICBmaWVsZEFib3V0TWUsXG4gIHBvcHVwQWRkRm9ybSxcbiAgY2FyZHNMaXN0LFxuICB2YWxpZGF0aW9uQ29uZmlnLFxuICBwb3B1cERlbGV0ZSxcbiAgcG9wdXBEZWxldGVZZXNCdXR0b24sXG4gIHBob3RvQ29udGFpbmVyLFxuICBwb3B1cEVkaXRBdmF0YXIsXG4gIGVkaXRBdmF0YXJCdG5cbn07IiwiXG5leHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9ycywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZWxlY3RvcnMuZm9ybVNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZWxlY3RvcnMuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZWxlY3RvcnMuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZWxlY3RvcnMuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMuaW5wdXRTZWxlY3RvcikpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHsgZXZ0LnByZXZlbnREZWZhdWx0KCkgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBidXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9O1xuICB9O1xuXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9O1xuICB9O1xuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuXG4gIH07XG5cbn1cbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNvbWVQb3B1cCkge1xuICAgIHRoaXMuX3BvcHVwID0gc29tZVBvcHVwO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9O1xuICB9XG5cbiAgX2hhbmRsZUNsaWNrQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9vcGVuZWQnKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnRuJykpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSk7XG4gIH1cbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHNvbWVQb3B1cCwgY2FsbEJhY2sgfSkge1xuICAgIHN1cGVyKHNvbWVQb3B1cCk7XG4gICAgdGhpcy5fY2FsbEJhY2sgPSBjYWxsQmFjaztcbiAgICB0aGlzLl9maWVsZHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgdGhpcy5fc2F2ZUJ0biA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZS1idG4nKTtcbiAgfVxuICBnZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBmaWVsZHNMaXN0ID0ge307XG4gICAgdGhpcy5fZmllbGRzLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICBmaWVsZHNMaXN0W2ZpZWxkLm5hbWVdID0gZmllbGQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpZWxkc0xpc3Q7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2NhbGxCYWNrKHRoaXMuX3NhdmVCdG4pO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gIH1cblxuICBzd2l0Y2hCdG5Ub0NyZWF0ZSgpIHtcbiAgICB0aGlzLl9zYXZlQnRuLnRleHRDb250ZW50ID0gJ0NyZWF0ZSc7XG4gIH1cblxuICBzd2l0Y2hCdG5Ub1NhdmUoKSB7XG4gICAgdGhpcy5fc2F2ZUJ0bi50ZXh0Q29udGVudCA9ICdTYXZlJztcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcblxuICBjb25zdHJ1Y3Rvcih7IGNhcmREYXRhLCBjYXJkVGVtcGxhdGUsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlQmluQ2xpY2ssIGhhbmRsZUxpa2VDbGljayB9KSB7XG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGNhcmRUZW1wbGF0ZTtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWcnKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ0bicpO1xuICAgIHRoaXMuX2xpa2VzQW1vdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZXMtYW1vdW50Jyk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ0bicpO1xuICAgIHRoaXMuX2hhbmRsZUJpbkNsaWNrID0gaGFuZGxlQmluQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX21pbmVDYXJkID0gY2FyZERhdGEuaXNNaW5lO1xuICAgIHRoaXMuX215TmV3Q2FyZCA9IGNhcmREYXRhLm15TmV3Q2FyZDtcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSBjYXJkRGF0YS5saWtlcztcbiAgICB0aGlzLl9pbml0aWFsTGlrZXMgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFRlbXBsYXRlKVxuICAgICAgLmNvbnRlbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fYWRkRGVsZXRlQnV0dG9uVG9OZXdDYXJkKClcbiAgICB0aGlzLl9oYW5kbGVMaWtlSW5pdEFtb3VudCgpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUxpa2VDbGljayk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlQmluQ2xpY2spO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xuICB9XG5cblxuICBhZGRMaWtlKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcbiAgICB0aGlzLl9saWtlc0Ftb3VudC50ZXh0Q29udGVudCA9IGxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSBsaWtlcztcbiAgfVxuXG4gIHJlbW92ZUxpa2UobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xuICAgIHRoaXMuX2xpa2VzQW1vdW50LnRleHRDb250ZW50ID0gbGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX2NhcmRMaWtlcyA9IGxpa2VzO1xuICB9XG5cbiAgdG9nZ2xlTGlrZShteUlkKSB7XG4gICAgY29uc3QgaXNNeUxpa2UgPSB0aGlzLl9jYXJkTGlrZXMuc29tZShsaWtlID0+IGxpa2UuX2lkID09PSBteUlkKTtcbiAgICByZXR1cm4gaXNNeUxpa2U7XG4gIH1cblxuICBfaGFuZGxlTGlrZUluaXRBbW91bnQoKSB7XG4gICAgdGhpcy5fbGlrZXNBbW91bnQudGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsTGlrZXM7XG4gIH1cblxuICBfYWRkRGVsZXRlQnV0dG9uVG9OZXdDYXJkKCkge1xuICAgIGlmICh0aGlzLl9teU5ld0NhcmQpIHtcbiAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19kZWxldGUtYnRuX2FjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIGFkZERlbGV0ZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5fbWluZUNhcmQpIHtcbiAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19kZWxldGUtYnRuX2FjdGl2ZScpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVEZWxldGVCdXR0b24gPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIG15TGlrZShteUlkKSB7XG4gICAgdGhpcy5fY2FyZExpa2VzLmZvckVhY2goKGxpa2UpID0+IHtcbiAgICAgIGlmIChsaWtlLl9pZCA9PT0gbXlJZCkge1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xuICAgICAgfTtcbiAgICB9KVxuICB9XG59IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBoZWFkZXJMb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyLWxvZ29cIik7XG5oZWFkZXJMb2dvLnNyYyA9IGhlYWRlckxvZ29TcmM7XG5cbmltcG9ydCB7XG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlSW5mbyxcbiAgZWRpdEJ1dHRvbixcbiAgYWRkQnV0dG9uLFxuICBwb3B1cEVkaXQsXG4gIHBvcHVwQWRkLFxuICBwb3B1cENhcmQsXG4gIHBvcHVwRWRpdEZvcm0sXG4gIGZpZWxkTmFtZSxcbiAgZmllbGRBYm91dE1lLFxuICBwb3B1cEFkZEZvcm0sXG4gIGNhcmRzTGlzdCxcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcG9wdXBEZWxldGUsXG4gIHBvcHVwRGVsZXRlWWVzQnV0dG9uLFxuICBwaG90b0NvbnRhaW5lcixcbiAgcG9wdXBFZGl0QXZhdGFyLFxuICBlZGl0QXZhdGFyQnRuXG59IGZyb20gJy4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzJztcblxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlcy5qcyc7XG5pbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzJztcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEF2YUZvcm0gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEF2YUZvcm0uanNcIjtcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMmY5MmU2ZjgtZDNiZi00ZjBiLWI3YzktZWNiODQ0YTY1ZDdiXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfVxufSk7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcblxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJyk7XG5cbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgfSk7XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xuXG5jb25zdCBwb3B1cENhcmRSZW5kZXJlciA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cENhcmQpO1xucG9wdXBDYXJkUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBEZWxldGVSZW5kZXJlciA9IG5ldyBQb3B1cChwb3B1cERlbGV0ZSk7XG5wb3B1cERlbGV0ZVJlbmRlcmVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyID0gbmV3IFBvcHVwV2l0aEF2YUZvcm0oe1xuICBzb21lUG9wdXA6IHBvcHVwRWRpdEF2YXRhcixcbiAgY2FsbEJhY2s6IChmaWVsZCwgc2F2ZUJ0bikgPT4ge1xuICAgIHNhdmVCdG4udGV4dENvbnRlbnQgPSAnU2F2aW5nLi4uJztcbiAgICBhcGkucGF0Y2hBdmF0YXIoZmllbGQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHBob3RvQ29udGFpbmVyLnNyYyA9IGZpZWxkLnZhbHVlO1xuICAgICAgICBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5jbG9zZSgpO1xuICAgICAgfSlcbiAgfVxufSk7XG5wb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBjYXJkRGF0YTogaXRlbSxcbiAgICBjYXJkVGVtcGxhdGU6ICcjY2FyZC10ZW1wbGF0ZScsXG4gICAgaGFuZGxlQ2FyZENsaWNrOiAoZXZ0KSA9PiB7XG4gICAgICBwb3B1cENhcmRSZW5kZXJlci5vcGVuKGV2dCk7XG4gICAgfSxcbiAgICBoYW5kbGVCaW5DbGljazogKCkgPT4ge1xuICAgICAgcG9wdXBEZWxldGVSZW5kZXJlci5vcGVuKCk7XG4gICAgICBwb3B1cERlbGV0ZVllc0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICBhcGkuZGVsZXRlKGl0ZW0uX2lkKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNhcmQuX2hhbmRsZURlbGV0ZUJ1dHRvbigpO1xuICAgICAgICAgICAgcG9wdXBEZWxldGVSZW5kZXJlci5jbG9zZSgpO1xuICAgICAgICAgIH0pXG4gICAgICB9O1xuICAgIH0sXG4gICAgaGFuZGxlTGlrZUNsaWNrOiAoKSA9PiB7XG5cbiAgICAgIGFwaS5nZXRNeVByb2ZpbGUoKVxuICAgICAgICAudGhlbigobXlQcm9maWxlKSA9PiB7XG4gICAgICAgICAgY29uc3QgaXNNeUxpa2UgPSBjYXJkLnRvZ2dsZUxpa2UobXlQcm9maWxlLl9pZCk7XG4gICAgICAgICAgaWYgKGlzTXlMaWtlKSB7XG4gICAgICAgICAgICBhcGkucmVtb3ZlTGlrZShpdGVtLl9pZClcbiAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGNhcmQucmVtb3ZlTGlrZShyZXMubGlrZXMpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhcGkuYWRkTGlrZShpdGVtLl9pZClcbiAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGNhcmQuYWRkTGlrZShyZXMubGlrZXMpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9LFxuXG4gIH0pO1xuICBhcGkuZ2V0TXlQcm9maWxlKClcbiAgICAudGhlbigobXlQcm9maWxlKSA9PiB7XG4gICAgICBjYXJkLm15TGlrZShteVByb2ZpbGUuX2lkKTtcbiAgICB9KTtcblxuICBjYXJkLmFkZERlbGV0ZUJ1dHRvbigpO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuY3JlYXRlQ2FyZCgpO1xuICByZXR1cm4gY2FyZEVsZW1lbnRcbn1cblxuY29uc3QgY2FyZFJlbmRlcmVyID0gbmV3IFNlY3Rpb24oe1xuICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICBpZiAoaXRlbS5teU5ld0NhcmQpIHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgIGNhcmRSZW5kZXJlci5hZGRQcmVwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgIGNhcmRSZW5kZXJlci5hZGRBcHBlbmRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9XG4gIH1cbn0sIGNhcmRzTGlzdCk7XG5cbmNvbnN0IHVzZXJJbmZvUmVuZGVyZXIgPSBuZXcgVXNlckluZm8ocHJvZmlsZU5hbWUsIHByb2ZpbGVJbmZvKTtcblxuY29uc3QgZWRpdFBvcHVwQmVoYXZpb3IgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHNvbWVQb3B1cDogcG9wdXBFZGl0LFxuICBjYWxsQmFjazogKHNhdmVCdG4pID0+IHtcbiAgICBzYXZlQnRuLnRleHRDb250ZW50ID0gJ1NhdmluZy4uLic7XG4gICAgY29uc3QgZWRpdEZpZWxkcyA9IGVkaXRQb3B1cEJlaGF2aW9yLmdldElucHV0VmFsdWVzKCk7XG5cbiAgICB1c2VySW5mb1JlbmRlcmVyLnNldFVzZXJJbmZvKGVkaXRGaWVsZHMpO1xuICAgIGFwaS5wYXRjaFByb2ZpbGVEYXRhKGVkaXRGaWVsZHMpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGVkaXRQb3B1cEJlaGF2aW9yLmNsb3NlKCk7XG4gICAgICB9KTtcbiAgfVxufSk7XG5lZGl0UG9wdXBCZWhhdmlvci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhZGRQb3B1cEJlaGF2aW9yID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBzb21lUG9wdXA6IHBvcHVwQWRkLFxuICBjYWxsQmFjazogKHNhdmVCdG4pID0+IHtcbiAgICBzYXZlQnRuLnRleHRDb250ZW50ID0gJ0NyZWF0aW5nLi4uJztcbiAgICBjb25zdCBhZGRGaWVsZHMgPSBhZGRQb3B1cEJlaGF2aW9yLmdldElucHV0VmFsdWVzKCk7XG4gICAgY29uc3QgbmV3Q2FyZCA9IHt9O1xuICAgIG5ld0NhcmQubmFtZSA9IGFkZEZpZWxkcy5wbGFjZVRpdGxlO1xuICAgIG5ld0NhcmQubGluayA9IGFkZEZpZWxkcy5wbGFjZUxpbms7XG5cbiAgICBhcGkucG9zdE5ld0NhcmREYXRhKG5ld0NhcmQpXG4gICAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgICBjYXJkLm15TmV3Q2FyZCA9IHRydWU7XG4gICAgICAgIGNhcmRSZW5kZXJlci5yZW5kZXJlcihjYXJkKTtcbiAgICAgICAgYWRkUG9wdXBCZWhhdmlvci5jbG9zZSgpO1xuICAgICAgfSlcbiAgfVxufSk7XG5hZGRQb3B1cEJlaGF2aW9yLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJJbmZvID0gdXNlckluZm9SZW5kZXJlci5nZXRVc2VySW5mbygpO1xuXG4gIGZpZWxkTmFtZS52YWx1ZSA9IHVzZXJJbmZvLm5hbWU7XG4gIGZpZWxkQWJvdXRNZS52YWx1ZSA9IHVzZXJJbmZvLmFib3V0O1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEVkaXRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcblxuICBlZGl0UG9wdXBCZWhhdmlvci5zd2l0Y2hCdG5Ub1NhdmUoKTtcbiAgZWRpdFBvcHVwQmVoYXZpb3Iub3BlbigpO1xufSk7XG5cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbcG9wdXBBZGRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgYWRkUG9wdXBCZWhhdmlvci5zd2l0Y2hCdG5Ub0NyZWF0ZSgpO1xuICBhZGRQb3B1cEJlaGF2aW9yLm9wZW4oKTtcbn0pO1xuXG5lZGl0QXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEFkZEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnN3aXRjaEJ0blRvU2F2ZSgpO1xuICBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5vcGVuKCk7XG59KTtcblxuY29uc3QgaW5pdEFwcCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGFwaS5nZXRNeVByb2ZpbGUoKVxuXG4gICAgLnRoZW4oKG15UHJvZmlsZSkgPT4ge1xuXG4gICAgICBwaG90b0NvbnRhaW5lci5zcmMgPSBteVByb2ZpbGUuYXZhdGFyO1xuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBteVByb2ZpbGUubmFtZTtcbiAgICAgIHByb2ZpbGVJbmZvLnRleHRDb250ZW50ID0gbXlQcm9maWxlLmFib3V0O1xuICAgICAgYXBpLmdldEluaXRpYWxDYXJkcygpXG4gICAgICAgIC50aGVuKChjYXJkcykgPT4ge1xuICAgICAgICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcbiAgICAgICAgICAgIGlmIChjYXJkLm93bmVyLl9pZCA9PT0gbXlQcm9maWxlLl9pZCkge1xuICAgICAgICAgICAgICBjYXJkLmlzTWluZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXJkUmVuZGVyZXIucmVuZGVyZXIoY2FyZClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9KVxufTtcblxuaW5pdEFwcCgpOyIsImV4cG9ydCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihmZXRjaERhdGEpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gZmV0Y2hEYXRhLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGZldGNoRGF0YS5oZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBnZXRNeVByb2ZpbGUoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBwb3N0TmV3Q2FyZERhdGEoY2FyZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxuICAgICAgICBsaW5rOiBjYXJkLmxpbmtcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcGF0Y2hQcm9maWxlRGF0YShlZGl0RmllbGRzKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZWRpdEZpZWxkcy5wcm9maWxlTmFtZSxcbiAgICAgICAgYWJvdXQ6IGVkaXRGaWVsZHMucHJvZmlsZUFib3V0XG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHBhdGNoQXZhdGFyKGZpZWxkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogZmllbGQudmFsdWUsXG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoaXRlbUlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzL2xpa2VzLyR7aXRlbUlkfWAsIHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgYWRkTGlrZShpdGVtSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpdGVtSWR9YCwge1xuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc29tZVBvcHVwKSB7XG4gICAgc3VwZXIoc29tZVBvcHVwKTtcbiAgICB0aGlzLl9wb3B1cENhcmRJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FyZC1pbWcnKTtcbiAgICB0aGlzLl9wb3B1cENhcmRUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FyZC10aXRsZScpO1xuICB9XG5cbiAgb3BlbiA9IChldnQpID0+IHtcbiAgICB0aGlzLl9wb3B1cENhcmRJbWFnZS5zcmMgPSBldnQudGFyZ2V0LnNyYztcbiAgICB0aGlzLl9wb3B1cENhcmRJbWFnZS5hbHQgPSBldnQudGFyZ2V0LmFsdDtcbiAgICB0aGlzLl9wb3B1cENhcmRUaXRsZS50ZXh0Q29udGVudCA9IGV2dC50YXJnZXQuYWx0O1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfTtcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhBdmFGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHNvbWVQb3B1cCwgY2FsbEJhY2sgfSkge1xuICAgIHN1cGVyKHNvbWVQb3B1cCk7XG4gICAgdGhpcy5fY2FsbEJhY2sgPSBjYWxsQmFjaztcbiAgICB0aGlzLl9maWVsZCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXQnKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICB0aGlzLl9zYXZlQnRuID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9jYWxsQmFjayh0aGlzLl9maWVsZCwgdGhpcy5fc2F2ZUJ0bik7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHN3aXRjaEJ0blRvU2F2ZSgpIHtcbiAgICB0aGlzLl9zYXZlQnRuLnRleHRDb250ZW50ID0gJ1NhdmUnO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxufSIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXIpIHtcbiAgICAvLyB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIF9jbGVhcigpIHtcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgfVxuXG4gIC8vIHJlbmRlckl0ZW1zKCkge1xuICAvLyAgIHRoaXMuX2NsZWFyKCk7XG5cbiAgLy8gICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgLy8gICAgIHRoaXMucmVuZGVyZXIoaXRlbSk7XG4gIC8vICAgfSk7XG4gIC8vIH1cbiAgYWRkUHJlcGVuZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xuICB9XG5cbiAgYWRkQXBwZW5kSXRlbShpdGVtKSB7XG5cbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGl0ZW0pO1xuXG4gIH1cbn07IiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IodXNlck5hbWUsIHVzZXJBYm91dCkge1xuICAgIHRoaXMuX25hbWUgPSB1c2VyTmFtZTtcbiAgICB0aGlzLl9hYm91dCA9IHVzZXJBYm91dDtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB1c2VySW5mb0xpc3QgPSB7fTtcbiAgICB1c2VySW5mb0xpc3QubmFtZSA9IHRoaXMuX25hbWUudGV4dENvbnRlbnQ7XG4gICAgdXNlckluZm9MaXN0LmFib3V0ID0gdGhpcy5fYWJvdXQudGV4dENvbnRlbnQ7XG4gICAgcmV0dXJuIHVzZXJJbmZvTGlzdDtcbiAgfVxuICBzZXRVc2VySW5mbyhuZXdVc2VyRGF0YSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuZXdVc2VyRGF0YS5wcm9maWxlTmFtZTtcbiAgICB0aGlzLl9hYm91dC50ZXh0Q29udGVudCA9IG5ld1VzZXJEYXRhLnByb2ZpbGVBYm91dDtcbiAgfVxufSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInAiLCJib2R5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUluZm8iLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwicG9wdXBFZGl0IiwicG9wdXBBZGQiLCJwb3B1cERlbGV0ZSIsInBob3RvQ29udGFpbmVyIiwicG9wdXBFZGl0QXZhdGFyIiwiZWRpdEF2YXRhckJ0biIsInBvcHVwRGVsZXRlWWVzQnV0dG9uIiwicG9wdXBDYXJkIiwicG9wdXBFZGl0Rm9ybSIsImZpZWxkTmFtZSIsImZpZWxkQWJvdXRNZSIsInBvcHVwQWRkRm9ybSIsImNhcmRzTGlzdCIsIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNlbGVjdG9ycyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVuYWJsZVZhbGlkYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImRpc2FibGVCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiX2hhc0ludmFsaWRJbnB1dCIsInJlbW92ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJzb21lUG9wdXAiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVDbGlja0Nsb3NlIiwiUG9wdXBXaXRoRm9ybSIsImNhbGxCYWNrIiwic3VwZXIiLCJfY2FsbEJhY2siLCJfZmllbGRzIiwiX3BvcHVwRm9ybSIsIl9zYXZlQnRuIiwiZ2V0SW5wdXRWYWx1ZXMiLCJmaWVsZHNMaXN0IiwiZmllbGQiLCJuYW1lIiwidmFsdWUiLCJzd2l0Y2hCdG5Ub0NyZWF0ZSIsInN3aXRjaEJ0blRvU2F2ZSIsInJlc2V0IiwiQ2FyZCIsImNhcmREYXRhIiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQmluQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfZWxlbWVudCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUNhcmRDbGljayIsIl9jYXJkVGVtcGxhdGUiLCJfZ2V0VGVtcGxhdGUiLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsIl9saWtlQnV0dG9uIiwiX2xpa2VzQW1vdW50IiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVCaW5DbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfbWluZUNhcmQiLCJpc01pbmUiLCJfbXlOZXdDYXJkIiwibXlOZXdDYXJkIiwiX2NhcmRMaWtlcyIsImxpa2VzIiwiX2luaXRpYWxMaWtlcyIsImxlbmd0aCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjcmVhdGVDYXJkIiwic3JjIiwiYWx0IiwiX2FkZERlbGV0ZUJ1dHRvblRvTmV3Q2FyZCIsIl9oYW5kbGVMaWtlSW5pdEFtb3VudCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwidG9nZ2xlTGlrZSIsIm15SWQiLCJsaWtlIiwiX2lkIiwiYWRkRGVsZXRlQnV0dG9uIiwibXlMaWtlIiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWFkZXJMb2dvU3JjIiwiYXBpIiwiZmV0Y2hEYXRhIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImdldE15UHJvZmlsZSIsImRlbGV0ZSIsImNhcmRJZCIsIm1ldGhvZCIsInBvc3ROZXdDYXJkRGF0YSIsImNhcmQiLCJKU09OIiwic3RyaW5naWZ5IiwicGF0Y2hQcm9maWxlRGF0YSIsImVkaXRGaWVsZHMiLCJhYm91dCIsInByb2ZpbGVBYm91dCIsInBhdGNoQXZhdGFyIiwiYXZhdGFyIiwiaXRlbUlkIiwiYXV0aG9yaXphdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiY29uZmlnIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJwb3B1cENhcmRSZW5kZXJlciIsIl9wb3B1cENhcmRJbWFnZSIsIl9wb3B1cENhcmRUaXRsZSIsInBvcHVwRGVsZXRlUmVuZGVyZXIiLCJwb3B1cEVkaXRBdmF0YXJSZW5kZXJlciIsIl9maWVsZCIsInNhdmVCdG4iLCJpdGVtIiwib25jbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJteVByb2ZpbGUiLCJjYXJkUmVuZGVyZXIiLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9jb250YWluZXIiLCJfY2xlYXIiLCJpbm5lckhUTUwiLCJhZGRQcmVwZW5kSXRlbSIsInByZXBlbmQiLCJhZGRBcHBlbmRJdGVtIiwiYXBwZW5kIiwiY2FyZEVsZW1lbnQiLCJ1c2VySW5mb1JlbmRlcmVyIiwidXNlck5hbWUiLCJ1c2VyQWJvdXQiLCJfYWJvdXQiLCJnZXRVc2VySW5mbyIsInVzZXJJbmZvTGlzdCIsInNldFVzZXJJbmZvIiwibmV3VXNlckRhdGEiLCJlZGl0UG9wdXBCZWhhdmlvciIsImFkZFBvcHVwQmVoYXZpb3IiLCJhZGRGaWVsZHMiLCJuZXdDYXJkIiwicGxhY2VUaXRsZSIsInBsYWNlTGluayIsInVzZXJJbmZvIiwiYXN5bmMiLCJjYXJkcyIsIm93bmVyIiwiaW5pdEFwcCJdLCJzb3VyY2VSb290IjoiIn0=