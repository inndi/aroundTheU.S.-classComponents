!function(){"use strict";var e={937:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}s.p="",function(){var e=s(937);const t=document.querySelector(".page"),r=t.querySelector(".profile"),n=r.querySelector(".profile__name"),o=r.querySelector(".profile__about-me"),i=r.querySelector(".profile__edit-btn"),a=r.querySelector(".profile__add-btn"),l=t.querySelector(".popup_edit"),c=t.querySelector(".popup_add"),h=t.querySelector(".popup_delete"),u=document.querySelector(".profile__photo"),p=document.querySelector(".popup_edit-photo"),_=p.querySelector(".popup__form"),d=document.querySelector(".profile__edit-avatar-btn"),m=h.querySelector(".popup__save-btn"),v=document.querySelector(".popup_card"),k=l.querySelector(".popup__form"),f=l.querySelector(".popup__input_field_name"),C=l.querySelector(".popup__input_field_about-me"),b=c.querySelector(".popup__form"),L=t.querySelector(".cards__list");class E{constructor(e,t){this._formSelector=e.formSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._buttonElement=this._formElement.querySelector(e.submitButtonSelector)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableButton():(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function y(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class g{constructor(e){y(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),y(this,"_handleClickClose",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-btn")&&this.close()})),this._popup=e}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}setEventListeners(){this._popup.addEventListener("mousedown",this._handleClickClose)}}class S extends g{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._fields=this._popup.querySelectorAll(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn")}getInputValues(){const e={};return this._fields.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack(this._saveBtn)})),super.setEventListeners()}switchBtnToCreate(){this._saveBtn.textContent="Create"}switchBtnToSave(){this._saveBtn.textContent="Save"}close(){super.close(),this._popupForm.reset()}}class B{constructor(e){let{cardData:t,cardTemplate:s,handleCardClick:r,handleBinClick:n,handleLikeClick:o}=e;var i,a;a=()=>{this._element.remove()},(i="_handleDeleteButton")in this?Object.defineProperty(this,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[i]=a,this._name=t.name,this._link=t.link,this._handleCardClick=r,this._cardTemplate=s,this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__img"),this._cardTitle=this._element.querySelector(".card__title"),this._likeButton=this._element.querySelector(".card__like-btn"),this._likesAmount=this._element.querySelector(".card__likes-amount"),this._deleteButton=this._element.querySelector(".card__delete-btn"),this._handleBinClick=n,this._handleLikeClick=o,this._mineCard=t.isMine,this._myNewCard=t.myNewCard,this._cardLikes=t.likes,this._initialLikes=t.likes.length}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".card").cloneNode(!0)}createCard(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._addDeleteButtonToNewCard(),this._handleLikeInitAmount(),this._element}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeClick),this._deleteButton.addEventListener("click",this._handleBinClick),this._cardImage.addEventListener("mousedown",this._handleCardClick)}addLike(e){this._likeButton.classList.add("card__like-btn_active"),this._likesAmount.textContent=e.length,this._cardLikes=e}removeLike(e){this._likeButton.classList.remove("card__like-btn_active"),this._likesAmount.textContent=e.length,this._cardLikes=e}toggleLike(e){return this._cardLikes.some((t=>t._id===e))}_handleLikeInitAmount(){this._likesAmount.textContent=this._initialLikes}_addDeleteButtonToNewCard(){this._myNewCard&&this._deleteButton.classList.add("card__delete-btn_active")}addDeleteButton(){this._mineCard&&this._deleteButton.classList.add("card__delete-btn_active")}myLike(e){this._cardLikes.forEach((t=>{t._id===e&&this._likeButton.classList.add("card__like-btn_active")}))}}document.getElementById("header-logo").src=e;const q=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}getMyProfile(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}delete(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}postNewCardData(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}patchProfileData(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.profileName,about:e.profileAbout})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}patchAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.value})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}removeLike(e){return fetch("https://around.nomoreparties.co/v1/group-12/cards/likes/".concat(e),{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}addLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>{console.log(e)}))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"2f92e6f8-d3bf-4f0b-b7c9-ecb844a65d7b","Content-Type":"application/json"}}),w={};var I;I={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(I.formSelector)).forEach((e=>{const t=new E(I,e),s=e.getAttribute("name");w[s]=t,t.enableValidation()}));const P=new class extends g{constructor(e){var t,s;super(e),s=e=>{this._popupCardImage.src=e.target.src,this._popupCardImage.alt=e.target.alt,this._popupCardTitle.textContent=e.target.alt,super.open()},(t="open")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this.open=s,this._popupCardImage=this._popup.querySelector(".popup__card-img"),this._popupCardTitle=this._popup.querySelector(".popup__card-title")}}(v);P.setEventListeners();const x=new g(h);x.setEventListeners();const T=new class extends g{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._field=this._popup.querySelector(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn")}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack(this._field,this._saveBtn)})),super.setEventListeners()}switchBtnToSave(){this._saveBtn.textContent="Save"}close(){super.close(),this._popupForm.reset()}}({somePopup:p,callBack:(e,t)=>{t.textContent="Saving...",q.patchAvatar(e).then((()=>{u.src=e.value,T.close()}))}});function A(e){const t=new B({cardData:e,cardTemplate:"#card-template",handleCardClick:e=>{P.open(e)},handleBinClick:()=>{x.open(),m.onclick=()=>{q.delete(e._id).then((()=>{t._handleDeleteButton(),x.close()}))}},handleLikeClick:()=>{q.getMyProfile().then((s=>{t.toggleLike(s._id)?q.removeLike(e._id).then((e=>{t.removeLike(e.likes)})):q.addLike(e._id).then((e=>{t.addLike(e.likes)}))}))}});return q.getMyProfile().then((e=>{t.myLike(e._id)})),t.addDeleteButton(),t.createCard()}T.setEventListeners();const j=new class{constructor(e,t){let{renderer:s}=e;this.renderer=s,this._container=t}_clear(){this._container.innerHTML=""}addPrependItem(e){this._container.prepend(e)}addAppendItem(e){this._container.append(e)}}({renderer:e=>{if(e.myNewCard){const t=A(e);j.addPrependItem(t)}else{const t=A(e);j.addAppendItem(t)}}},L),D=new class{constructor(e,t){this._name=e,this._about=t}getUserInfo(){const e={};return e.name=this._name.textContent,e.about=this._about.textContent,e}setUserInfo(e){this._name.textContent=e.profileName,this._about.textContent=e.profileAbout}}(n,o),N=new S({somePopup:l,callBack:e=>{e.textContent="Saving...";const t=N.getInputValues();D.setUserInfo(t),q.patchProfileData(t).then((()=>{N.close()}))}});N.setEventListeners();const U=new S({somePopup:c,callBack:e=>{e.textContent="Creating...";const t=U.getInputValues(),s={};s.name=t.placeTitle,s.link=t.placeLink,q.postNewCardData(s).then((e=>{e.myNewCard=!0,j.renderer(e),U.close()}))}});U.setEventListeners(),i.addEventListener("click",(()=>{const e=D.getUserInfo();f.value=e.name,C.value=e.about,w[k.getAttribute("name")].resetValidation(),N.switchBtnToSave(),N.open()})),a.addEventListener("click",(()=>{w[b.getAttribute("name")].resetValidation(),U.switchBtnToCreate(),U.open()})),d.addEventListener("click",(()=>{w[_.getAttribute("name")].resetValidation(),T.switchBtnToSave(),T.open()})),(async()=>{const e=await q.getMyProfile();u.src=e.avatar,n.textContent=e.name,o.textContent=e.about,(await q.getInitialCards()).forEach((t=>{t.owner._id===e._id&&(t.isMine=!0),j.renderer(t)}))})()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjZCLEVBQUtoRCxRQUFTLEdBRWhCMkUsRUFBYUUsU0FBUzdCLE9BSTFCd0QsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlcy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhBdmFGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJyk7XG5cbmNvbnN0IHByb2ZpbGUgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlJyk7XG5jb25zdCBwcm9maWxlTmFtZSA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX25hbWUnKTtcbmNvbnN0IHByb2ZpbGVJbmZvID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWJvdXQtbWUnKTtcbmNvbnN0IGVkaXRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ0bicpO1xuY29uc3QgYWRkQnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ0bicpO1xuXG5jb25zdCBwb3B1cEVkaXQgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9lZGl0Jyk7XG5jb25zdCBwb3B1cEFkZCA9IGJvZHkucXVlcnlTZWxlY3RvcignLnBvcHVwX2FkZCcpO1xuY29uc3QgcG9wdXBEZWxldGUgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9kZWxldGUnKTtcblxuY29uc3QgcGhvdG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcGhvdG8nKTtcbmNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9lZGl0LXBob3RvJyk7XG5jb25zdCBwb3B1cEVkaXRBdmFGb3JtID0gcG9wdXBFZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuY29uc3QgZWRpdEF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWF2YXRhci1idG4nKTtcblxuY29uc3QgcG9wdXBEZWxldGVZZXNCdXR0b24gPSBwb3B1cERlbGV0ZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XG5cbmNvbnN0IHBvcHVwQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9jYXJkJyk7XG5cbmNvbnN0IHBvcHVwRWRpdEZvcm0gPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG5jb25zdCBmaWVsZE5hbWUgPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF9uYW1lJyk7XG5jb25zdCBmaWVsZEFib3V0TWUgPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF9hYm91dC1tZScpO1xuXG5jb25zdCBwb3B1cEFkZEZvcm0gPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcblxuY29uc3QgY2FyZHNMaXN0ID0gYm9keS5xdWVyeVNlbGVjdG9yKCcuY2FyZHNfX2xpc3QnKTtcblxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlLWJ0bl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXG59O1xuXG5leHBvcnQge1xuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZUluZm8sXG4gIGVkaXRCdXR0b24sXG4gIGFkZEJ1dHRvbixcbiAgcG9wdXBFZGl0LFxuICBwb3B1cEFkZCxcbiAgcG9wdXBDYXJkLFxuICBwb3B1cEVkaXRGb3JtLFxuICBmaWVsZE5hbWUsXG4gIGZpZWxkQWJvdXRNZSxcbiAgcG9wdXBBZGRGb3JtLFxuICBjYXJkc0xpc3QsXG4gIHZhbGlkYXRpb25Db25maWcsXG4gIHBvcHVwRGVsZXRlLFxuICBwb3B1cERlbGV0ZVllc0J1dHRvbixcbiAgcGhvdG9Db250YWluZXIsXG4gIHBvcHVwRWRpdEF2YXRhcixcbiAgZWRpdEF2YXRhckJ0bixcbiAgcG9wdXBFZGl0QXZhRm9ybVxufTsiLCJcbmV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3JzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNlbGVjdG9ycy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNlbGVjdG9ycy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNlbGVjdG9ycy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNlbGVjdG9ycy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yKSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4geyBldnQucHJldmVudERlZmF1bHQoKSB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIGJ1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH07XG4gIH07XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH07XG4gIH07XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfTtcblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH07XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihzb21lUG9wdXApIHtcbiAgICB0aGlzLl9wb3B1cCA9IHNvbWVQb3B1cDtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgfVxuXG4gIF9oYW5kbGVDbGlja0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9O1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ0bicpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UpO1xuICB9XG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBzb21lUG9wdXAsIGNhbGxCYWNrIH0pIHtcbiAgICBzdXBlcihzb21lUG9wdXApO1xuICAgIHRoaXMuX2NhbGxCYWNrID0gY2FsbEJhY2s7XG4gICAgdGhpcy5fZmllbGRzID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX3NhdmVCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XG4gIH1cbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZmllbGRzTGlzdCA9IHt9O1xuICAgIHRoaXMuX2ZpZWxkcy5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgICAgZmllbGRzTGlzdFtmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBmaWVsZHNMaXN0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9jYWxsQmFjayh0aGlzLl9zYXZlQnRuKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgc3dpdGNoQnRuVG9DcmVhdGUoKSB7XG4gICAgdGhpcy5fc2F2ZUJ0bi50ZXh0Q29udGVudCA9ICdDcmVhdGUnO1xuICB9XG5cbiAgc3dpdGNoQnRuVG9TYXZlKCkge1xuICAgIHRoaXMuX3NhdmVCdG4udGV4dENvbnRlbnQgPSAnU2F2ZSc7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG5cbiAgY29uc3RydWN0b3IoeyBjYXJkRGF0YSwgY2FyZFRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUJpbkNsaWNrLCBoYW5kbGVMaWtlQ2xpY2sgfSkge1xuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBjYXJkVGVtcGxhdGU7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1nJyk7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idG4nKTtcbiAgICB0aGlzLl9saWtlc0Ftb3VudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2VzLWFtb3VudCcpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idG4nKTtcbiAgICB0aGlzLl9oYW5kbGVCaW5DbGljayA9IGhhbmRsZUJpbkNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgICB0aGlzLl9taW5lQ2FyZCA9IGNhcmREYXRhLmlzTWluZTtcbiAgICB0aGlzLl9teU5ld0NhcmQgPSBjYXJkRGF0YS5teU5ld0NhcmQ7XG4gICAgdGhpcy5fY2FyZExpa2VzID0gY2FyZERhdGEubGlrZXM7XG4gICAgdGhpcy5faW5pdGlhbExpa2VzID0gY2FyZERhdGEubGlrZXMubGVuZ3RoO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRUZW1wbGF0ZSlcbiAgICAgIC5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2FkZERlbGV0ZUJ1dHRvblRvTmV3Q2FyZCgpXG4gICAgdGhpcy5faGFuZGxlTGlrZUluaXRBbW91bnQoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVMaWtlQ2xpY2spO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUJpbkNsaWNrKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcbiAgfVxuXG5cbiAgYWRkTGlrZShsaWtlcykge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idG5fYWN0aXZlJyk7XG4gICAgdGhpcy5fbGlrZXNBbW91bnQudGV4dENvbnRlbnQgPSBsaWtlcy5sZW5ndGg7XG4gICAgdGhpcy5fY2FyZExpa2VzID0gbGlrZXM7XG4gIH1cblxuICByZW1vdmVMaWtlKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcbiAgICB0aGlzLl9saWtlc0Ftb3VudC50ZXh0Q29udGVudCA9IGxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSBsaWtlcztcbiAgfVxuXG4gIHRvZ2dsZUxpa2UobXlJZCkge1xuICAgIGNvbnN0IGlzTXlMaWtlID0gdGhpcy5fY2FyZExpa2VzLnNvbWUobGlrZSA9PiBsaWtlLl9pZCA9PT0gbXlJZCk7XG4gICAgcmV0dXJuIGlzTXlMaWtlO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VJbml0QW1vdW50KCkge1xuICAgIHRoaXMuX2xpa2VzQW1vdW50LnRleHRDb250ZW50ID0gdGhpcy5faW5pdGlhbExpa2VzO1xuICB9XG5cbiAgX2FkZERlbGV0ZUJ1dHRvblRvTmV3Q2FyZCgpIHtcbiAgICBpZiAodGhpcy5fbXlOZXdDYXJkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fZGVsZXRlLWJ0bl9hY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBhZGREZWxldGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX21pbmVDYXJkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fZGVsZXRlLWJ0bl9hY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlRGVsZXRlQnV0dG9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBteUxpa2UobXlJZCkge1xuICAgIHRoaXMuX2NhcmRMaWtlcy5mb3JFYWNoKChsaWtlKSA9PiB7XG4gICAgICBpZiAobGlrZS5faWQgPT09IG15SWQpIHtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcbiAgICAgIH07XG4gICAgfSlcbiAgfVxufSIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgaGVhZGVyTG9nb1NyYyBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XG5cbmNvbnN0IGhlYWRlckxvZ28gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlYWRlci1sb2dvXCIpO1xuaGVhZGVyTG9nby5zcmMgPSBoZWFkZXJMb2dvU3JjO1xuXG5pbXBvcnQge1xuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZUluZm8sXG4gIGVkaXRCdXR0b24sXG4gIGFkZEJ1dHRvbixcbiAgcG9wdXBFZGl0LFxuICBwb3B1cEFkZCxcbiAgcG9wdXBDYXJkLFxuICBwb3B1cEVkaXRGb3JtLFxuICBmaWVsZE5hbWUsXG4gIGZpZWxkQWJvdXRNZSxcbiAgcG9wdXBBZGRGb3JtLFxuICBjYXJkc0xpc3QsXG4gIHZhbGlkYXRpb25Db25maWcsXG4gIHBvcHVwRGVsZXRlLFxuICBwb3B1cERlbGV0ZVllc0J1dHRvbixcbiAgcGhvdG9Db250YWluZXIsXG4gIHBvcHVwRWRpdEF2YXRhcixcbiAgZWRpdEF2YXRhckJ0bixcbiAgcG9wdXBFZGl0QXZhRm9ybVxufSBmcm9tICcuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyc7XG5cbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZXMuanMnO1xuaW1wb3J0IHsgUG9wdXAgfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcbmltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhBdmFGb3JtIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhBdmFGb3JtLmpzXCI7XG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjJmOTJlNmY4LWQzYmYtNGYwYi1iN2M5LWVjYjg0NGE2NWQ3YlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gIH1cbn0pO1xuXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKTtcblxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XG5cbmNvbnN0IHBvcHVwQ2FyZFJlbmRlcmVyID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwQ2FyZCk7XG5wb3B1cENhcmRSZW5kZXJlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cERlbGV0ZVJlbmRlcmVyID0gbmV3IFBvcHVwKHBvcHVwRGVsZXRlKTtcbnBvcHVwRGVsZXRlUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIgPSBuZXcgUG9wdXBXaXRoQXZhRm9ybSh7XG4gIHNvbWVQb3B1cDogcG9wdXBFZGl0QXZhdGFyLFxuICBjYWxsQmFjazogKGZpZWxkLCBzYXZlQnRuKSA9PiB7XG4gICAgc2F2ZUJ0bi50ZXh0Q29udGVudCA9ICdTYXZpbmcuLi4nO1xuICAgIGFwaS5wYXRjaEF2YXRhcihmaWVsZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcGhvdG9Db250YWluZXIuc3JjID0gZmllbGQudmFsdWU7XG4gICAgICAgIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLmNsb3NlKCk7XG4gICAgICB9KVxuICB9XG59KTtcbnBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgIGNhcmREYXRhOiBpdGVtLFxuICAgIGNhcmRUZW1wbGF0ZTogJyNjYXJkLXRlbXBsYXRlJyxcbiAgICBoYW5kbGVDYXJkQ2xpY2s6IChldnQpID0+IHtcbiAgICAgIHBvcHVwQ2FyZFJlbmRlcmVyLm9wZW4oZXZ0KTtcbiAgICB9LFxuICAgIGhhbmRsZUJpbkNsaWNrOiAoKSA9PiB7XG4gICAgICBwb3B1cERlbGV0ZVJlbmRlcmVyLm9wZW4oKTtcbiAgICAgIHBvcHVwRGVsZXRlWWVzQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIGFwaS5kZWxldGUoaXRlbS5faWQpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY2FyZC5faGFuZGxlRGVsZXRlQnV0dG9uKCk7XG4gICAgICAgICAgICBwb3B1cERlbGV0ZVJlbmRlcmVyLmNsb3NlKCk7XG4gICAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfSxcbiAgICBoYW5kbGVMaWtlQ2xpY2s6ICgpID0+IHtcblxuICAgICAgYXBpLmdldE15UHJvZmlsZSgpXG4gICAgICAgIC50aGVuKChteVByb2ZpbGUpID0+IHtcbiAgICAgICAgICBjb25zdCBpc015TGlrZSA9IGNhcmQudG9nZ2xlTGlrZShteVByb2ZpbGUuX2lkKTtcbiAgICAgICAgICBpZiAoaXNNeUxpa2UpIHtcbiAgICAgICAgICAgIGFwaS5yZW1vdmVMaWtlKGl0ZW0uX2lkKVxuICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZC5yZW1vdmVMaWtlKHJlcy5saWtlcyk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFwaS5hZGRMaWtlKGl0ZW0uX2lkKVxuICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZC5hZGRMaWtlKHJlcy5saWtlcyk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgfSk7XG4gIGFwaS5nZXRNeVByb2ZpbGUoKVxuICAgIC50aGVuKChteVByb2ZpbGUpID0+IHtcbiAgICAgIGNhcmQubXlMaWtlKG15UHJvZmlsZS5faWQpO1xuICAgIH0pO1xuXG4gIGNhcmQuYWRkRGVsZXRlQnV0dG9uKCk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5jcmVhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudFxufVxuXG5jb25zdCBjYXJkUmVuZGVyZXIgPSBuZXcgU2VjdGlvbih7XG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIGlmIChpdGVtLm15TmV3Q2FyZCkge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgY2FyZFJlbmRlcmVyLmFkZFByZXBlbmRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgY2FyZFJlbmRlcmVyLmFkZEFwcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgIH1cbiAgfVxufSwgY2FyZHNMaXN0KTtcblxuY29uc3QgdXNlckluZm9SZW5kZXJlciA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZUluZm8pO1xuXG5jb25zdCBlZGl0UG9wdXBCZWhhdmlvciA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgc29tZVBvcHVwOiBwb3B1cEVkaXQsXG4gIGNhbGxCYWNrOiAoc2F2ZUJ0bikgPT4ge1xuICAgIHNhdmVCdG4udGV4dENvbnRlbnQgPSAnU2F2aW5nLi4uJztcbiAgICBjb25zdCBlZGl0RmllbGRzID0gZWRpdFBvcHVwQmVoYXZpb3IuZ2V0SW5wdXRWYWx1ZXMoKTtcblxuICAgIHVzZXJJbmZvUmVuZGVyZXIuc2V0VXNlckluZm8oZWRpdEZpZWxkcyk7XG4gICAgYXBpLnBhdGNoUHJvZmlsZURhdGEoZWRpdEZpZWxkcylcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZWRpdFBvcHVwQmVoYXZpb3IuY2xvc2UoKTtcbiAgICAgIH0pO1xuICB9XG59KTtcbmVkaXRQb3B1cEJlaGF2aW9yLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZFBvcHVwQmVoYXZpb3IgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHNvbWVQb3B1cDogcG9wdXBBZGQsXG4gIGNhbGxCYWNrOiAoc2F2ZUJ0bikgPT4ge1xuICAgIHNhdmVCdG4udGV4dENvbnRlbnQgPSAnQ3JlYXRpbmcuLi4nO1xuICAgIGNvbnN0IGFkZEZpZWxkcyA9IGFkZFBvcHVwQmVoYXZpb3IuZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICBjb25zdCBuZXdDYXJkID0ge307XG4gICAgbmV3Q2FyZC5uYW1lID0gYWRkRmllbGRzLnBsYWNlVGl0bGU7XG4gICAgbmV3Q2FyZC5saW5rID0gYWRkRmllbGRzLnBsYWNlTGluaztcblxuICAgIGFwaS5wb3N0TmV3Q2FyZERhdGEobmV3Q2FyZClcbiAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgIGNhcmQubXlOZXdDYXJkID0gdHJ1ZTtcbiAgICAgICAgY2FyZFJlbmRlcmVyLnJlbmRlcmVyKGNhcmQpO1xuICAgICAgICBhZGRQb3B1cEJlaGF2aW9yLmNsb3NlKCk7XG4gICAgICB9KVxuICB9XG59KTtcbmFkZFBvcHVwQmVoYXZpb3Iuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgY29uc3QgdXNlckluZm8gPSB1c2VySW5mb1JlbmRlcmVyLmdldFVzZXJJbmZvKCk7XG5cbiAgZmllbGROYW1lLnZhbHVlID0gdXNlckluZm8ubmFtZTtcbiAgZmllbGRBYm91dE1lLnZhbHVlID0gdXNlckluZm8uYWJvdXQ7XG4gIGZvcm1WYWxpZGF0b3JzW3BvcHVwRWRpdEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIGVkaXRQb3B1cEJlaGF2aW9yLnN3aXRjaEJ0blRvU2F2ZSgpO1xuICBlZGl0UG9wdXBCZWhhdmlvci5vcGVuKCk7XG59KTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEFkZEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhZGRQb3B1cEJlaGF2aW9yLnN3aXRjaEJ0blRvQ3JlYXRlKCk7XG4gIGFkZFBvcHVwQmVoYXZpb3Iub3BlbigpO1xufSk7XG5cbmVkaXRBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW3BvcHVwRWRpdEF2YUZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnN3aXRjaEJ0blRvU2F2ZSgpO1xuICBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5vcGVuKCk7XG59KTtcblxuY29uc3QgaW5pdEFwcCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGFwaS5nZXRNeVByb2ZpbGUoKTtcblxuICBwaG90b0NvbnRhaW5lci5zcmMgPSB1c2VyLmF2YXRhcjtcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyLm5hbWU7XG4gIHByb2ZpbGVJbmZvLnRleHRDb250ZW50ID0gdXNlci5hYm91dDtcblxuICBjb25zdCBjYXJkcyA9IGF3YWl0IGFwaS5nZXRJbml0aWFsQ2FyZHMoKTtcblxuICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgaWYgKGNhcmQub3duZXIuX2lkID09PSB1c2VyLl9pZCkge1xuICAgICAgY2FyZC5pc01pbmUgPSB0cnVlO1xuICAgIH1cbiAgICBjYXJkUmVuZGVyZXIucmVuZGVyZXIoY2FyZClcbiAgfSk7XG59O1xuXG5pbml0QXBwKCk7IiwiZXhwb3J0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGZldGNoRGF0YSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBmZXRjaERhdGEuYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gZmV0Y2hEYXRhLmhlYWRlcnM7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGdldE15UHJvZmlsZSgpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHBvc3ROZXdDYXJkRGF0YShjYXJkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXG4gICAgICAgIGxpbms6IGNhcmQubGlua1xuICAgICAgfSlcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBwYXRjaFByb2ZpbGVEYXRhKGVkaXRGaWVsZHMpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBlZGl0RmllbGRzLnByb2ZpbGVOYW1lLFxuICAgICAgICBhYm91dDogZWRpdEZpZWxkcy5wcm9maWxlQWJvdXRcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcGF0Y2hBdmF0YXIoZmllbGQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBmaWVsZC52YWx1ZSxcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlTGlrZShpdGVtSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvbGlrZXMvJHtpdGVtSWR9YCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBhZGRMaWtlKGl0ZW1JZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2l0ZW1JZH1gLCB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihzb21lUG9wdXApIHtcbiAgICBzdXBlcihzb21lUG9wdXApO1xuICAgIHRoaXMuX3BvcHVwQ2FyZEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXJkLWltZycpO1xuICAgIHRoaXMuX3BvcHVwQ2FyZFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXJkLXRpdGxlJyk7XG4gIH1cblxuICBvcGVuID0gKGV2dCkgPT4ge1xuICAgIHRoaXMuX3BvcHVwQ2FyZEltYWdlLnNyYyA9IGV2dC50YXJnZXQuc3JjO1xuICAgIHRoaXMuX3BvcHVwQ2FyZEltYWdlLmFsdCA9IGV2dC50YXJnZXQuYWx0O1xuICAgIHRoaXMuX3BvcHVwQ2FyZFRpdGxlLnRleHRDb250ZW50ID0gZXZ0LnRhcmdldC5hbHQ7XG4gICAgc3VwZXIub3BlbigpO1xuICB9O1xufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEF2YUZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgc29tZVBvcHVwLCBjYWxsQmFjayB9KSB7XG4gICAgc3VwZXIoc29tZVBvcHVwKTtcbiAgICB0aGlzLl9jYWxsQmFjayA9IGNhbGxCYWNrO1xuICAgIHRoaXMuX2ZpZWxkID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dCcpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX3NhdmVCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2NhbGxCYWNrKHRoaXMuX2ZpZWxkLCB0aGlzLl9zYXZlQnRuKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgc3dpdGNoQnRuVG9TYXZlKCkge1xuICAgIHRoaXMuX3NhdmVCdG4udGV4dENvbnRlbnQgPSAnU2F2ZSc7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xuICAgIC8vIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuICB9XG5cbiAgX2NsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICB9XG5cbiAgLy8gcmVuZGVySXRlbXMoKSB7XG4gIC8vICAgdGhpcy5fY2xlYXIoKTtcblxuICAvLyAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAvLyAgICAgdGhpcy5yZW5kZXJlcihpdGVtKTtcbiAgLy8gICB9KTtcbiAgLy8gfVxuICBhZGRQcmVwZW5kSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gIH1cblxuICBhZGRBcHBlbmRJdGVtKGl0ZW0pIHtcblxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XG5cbiAgfVxufTsiLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZSwgdXNlckFib3V0KSB7XG4gICAgdGhpcy5fbmFtZSA9IHVzZXJOYW1lO1xuICAgIHRoaXMuX2Fib3V0ID0gdXNlckFib3V0O1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJJbmZvTGlzdCA9IHt9O1xuICAgIHVzZXJJbmZvTGlzdC5uYW1lID0gdGhpcy5fbmFtZS50ZXh0Q29udGVudDtcbiAgICB1c2VySW5mb0xpc3QuYWJvdXQgPSB0aGlzLl9hYm91dC50ZXh0Q29udGVudDtcbiAgICByZXR1cm4gdXNlckluZm9MaXN0O1xuICB9XG4gIHNldFVzZXJJbmZvKG5ld1VzZXJEYXRhKSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5ld1VzZXJEYXRhLnByb2ZpbGVOYW1lO1xuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gbmV3VXNlckRhdGEucHJvZmlsZUFib3V0O1xuICB9XG59Il0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwicCIsImJvZHkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcm9maWxlIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlSW5mbyIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJwb3B1cEVkaXQiLCJwb3B1cEFkZCIsInBvcHVwRGVsZXRlIiwicGhvdG9Db250YWluZXIiLCJwb3B1cEVkaXRBdmF0YXIiLCJwb3B1cEVkaXRBdmFGb3JtIiwiZWRpdEF2YXRhckJ0biIsInBvcHVwRGVsZXRlWWVzQnV0dG9uIiwicG9wdXBDYXJkIiwicG9wdXBFZGl0Rm9ybSIsImZpZWxkTmFtZSIsImZpZWxkQWJvdXRNZSIsInBvcHVwQWRkRm9ybSIsImNhcmRzTGlzdCIsIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNlbGVjdG9ycyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVuYWJsZVZhbGlkYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImRpc2FibGVCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiX2hhc0ludmFsaWRJbnB1dCIsInJlbW92ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJzb21lUG9wdXAiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVDbGlja0Nsb3NlIiwiUG9wdXBXaXRoRm9ybSIsImNhbGxCYWNrIiwic3VwZXIiLCJfY2FsbEJhY2siLCJfZmllbGRzIiwiX3BvcHVwRm9ybSIsIl9zYXZlQnRuIiwiZ2V0SW5wdXRWYWx1ZXMiLCJmaWVsZHNMaXN0IiwiZmllbGQiLCJuYW1lIiwidmFsdWUiLCJzd2l0Y2hCdG5Ub0NyZWF0ZSIsInN3aXRjaEJ0blRvU2F2ZSIsInJlc2V0IiwiQ2FyZCIsImNhcmREYXRhIiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQmluQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfZWxlbWVudCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUNhcmRDbGljayIsIl9jYXJkVGVtcGxhdGUiLCJfZ2V0VGVtcGxhdGUiLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsIl9saWtlQnV0dG9uIiwiX2xpa2VzQW1vdW50IiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVCaW5DbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfbWluZUNhcmQiLCJpc01pbmUiLCJfbXlOZXdDYXJkIiwibXlOZXdDYXJkIiwiX2NhcmRMaWtlcyIsImxpa2VzIiwiX2luaXRpYWxMaWtlcyIsImxlbmd0aCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjcmVhdGVDYXJkIiwic3JjIiwiYWx0IiwiX2FkZERlbGV0ZUJ1dHRvblRvTmV3Q2FyZCIsIl9oYW5kbGVMaWtlSW5pdEFtb3VudCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwidG9nZ2xlTGlrZSIsIm15SWQiLCJsaWtlIiwiX2lkIiwiYWRkRGVsZXRlQnV0dG9uIiwibXlMaWtlIiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWFkZXJMb2dvU3JjIiwiYXBpIiwiZmV0Y2hEYXRhIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImdldE15UHJvZmlsZSIsImRlbGV0ZSIsImNhcmRJZCIsIm1ldGhvZCIsInBvc3ROZXdDYXJkRGF0YSIsImNhcmQiLCJKU09OIiwic3RyaW5naWZ5IiwicGF0Y2hQcm9maWxlRGF0YSIsImVkaXRGaWVsZHMiLCJhYm91dCIsInByb2ZpbGVBYm91dCIsInBhdGNoQXZhdGFyIiwiYXZhdGFyIiwiaXRlbUlkIiwiYXV0aG9yaXphdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiY29uZmlnIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJwb3B1cENhcmRSZW5kZXJlciIsIl9wb3B1cENhcmRJbWFnZSIsIl9wb3B1cENhcmRUaXRsZSIsInBvcHVwRGVsZXRlUmVuZGVyZXIiLCJwb3B1cEVkaXRBdmF0YXJSZW5kZXJlciIsIl9maWVsZCIsInNhdmVCdG4iLCJpdGVtIiwib25jbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJteVByb2ZpbGUiLCJjYXJkUmVuZGVyZXIiLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9jb250YWluZXIiLCJfY2xlYXIiLCJpbm5lckhUTUwiLCJhZGRQcmVwZW5kSXRlbSIsInByZXBlbmQiLCJhZGRBcHBlbmRJdGVtIiwiYXBwZW5kIiwiY2FyZEVsZW1lbnQiLCJ1c2VySW5mb1JlbmRlcmVyIiwidXNlck5hbWUiLCJ1c2VyQWJvdXQiLCJfYWJvdXQiLCJnZXRVc2VySW5mbyIsInVzZXJJbmZvTGlzdCIsInNldFVzZXJJbmZvIiwibmV3VXNlckRhdGEiLCJlZGl0UG9wdXBCZWhhdmlvciIsImFkZFBvcHVwQmVoYXZpb3IiLCJhZGRGaWVsZHMiLCJuZXdDYXJkIiwicGxhY2VUaXRsZSIsInBsYWNlTGluayIsInVzZXJJbmZvIiwiYXN5bmMiLCJ1c2VyIiwib3duZXIiLCJpbml0QXBwIl0sInNvdXJjZVJvb3QiOiIifQ==