!function(){"use strict";var e={937:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,s),r.exports}s.p="",function(){var e=s(937);const t=document.querySelector(".page"),i=t.querySelector(".profile"),n=i.querySelector(".profile__name"),r=i.querySelector(".profile__about-me"),o=i.querySelector(".profile__edit-btn"),a=i.querySelector(".profile__add-btn"),l=t.querySelector(".popup_edit"),c=t.querySelector(".popup_add"),d=t.querySelector(".popup_delete"),_=document.querySelector(".profile__photo"),h=document.querySelector(".popup_edit-photo"),p=h.querySelector(".popup__form"),u=document.querySelector(".profile__edit-avatar-btn"),m=document.querySelector(".popup_card"),k=(h.querySelector(".popup__input_field_link"),l.querySelector(".popup__form")),f=l.querySelector(".popup__input_field_name"),v=l.querySelector(".popup__input_field_about-me"),L=c.querySelector(".popup__form"),y=(c.querySelector(".popup__input_field_title"),c.querySelector(".popup__input_field_link"),t.querySelector(".cards__list"));class C{constructor(e,t){this._formSelector=e.formSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._buttonElement=this._formElement.querySelector(e.submitButtonSelector)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableButton():(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class E{constructor(e){b(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),b(this,"_handleClickClose",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-btn")&&this.close()})),this._popup=e}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}setEventListeners(){this._popup.addEventListener("mousedown",this._handleClickClose)}}class g extends E{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._fields=this._popup.querySelectorAll(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn"),this._saveButtonText=this._saveBtn.textContent}getInputValues(){const e={};return this._fields.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack()})),super.setEventListeners()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._saveBtn.textContent=e?t:this._saveButtonText}close(){super.close(),this._popupForm.reset()}}class S{constructor(e){let{cardData:t,userId:s,cardTemplate:i,handleCardClick:n,handleBinClick:r,handleLikeClick:o}=e;var a,l;l=()=>{this._element.remove()},(a="handleDeleteButton")in this?Object.defineProperty(this,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):this[a]=l,this._name=t.name,this._link=t.link,this._handleCardClick=n,this._cardTemplate=i,this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__img"),this._cardTitle=this._element.querySelector(".card__title"),this._likeButton=this._element.querySelector(".card__like-btn"),this._likesAmount=this._element.querySelector(".card__likes-amount"),this._deleteButton=this._element.querySelector(".card__delete-btn"),this._handleBinClick=r,this._handleLikeClick=o,this._mineCard=t.isMine,this._myNewCard=t.myNewCard,this._cardLikes=t.likes,this._initialLikes=t.likes.length,this._userId=s}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".card").cloneNode(!0)}createCard(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._handleLikeInitAmount(),this._addDeleteButton(),this._checkLikes(),this._element}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeClick),this._deleteButton.addEventListener("click",this._handleBinClick),this._cardImage.addEventListener("mousedown",this._handleCardClick)}_updateLikes(e){this._likesAmount.textContent=e.length,this._cardLikes=e}addLike(e){this._likeButton.classList.add("card__like-btn_active"),this._updateLikes(e)}removeLike(e){this._likeButton.classList.remove("card__like-btn_active"),this._updateLikes(e)}isLiked(){return this._cardLikes.some((e=>e._id===this._userId))}_handleLikeInitAmount(){this._likesAmount.textContent=this._initialLikes}_addDeleteButton(){(this._mineCard||this._myNewCard)&&this._deleteButton.classList.add("card__delete-btn_active")}_checkLikes(){this._cardLikes.forEach((e=>{e._id===this._userId&&this._likeButton.classList.add("card__like-btn_active")}))}}document.getElementById("header-logo").src=e;const I={};I.name=n,I.info=r,I.avatar=_,I.popupFieldName=f,I.popupFieldInfo=v;const B=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}getMyProfile(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}delete(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}postNewCardData(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}patchProfileData(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.profileName,about:e.profileAbout})}).then(this._checkResponse)}patchAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatarLink})}).then(this._checkResponse)}removeLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"2f92e6f8-d3bf-4f0b-b7c9-ecb844a65d7b","Content-Type":"application/json"}}),q={};var w;w={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(w.formSelector)).forEach((e=>{const t=new C(w,e),s=e.getAttribute("name");q[s]=t,t.enableValidation()}));const A=new class extends E{constructor(e){super(e),this._popupCardImage=this._popup.querySelector(".popup__card-img"),this._popupCardTitle=this._popup.querySelector(".popup__card-title")}open(e){this._popupCardImage.src=e.link,this._popupCardImage.alt=e.name,this._popupCardTitle.textContent=e.name,super.open()}}(m);A.setEventListeners();const x=new class extends E{constructor(e){super(e),this._yesBtn=this._popup.querySelector(".popup__save-btn")}open(e){super.open(),this._onDelete=e,this._yesBtn.addEventListener("click",this._onDelete)}close(){super.close(),this._yesBtn.removeEventListener("click",this._onDelete),this._onDelete=null}}(d);x.setEventListeners();const T=new class{constructor(e){this._fieldName=e.name,this._fieldInfo=e.info,this._photoContainer=e.avatar}getUserInfo(){const e={};return e.name=this._fieldName.textContent,e.about=this._fieldInfo.textContent,e}setUserInfo(e){this._userId=e._id,this._photoContainer.src=e.avatar,this._fieldName.textContent=e.name,this._fieldInfo.textContent=e.about}}(I);function D(e,t){const s=new S({cardData:e,userId:t,cardTemplate:"#card-template",handleCardClick:()=>{A.open(e)},handleBinClick:()=>{x.open((()=>B.delete(e._id).then((()=>{s.handleDeleteButton(),x.close()})).catch((e=>{console.log(e)}))))},handleLikeClick:()=>{s.isLiked()?B.removeLike(e._id).then((e=>{s.removeLike(e.likes)})).catch((e=>{console.log(e)})):B.addLike(e._id).then((e=>{s.addLike(e.likes)})).catch((e=>{console.log(e)}))}});return s.createCard()}const U=new class{constructor(e,t){let{renderer:s}=e;this.renderer=s,this._container=t}_clear(){this._container.innerHTML=""}addPrependItem(e){this._container.prepend(e)}addAppendItem(e){this._container.append(e)}}({renderer:(e,t)=>{if(e.myNewCard){const s=D(e,t);U.addPrependItem(s)}else{const s=D(e,t);U.addAppendItem(s)}}},y),N=new g({somePopup:h,callBack:()=>{N.renderLoading(!0);const e=N.getInputValues();B.patchAvatar(e).then((e=>{T.setUserInfo(e),N.close()})).catch((e=>{console.log(e)})).finally((function(){N.renderLoading(!1)}))}});N.setEventListeners();const P=new g({somePopup:l,callBack:()=>{P.renderLoading(!0);const e=P.getInputValues();B.patchProfileData(e).then((e=>{T.setUserInfo(e),P.close()})).catch((e=>{console.log(e)})).finally((function(){P.renderLoading(!1)}))}});P.setEventListeners();const V=new g({somePopup:c,callBack:()=>{V.renderLoading(!0,"Creating...");const e=V.getInputValues(),t={};t.name=e.placeTitle,t.link=e.placeLink,B.postNewCardData(t).then((e=>{e.myNewCard=!0,U.renderer(e,e.owner._id),V.close()})).catch((e=>{console.log(e)})).finally((function(){V.renderLoading(!1)}))}});V.setEventListeners(),a.addEventListener("click",(()=>{q[L.getAttribute("name")].resetValidation(),V.open()})),u.addEventListener("click",(()=>{q[p.getAttribute("name")].resetValidation(),N.open()})),o.addEventListener("click",(()=>{q[k.getAttribute("name")].resetValidation();const e=T.getUserInfo();I.popupFieldName.value=e.name,I.popupFieldInfo.value=e.about,P.open()}));try{(async()=>{const e=await B.getMyProfile();T.setUserInfo(e),(await B.getInitialCards()).forEach((t=>{t.owner._id===e._id&&(t.isMine=!0),U.renderer(t,e._id)}))})()}catch(e){console.log(e)}}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQ2pCNUQsTUFBTU0sSUFDTEEsRUFBS2hELFdBQVksRUFFakJxRixFQUFhRSxTQUFTdkMsRUFBTUEsRUFBS3lELE1BQU10RixLQUN2Q2lGLEVBQWlCdEosV0FFbEJtSSxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixNQUViZ0IsU0FBUSxXQUNQRSxFQUFpQmhJLGVBQWMsU0FJdkNnSSxFQUFpQi9JLG9CQUVqQjFFLEVBQVVvQyxpQkFBaUIsU0FBUyxLQUNsQzRJLEVBQWVwSyxFQUFhd0ssYUFBYSxTQUFTckgsa0JBRWxEMEosRUFBaUJsSixVQUduQmhFLEVBQWM2QixpQkFBaUIsU0FBUyxLQUN0QzRJLEVBQWUxSyxFQUFpQjhLLGFBQWEsU0FBU3JILGtCQUV0RHNKLEVBQXdCOUksVUFHMUJ4RSxFQUFXcUMsaUJBQWlCLFNBQVMsS0FDbkM0SSxFQUFldkssRUFBYzJLLGFBQWEsU0FBU3JILGtCQUVuRCxNQUFNZ0ssRUFBV2xDLEVBQVNJLGNBQzFCdEQsRUFBZUcsZUFBZXRELE1BQVF1SSxFQUFTeEksS0FDL0NvRCxFQUFlSSxlQUFldkQsTUFBUXVJLEVBQVNyRCxNQUUvQzhDLEVBQWtCakosVUFtQnBCLElBaEJnQnlKLFdBQ2QsTUFBTTVCLFFBQWFwRCxFQUFJZ0IsZUFFdkI2QixFQUFTTSxZQUFZQyxVQUVEcEQsRUFBSWEsbUJBRWxCcEgsU0FBUzRILElBQ1RBLEVBQUt5RCxNQUFNdEYsTUFBUTRELEVBQUs1RCxNQUMxQjZCLEVBQUtsRCxRQUFTLEdBRWhCdUYsRUFBYUUsU0FBU3ZDLEVBQU0rQixFQUFLNUQsU0FNbkN5RixHQUNBLE1BQU9DLEdBQ1AxQixRQUFRQyxJQUFJeUIsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlcy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Db25maXJtYXRpb25Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFnZScpO1xuXG5jb25zdCBwcm9maWxlID0gYm9keS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19uYW1lJyk7XG5jb25zdCBwcm9maWxlSW5mbyA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Fib3V0LW1lJyk7XG5jb25zdCBlZGl0QnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idG4nKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idG4nKTtcblxuY29uc3QgcG9wdXBFZGl0ID0gYm9keS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfZWRpdCcpO1xuY29uc3QgcG9wdXBBZGQgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9hZGQnKTtcbmNvbnN0IHBvcHVwRGVsZXRlID0gYm9keS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfZGVsZXRlJyk7XG5cbmNvbnN0IHBob3RvQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3Bob3RvJyk7XG5jb25zdCBwb3B1cEVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfZWRpdC1waG90bycpO1xuY29uc3QgcG9wdXBFZGl0QXZhRm9ybSA9IHBvcHVwRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbmNvbnN0IGVkaXRBdmF0YXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1hdmF0YXItYnRuJyk7XG5cbmNvbnN0IHBvcHVwQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9jYXJkJyk7XG5cbmNvbnN0IHBvcHVwQXZhdGFyTGluayA9IHBvcHVwRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2ZpZWxkX2xpbmsnKTtcblxuY29uc3QgcG9wdXBFZGl0Rm9ybSA9IHBvcHVwRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbmNvbnN0IGZpZWxkTmFtZSA9IHBvcHVwRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2ZpZWxkX25hbWUnKTtcbmNvbnN0IGZpZWxkQWJvdXRNZSA9IHBvcHVwRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2ZpZWxkX2Fib3V0LW1lJyk7XG5cbmNvbnN0IHBvcHVwQWRkRm9ybSA9IHBvcHVwQWRkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuY29uc3QgcG9wdXBBZGRUaXRsZSA9IHBvcHVwQWRkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfdGl0bGUnKTtcbmNvbnN0IHBvcHVwQWRkTGluayA9IHBvcHVwQWRkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZmllbGRfbGluaycpO1xuXG5jb25zdCBjYXJkc0xpc3QgPSBib2R5LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fbGlzdCcpO1xuXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3NhdmUtYnRuXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX3NhdmUtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcbn07XG5cbmV4cG9ydCB7XG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlSW5mbyxcbiAgZWRpdEJ1dHRvbixcbiAgYWRkQnV0dG9uLFxuICBwb3B1cEVkaXQsXG4gIHBvcHVwQWRkLFxuICBwb3B1cENhcmQsXG4gIHBvcHVwRWRpdEZvcm0sXG4gIGZpZWxkTmFtZSxcbiAgZmllbGRBYm91dE1lLFxuICBwb3B1cEFkZEZvcm0sXG4gIGNhcmRzTGlzdCxcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcG9wdXBEZWxldGUsXG4gIHBob3RvQ29udGFpbmVyLFxuICBwb3B1cEVkaXRBdmF0YXIsXG4gIGVkaXRBdmF0YXJCdG4sXG4gIHBvcHVwRWRpdEF2YUZvcm0sXG4gIHBvcHVwQWRkVGl0bGUsXG4gIHBvcHVwQWRkTGluayxcbiAgcG9wdXBBdmF0YXJMaW5rXG59OyIsIlxuZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZWxlY3RvcnMsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2VsZWN0b3JzLmZvcm1TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2VsZWN0b3JzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2VsZWN0b3JzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2VsZWN0b3JzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JzLmlucHV0U2VsZWN0b3IpKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7IGV2dC5wcmV2ZW50RGVmYXVsdCgpIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfTtcbiAgfTtcblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfTtcbiAgfTtcblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9O1xuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfTtcbn1cbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNvbWVQb3B1cCkge1xuICAgIHRoaXMuX3BvcHVwID0gc29tZVBvcHVwO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9O1xuICB9XG5cbiAgX2hhbmRsZUNsaWNrQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9vcGVuZWQnKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnRuJykpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSk7XG4gIH1cbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHNvbWVQb3B1cCwgY2FsbEJhY2sgfSkge1xuICAgIHN1cGVyKHNvbWVQb3B1cCk7XG4gICAgdGhpcy5fY2FsbEJhY2sgPSBjYWxsQmFjaztcbiAgICB0aGlzLl9maWVsZHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgdGhpcy5fc2F2ZUJ0biA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZS1idG4nKTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uVGV4dCA9IHRoaXMuX3NhdmVCdG4udGV4dENvbnRlbnQ7XG4gIH1cbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZmllbGRzTGlzdCA9IHt9O1xuXG4gICAgdGhpcy5fZmllbGRzLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICBmaWVsZHNMaXN0W2ZpZWxkLm5hbWVdID0gZmllbGQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZmllbGRzTGlzdDtcbiAgfVxuXG5cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2NhbGxCYWNrKCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9ICdTYXZpbmcuLi4nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc2F2ZUJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zYXZlQnRuLnRleHRDb250ZW50ID0gdGhpcy5fc2F2ZUJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xuXG4gIGNvbnN0cnVjdG9yKHsgY2FyZERhdGEsIHVzZXJJZCwgY2FyZFRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUJpbkNsaWNrLCBoYW5kbGVMaWtlQ2xpY2sgfSkge1xuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBjYXJkVGVtcGxhdGU7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1nJyk7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idG4nKTtcbiAgICB0aGlzLl9saWtlc0Ftb3VudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2VzLWFtb3VudCcpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idG4nKTtcbiAgICB0aGlzLl9oYW5kbGVCaW5DbGljayA9IGhhbmRsZUJpbkNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgICB0aGlzLl9taW5lQ2FyZCA9IGNhcmREYXRhLmlzTWluZTtcbiAgICB0aGlzLl9teU5ld0NhcmQgPSBjYXJkRGF0YS5teU5ld0NhcmQ7XG4gICAgdGhpcy5fY2FyZExpa2VzID0gY2FyZERhdGEubGlrZXM7XG4gICAgdGhpcy5faW5pdGlhbExpa2VzID0gY2FyZERhdGEubGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkVGVtcGxhdGUpXG4gICAgICAuY29udGVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBjcmVhdGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9oYW5kbGVMaWtlSW5pdEFtb3VudCgpO1xuICAgIHRoaXMuX2FkZERlbGV0ZUJ1dHRvbigpO1xuICAgIHRoaXMuX2NoZWNrTGlrZXMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVMaWtlQ2xpY2spO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUJpbkNsaWNrKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcbiAgfVxuXG4gIF91cGRhdGVMaWtlcyhsaWtlcykge1xuICAgIHRoaXMuX2xpa2VzQW1vdW50LnRleHRDb250ZW50ID0gbGlrZXMubGVuZ3RoO1xuICAgIHRoaXMuX2NhcmRMaWtlcyA9IGxpa2VzO1xuICB9XG5cbiAgYWRkTGlrZShsaWtlcykge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idG5fYWN0aXZlJyk7XG4gICAgdGhpcy5fdXBkYXRlTGlrZXMobGlrZXMpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZShsaWtlcykge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idG5fYWN0aXZlJyk7XG4gICAgdGhpcy5fdXBkYXRlTGlrZXMobGlrZXMpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICBjb25zdCBpc015TGlrZSA9IHRoaXMuX2NhcmRMaWtlcy5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gICAgcmV0dXJuIGlzTXlMaWtlO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VJbml0QW1vdW50KCkge1xuICAgIHRoaXMuX2xpa2VzQW1vdW50LnRleHRDb250ZW50ID0gdGhpcy5faW5pdGlhbExpa2VzO1xuICB9XG5cbiAgX2FkZERlbGV0ZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5fbWluZUNhcmQgfHwgdGhpcy5fbXlOZXdDYXJkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fZGVsZXRlLWJ0bl9hY3RpdmUnKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVEZWxldGVCdXR0b24gPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIF9jaGVja0xpa2VzKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlcy5mb3JFYWNoKChsaWtlKSA9PiB7XG4gICAgICBpZiAobGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCkge1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xuICAgICAgfTtcbiAgICB9KVxuICB9XG59IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBoZWFkZXJMb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyLWxvZ29cIik7XG5oZWFkZXJMb2dvLnNyYyA9IGhlYWRlckxvZ29TcmM7XG5cbmltcG9ydCB7XG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlSW5mbyxcbiAgZWRpdEJ1dHRvbixcbiAgYWRkQnV0dG9uLFxuICBwb3B1cEVkaXQsXG4gIHBvcHVwQWRkLFxuICBwb3B1cENhcmQsXG4gIHBvcHVwRWRpdEZvcm0sXG4gIGZpZWxkTmFtZSxcbiAgZmllbGRBYm91dE1lLFxuICBwb3B1cEFkZEZvcm0sXG4gIGNhcmRzTGlzdCxcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcG9wdXBEZWxldGUsXG4gIHBob3RvQ29udGFpbmVyLFxuICBwb3B1cEVkaXRBdmF0YXIsXG4gIGVkaXRBdmF0YXJCdG4sXG4gIHBvcHVwRWRpdEF2YUZvcm0sXG59IGZyb20gJy4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzJztcblxuY29uc3QgdXNlckRhdGFGaWVsZHMgPSB7fTtcbnVzZXJEYXRhRmllbGRzLm5hbWUgPSBwcm9maWxlTmFtZTtcbnVzZXJEYXRhRmllbGRzLmluZm8gPSBwcm9maWxlSW5mbztcbnVzZXJEYXRhRmllbGRzLmF2YXRhciA9IHBob3RvQ29udGFpbmVyO1xudXNlckRhdGFGaWVsZHMucG9wdXBGaWVsZE5hbWUgPSBmaWVsZE5hbWU7XG51c2VyRGF0YUZpZWxkcy5wb3B1cEZpZWxkSW5mbyA9IGZpZWxkQWJvdXRNZTtcblxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlcy5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xuaW1wb3J0IHsgQ29uZmlybWF0aW9uUG9wdXAgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0NvbmZpcm1hdGlvblBvcHVwLmpzXCI7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIyZjkyZTZmOC1kM2JmLTRmMGItYjdjOS1lY2I4NDRhNjVkN2JcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9XG59KTtcblxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJyk7XG5cbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgfSk7XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xuXG5jb25zdCBwb3B1cENhcmRSZW5kZXJlciA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cENhcmQpO1xucG9wdXBDYXJkUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBEZWxldGVSZW5kZXJlciA9IG5ldyBDb25maXJtYXRpb25Qb3B1cChwb3B1cERlbGV0ZSk7XG5wb3B1cERlbGV0ZVJlbmRlcmVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8odXNlckRhdGFGaWVsZHMpO1xuXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSwgdXNlcklkKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XG4gICAgY2FyZERhdGE6IGl0ZW0sXG4gICAgdXNlcklkOiB1c2VySWQsXG4gICAgY2FyZFRlbXBsYXRlOiAnI2NhcmQtdGVtcGxhdGUnLFxuICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgcG9wdXBDYXJkUmVuZGVyZXIub3BlbihpdGVtKTtcbiAgICB9LFxuICAgIGhhbmRsZUJpbkNsaWNrOiAoKSA9PiB7XG5cblxuICAgICAgY29uc3Qgb25EZWxldGUgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBhcGkuZGVsZXRlKGl0ZW0uX2lkKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQnV0dG9uKCk7XG4gICAgICAgICAgICBwb3B1cERlbGV0ZVJlbmRlcmVyLmNsb3NlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHBvcHVwRGVsZXRlUmVuZGVyZXIub3BlbihvbkRlbGV0ZSk7XG5cbiAgICB9LFxuICAgIGhhbmRsZUxpa2VDbGljazogKCkgPT4ge1xuICAgICAgY29uc3QgaXNNeUxpa2UgPSBjYXJkLmlzTGlrZWQoKTtcbiAgICAgIGlmIChpc015TGlrZSkge1xuICAgICAgICBhcGkucmVtb3ZlTGlrZShpdGVtLl9pZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnJlbW92ZUxpa2UocmVzLmxpa2VzKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpLmFkZExpa2UoaXRlbS5faWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC5hZGRMaWtlKHJlcy5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gIH0pO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuY3JlYXRlQ2FyZCgpO1xuICByZXR1cm4gY2FyZEVsZW1lbnRcbn1cblxuY29uc3QgY2FyZFJlbmRlcmVyID0gbmV3IFNlY3Rpb24oe1xuICByZW5kZXJlcjogKGl0ZW0sIHVzZXJJZCkgPT4ge1xuICAgIGlmIChpdGVtLm15TmV3Q2FyZCkge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0sIHVzZXJJZCk7XG4gICAgICBjYXJkUmVuZGVyZXIuYWRkUHJlcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSwgdXNlcklkKTtcbiAgICAgIGNhcmRSZW5kZXJlci5hZGRBcHBlbmRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9XG4gIH1cbn0sIGNhcmRzTGlzdCk7XG5cblxuY29uc3QgcG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHNvbWVQb3B1cDogcG9wdXBFZGl0QXZhdGFyLFxuICBjYWxsQmFjazogKCkgPT4ge1xuICAgIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgY29uc3QgZmllbGRWYWx1ZSA9IHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLmdldElucHV0VmFsdWVzKCk7XG5cbiAgICBhcGkucGF0Y2hBdmF0YXIoZmllbGRWYWx1ZSlcbiAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXIpO1xuICAgICAgICBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9XG59KTtcbnBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuXG5jb25zdCBlZGl0UG9wdXBCZWhhdmlvciA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgc29tZVBvcHVwOiBwb3B1cEVkaXQsXG4gIGNhbGxCYWNrOiAoKSA9PiB7XG4gICAgZWRpdFBvcHVwQmVoYXZpb3IucmVuZGVyTG9hZGluZyh0cnVlKTtcblxuICAgIGNvbnN0IGVkaXRGaWVsZHMgPSBlZGl0UG9wdXBCZWhhdmlvci5nZXRJbnB1dFZhbHVlcygpO1xuXG4gICAgYXBpLnBhdGNoUHJvZmlsZURhdGEoZWRpdEZpZWxkcylcbiAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXIpO1xuICAgICAgICBlZGl0UG9wdXBCZWhhdmlvci5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICBlZGl0UG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuXG4gIH1cblxufSk7XG5lZGl0UG9wdXBCZWhhdmlvci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhZGRQb3B1cEJlaGF2aW9yID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBzb21lUG9wdXA6IHBvcHVwQWRkLFxuICBjYWxsQmFjazogKCkgPT4ge1xuICAgIGFkZFBvcHVwQmVoYXZpb3IucmVuZGVyTG9hZGluZyh0cnVlLCAnQ3JlYXRpbmcuLi4nKTtcblxuICAgIGNvbnN0IGFkZEZpZWxkcyA9IGFkZFBvcHVwQmVoYXZpb3IuZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICBjb25zdCBuZXdDYXJkID0ge307XG4gICAgbmV3Q2FyZC5uYW1lID0gYWRkRmllbGRzLnBsYWNlVGl0bGU7XG4gICAgbmV3Q2FyZC5saW5rID0gYWRkRmllbGRzLnBsYWNlTGluaztcblxuICAgIGFwaS5wb3N0TmV3Q2FyZERhdGEobmV3Q2FyZClcbiAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgIGNhcmQubXlOZXdDYXJkID0gdHJ1ZTtcblxuICAgICAgICBjYXJkUmVuZGVyZXIucmVuZGVyZXIoY2FyZCwgY2FyZC5vd25lci5faWQpO1xuICAgICAgICBhZGRQb3B1cEJlaGF2aW9yLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIGFkZFBvcHVwQmVoYXZpb3IucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgfVxufSk7XG5hZGRQb3B1cEJlaGF2aW9yLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbcG9wdXBBZGRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcblxuICBhZGRQb3B1cEJlaGF2aW9yLm9wZW4oKTtcbn0pO1xuXG5lZGl0QXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEVkaXRBdmFGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcblxuICBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlci5vcGVuKCk7XG59KTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbcG9wdXBFZGl0Rm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG5cbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICB1c2VyRGF0YUZpZWxkcy5wb3B1cEZpZWxkTmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIHVzZXJEYXRhRmllbGRzLnBvcHVwRmllbGRJbmZvLnZhbHVlID0gdXNlckRhdGEuYWJvdXQ7XG5cbiAgZWRpdFBvcHVwQmVoYXZpb3Iub3BlbigpO1xufSk7XG5cbmNvbnN0IGluaXRBcHAgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBhcGkuZ2V0TXlQcm9maWxlKCk7XG5cbiAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XG5cbiAgY29uc3QgY2FyZHMgPSBhd2FpdCBhcGkuZ2V0SW5pdGlhbENhcmRzKCk7XG5cbiAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgIGlmIChjYXJkLm93bmVyLl9pZCA9PT0gdXNlci5faWQpIHtcbiAgICAgIGNhcmQuaXNNaW5lID0gdHJ1ZTtcbiAgICB9XG4gICAgY2FyZFJlbmRlcmVyLnJlbmRlcmVyKGNhcmQsIHVzZXIuX2lkKVxuICB9KTtcbn07XG5cblxudHJ5IHtcbiAgaW5pdEFwcCgpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgY29uc29sZS5sb2coZXJyb3IpO1xufSIsImV4cG9ydCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihmZXRjaERhdGEpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gZmV0Y2hEYXRhLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGZldGNoRGF0YS5oZWFkZXJzO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0TXlQcm9maWxlKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGUoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcG9zdE5ld0NhcmREYXRhKGNhcmQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGNhcmQubmFtZSxcbiAgICAgICAgbGluazogY2FyZC5saW5rXG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBhdGNoUHJvZmlsZURhdGEoZWRpdEZpZWxkcykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGVkaXRGaWVsZHMucHJvZmlsZU5hbWUsXG4gICAgICAgIGFib3V0OiBlZGl0RmllbGRzLnByb2ZpbGVBYm91dFxuICAgICAgfSlcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBwYXRjaEF2YXRhcihmaWVsZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGZpZWxkLmF2YXRhckxpbmssXG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UoaXRlbUlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aXRlbUlkfWAsIHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkTGlrZShpdGVtSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpdGVtSWR9YCwge1xuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc29tZVBvcHVwKSB7XG4gICAgc3VwZXIoc29tZVBvcHVwKTtcbiAgICB0aGlzLl9wb3B1cENhcmRJbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FyZC1pbWcnKTtcbiAgICB0aGlzLl9wb3B1cENhcmRUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FyZC10aXRsZScpO1xuICB9XG5cbiAgb3BlbihpdGVtKSB7XG4gICAgdGhpcy5fcG9wdXBDYXJkSW1hZ2Uuc3JjID0gaXRlbS5saW5rO1xuICAgIHRoaXMuX3BvcHVwQ2FyZEltYWdlLmFsdCA9IGl0ZW0ubmFtZTtcbiAgICB0aGlzLl9wb3B1cENhcmRUaXRsZS50ZXh0Q29udGVudCA9IGl0ZW0ubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH07XG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgQ29uZmlybWF0aW9uUG9wdXAgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNvbWVQb3B1cCkge1xuICAgIHN1cGVyKHNvbWVQb3B1cCk7XG4gICAgdGhpcy5feWVzQnRuID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlLWJ0bicpO1xuICB9XG5cbiAgb3BlbihvbkRlbGV0ZSkge1xuICAgIHN1cGVyLm9wZW4oKVxuICAgIHRoaXMuX29uRGVsZXRlID0gb25EZWxldGU7XG4gICAgdGhpcy5feWVzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25EZWxldGUpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl95ZXNCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkRlbGV0ZSk7XG4gICAgdGhpcy5fb25EZWxldGUgPSBudWxsO1xuICB9XG59XG4iLCJcbmV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHVzZXJEYXRhRmllbGRzKSB7XG4gICAgdGhpcy5fZmllbGROYW1lID0gdXNlckRhdGFGaWVsZHMubmFtZTtcbiAgICB0aGlzLl9maWVsZEluZm8gPSB1c2VyRGF0YUZpZWxkcy5pbmZvO1xuICAgIHRoaXMuX3Bob3RvQ29udGFpbmVyID0gdXNlckRhdGFGaWVsZHMuYXZhdGFyO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdXNlckluZm9MaXN0ID0ge307XG4gICAgdXNlckluZm9MaXN0Lm5hbWUgPSB0aGlzLl9maWVsZE5hbWUudGV4dENvbnRlbnQ7XG4gICAgdXNlckluZm9MaXN0LmFib3V0ID0gdGhpcy5fZmllbGRJbmZvLnRleHRDb250ZW50O1xuICAgIHJldHVybiB1c2VySW5mb0xpc3Q7XG4gIH1cblxuICBzZXRVc2VySW5mbyh1c2VyKSB7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlci5faWQ7XG4gICAgdGhpcy5fcGhvdG9Db250YWluZXIuc3JjID0gdXNlci5hdmF0YXI7XG4gICAgdGhpcy5fZmllbGROYW1lLnRleHRDb250ZW50ID0gdXNlci5uYW1lO1xuICAgIHRoaXMuX2ZpZWxkSW5mby50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gIH1cbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIF9jbGVhcigpIHtcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgfVxuXG4gIGFkZFByZXBlbmRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxuXG4gIGFkZEFwcGVuZEl0ZW0oaXRlbSkge1xuXG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChpdGVtKTtcblxuICB9XG59OyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsInAiLCJib2R5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUluZm8iLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwicG9wdXBFZGl0IiwicG9wdXBBZGQiLCJwb3B1cERlbGV0ZSIsInBob3RvQ29udGFpbmVyIiwicG9wdXBFZGl0QXZhdGFyIiwicG9wdXBFZGl0QXZhRm9ybSIsImVkaXRBdmF0YXJCdG4iLCJwb3B1cENhcmQiLCJwb3B1cEVkaXRGb3JtIiwiZmllbGROYW1lIiwiZmllbGRBYm91dE1lIiwicG9wdXBBZGRGb3JtIiwiY2FyZHNMaXN0IiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwic2VsZWN0b3JzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZGlzYWJsZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJfaGFzSW52YWxpZElucHV0IiwicmVtb3ZlIiwicmVtb3ZlQXR0cmlidXRlIiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInNvbWVQb3B1cCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZUNsaWNrQ2xvc2UiLCJQb3B1cFdpdGhGb3JtIiwiY2FsbEJhY2siLCJzdXBlciIsIl9jYWxsQmFjayIsIl9maWVsZHMiLCJfcG9wdXBGb3JtIiwiX3NhdmVCdG4iLCJfc2F2ZUJ1dHRvblRleHQiLCJnZXRJbnB1dFZhbHVlcyIsImZpZWxkc0xpc3QiLCJmaWVsZCIsIm5hbWUiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsInJlc2V0IiwiQ2FyZCIsImNhcmREYXRhIiwidXNlcklkIiwiY2FyZFRlbXBsYXRlIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQmluQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfZWxlbWVudCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUNhcmRDbGljayIsIl9jYXJkVGVtcGxhdGUiLCJfZ2V0VGVtcGxhdGUiLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsIl9saWtlQnV0dG9uIiwiX2xpa2VzQW1vdW50IiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVCaW5DbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfbWluZUNhcmQiLCJpc01pbmUiLCJfbXlOZXdDYXJkIiwibXlOZXdDYXJkIiwiX2NhcmRMaWtlcyIsImxpa2VzIiwiX2luaXRpYWxMaWtlcyIsImxlbmd0aCIsIl91c2VySWQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY3JlYXRlQ2FyZCIsInNyYyIsImFsdCIsIl9oYW5kbGVMaWtlSW5pdEFtb3VudCIsIl9hZGREZWxldGVCdXR0b24iLCJfY2hlY2tMaWtlcyIsIl91cGRhdGVMaWtlcyIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiaXNMaWtlZCIsImxpa2UiLCJfaWQiLCJnZXRFbGVtZW50QnlJZCIsImhlYWRlckxvZ29TcmMiLCJ1c2VyRGF0YUZpZWxkcyIsImluZm8iLCJhdmF0YXIiLCJwb3B1cEZpZWxkTmFtZSIsInBvcHVwRmllbGRJbmZvIiwiYXBpIiwiZmV0Y2hEYXRhIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0TXlQcm9maWxlIiwiZGVsZXRlIiwiY2FyZElkIiwibWV0aG9kIiwicG9zdE5ld0NhcmREYXRhIiwiY2FyZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXRjaFByb2ZpbGVEYXRhIiwiZWRpdEZpZWxkcyIsImFib3V0IiwicHJvZmlsZUFib3V0IiwicGF0Y2hBdmF0YXIiLCJhdmF0YXJMaW5rIiwiaXRlbUlkIiwiYXV0aG9yaXphdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwiY29uZmlnIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJwb3B1cENhcmRSZW5kZXJlciIsIl9wb3B1cENhcmRJbWFnZSIsIl9wb3B1cENhcmRUaXRsZSIsIml0ZW0iLCJwb3B1cERlbGV0ZVJlbmRlcmVyIiwiX3llc0J0biIsIm9uRGVsZXRlIiwiX29uRGVsZXRlIiwidXNlckluZm8iLCJfZmllbGROYW1lIiwiX2ZpZWxkSW5mbyIsIl9waG90b0NvbnRhaW5lciIsImdldFVzZXJJbmZvIiwidXNlckluZm9MaXN0Iiwic2V0VXNlckluZm8iLCJ1c2VyIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiY2FyZFJlbmRlcmVyIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJfY29udGFpbmVyIiwiX2NsZWFyIiwiaW5uZXJIVE1MIiwiYWRkUHJlcGVuZEl0ZW0iLCJwcmVwZW5kIiwiYWRkQXBwZW5kSXRlbSIsImFwcGVuZCIsImNhcmRFbGVtZW50IiwicG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIiLCJmaWVsZFZhbHVlIiwiZmluYWxseSIsImVkaXRQb3B1cEJlaGF2aW9yIiwiYWRkUG9wdXBCZWhhdmlvciIsImFkZEZpZWxkcyIsIm5ld0NhcmQiLCJwbGFjZVRpdGxlIiwicGxhY2VMaW5rIiwib3duZXIiLCJ1c2VyRGF0YSIsImFzeW5jIiwiaW5pdEFwcCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==