!function(){"use strict";var e={937:function(e,t,s){e.exports=s.p+"4e8e0a1d604782a0dff8.svg"}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,s),r.exports}s.p="",function(){var e=s(937);const t=document.querySelector(".page"),i=t.querySelector(".profile"),n=i.querySelector(".profile__name"),r=i.querySelector(".profile__about-me"),o=i.querySelector(".profile__edit-btn"),a=i.querySelector(".profile__add-btn"),l=t.querySelector(".popup_edit"),c=t.querySelector(".popup_add"),d=t.querySelector(".popup_delete"),_=document.querySelector(".profile__photo"),h=document.querySelector(".popup_edit-photo"),p=h.querySelector(".popup__form"),u=document.querySelector(".profile__edit-avatar-btn"),m=document.querySelector(".popup_card"),k=(h.querySelector(".popup__input_field_link"),l.querySelector(".popup__form")),v=l.querySelector(".popup__input_field_name"),f=l.querySelector(".popup__input_field_about-me"),L=c.querySelector(".popup__form"),y=(c.querySelector(".popup__input_field_title"),c.querySelector(".popup__input_field_link"),t.querySelector(".cards__list"));class C{constructor(e,t){this._formSelector=e.formSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._buttonElement=this._formElement.querySelector(e.submitButtonSelector)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableButton():(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class b{constructor(e){E(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),E(this,"_handleClickClose",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close-btn")&&this.close()})),this._popup=e}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}setEventListeners(){this._popup.addEventListener("mousedown",this._handleClickClose)}}class g extends b{constructor(e){let{somePopup:t,callBack:s}=e;super(t),this._callBack=s,this._fields=this._popup.querySelectorAll(".popup__input"),this._popupForm=this._popup.querySelector(".popup__form"),this._saveBtn=this._popup.querySelector(".popup__save-btn"),this._saveButtonText=this._saveBtn.textContent}getInputValues(){const e={};return this._fields.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._callBack()})),super.setEventListeners()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._saveBtn.textContent=e?t:this._saveButtonText}close(){super.close(),this._popupForm.reset()}}class S{constructor(e){let{cardData:t,userId:s,cardTemplate:i,handleCardClick:n,handleBinClick:r,handleLikeClick:o}=e;var a,l;l=()=>{this._element.remove()},(a="handleDeleteButton")in this?Object.defineProperty(this,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):this[a]=l,this._name=t.name,this._link=t.link,this._handleCardClick=n,this._cardTemplate=i,this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__img"),this._cardTitle=this._element.querySelector(".card__title"),this._likeButton=this._element.querySelector(".card__like-btn"),this._likesAmount=this._element.querySelector(".card__likes-amount"),this._deleteButton=this._element.querySelector(".card__delete-btn"),this._handleBinClick=r,this._handleLikeClick=o,this._mineCard=t.isMine,this._myNewCard=t.myNewCard,this._cardLikes=t.likes,this._initialLikes=t.likes.length,this._userId=s}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".card").cloneNode(!0)}createCard(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._handleLikeInitAmount(),this._addDeleteButton(),this._checkLikes(),this._element}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeClick),this._deleteButton.addEventListener("click",this._handleBinClick),this._cardImage.addEventListener("mousedown",this._handleCardClick)}_updateLikes(e){this._likesAmount.textContent=e.length,this._cardLikes=e}addLike(e){this._likeButton.classList.add("card__like-btn_active"),this._updateLikes(e)}removeLike(e){this._likeButton.classList.remove("card__like-btn_active"),this._updateLikes(e)}isLiked(){return this._cardLikes.some((e=>e._id===this._userId))}_handleLikeInitAmount(){this._likesAmount.textContent=this._initialLikes}_addDeleteButton(){(this._mineCard||this._myNewCard)&&this._deleteButton.classList.add("card__delete-btn_active")}_checkLikes(){this._cardLikes.forEach((e=>{e._id===this._userId&&this._likeButton.classList.add("card__like-btn_active")}))}}document.getElementById("header-logo").src=e;const I={};I.name=n,I.info=r,I.avatar=_,I.popupFieldName=v,I.popupFieldInfo=f;const B=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}getMyProfile(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}delete(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}postNewCardData(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}patchProfileData(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.profileName,about:e.profileAbout})}).then(this._checkResponse)}patchAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatarLink})}).then(this._checkResponse)}removeLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"2f92e6f8-d3bf-4f0b-b7c9-ecb844a65d7b","Content-Type":"application/json"}}),q={};var w;w={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-btn",inactiveButtonClass:"popup__save-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(w.formSelector)).forEach((e=>{const t=new C(w,e),s=e.getAttribute("name");q[s]=t,t.enableValidation()}));const A=new class extends b{constructor(e){super(e),this._popupCardImage=this._popup.querySelector(".popup__card-img"),this._popupCardTitle=this._popup.querySelector(".popup__card-title")}open(e){this._popupCardImage.src=e.link,this._popupCardImage.alt=e.name,this._popupCardTitle.textContent=e.name,super.open()}}(m);A.setEventListeners();const x=new class extends b{constructor(e){super(e),this._yesBtn=this._popup.querySelector(".popup__save-btn")}close(){super.close(),this._onDelete&&(this.removeEventListeners(this._onDelete),this._onDelete=null)}setEventListeners(e){this._onDelete=e,this._onDelete&&this._yesBtn.addEventListener("click",this._onDelete),super.setEventListeners()}removeEventListeners(){this._yesBtn.removeEventListener("click",this._onDelete)}}(d);x.setEventListeners();const D=new class{constructor(e){this._fieldName=e.name,this._fieldInfo=e.info,this._photoContainer=e.avatar}getUserInfo(){const e={};return e.name=this._fieldName.textContent,e.about=this._fieldInfo.textContent,e}setUserInfo(e){this._userId=e._id,this._photoContainer.src=e.avatar,this._fieldName.textContent=e.name,this._fieldInfo.textContent=e.about}}(I);function T(e,t){const s=new S({cardData:e,userId:t,cardTemplate:"#card-template",handleCardClick:()=>{A.open(e)},handleBinClick:()=>{x.open(),x.setEventListeners((()=>B.delete(e._id).then((()=>{s.handleDeleteButton(),x.close(),x.removeEventListeners()})).catch((e=>{console.log(e)}))))},handleLikeClick:()=>{s.isLiked()?B.removeLike(e._id).then((e=>{s.removeLike(e.likes)})).catch((e=>{console.log(e)})):B.addLike(e._id).then((e=>{s.addLike(e.likes)})).catch((e=>{console.log(e)}))}});return s.createCard()}const U=new class{constructor(e,t){let{renderer:s}=e;this.renderer=s,this._container=t}_clear(){this._container.innerHTML=""}addPrependItem(e){this._container.prepend(e)}addAppendItem(e){this._container.append(e)}}({renderer:(e,t)=>{if(e.myNewCard){const s=T(e,t);U.addPrependItem(s)}else{const s=T(e,t);U.addAppendItem(s)}}},y),N=new g({somePopup:h,callBack:()=>{N.renderLoading(!0);const e=N.getInputValues();B.patchAvatar(e).then((e=>{D.setUserInfo(e),N.close()})).catch((e=>{console.log(e)})).finally((function(){N.renderLoading(!1)}))}});N.setEventListeners();const P=new g({somePopup:l,callBack:()=>{P.renderLoading(!0);const e=P.getInputValues();B.patchProfileData(e).then((e=>{D.setUserInfo(e),P.close()})).catch((e=>{console.log(e)})).finally((function(){P.renderLoading(!1)}))}});P.setEventListeners();const V=new g({somePopup:c,callBack:()=>{V.renderLoading(!0,"Creating...");const e=V.getInputValues(),t={};t.name=e.placeTitle,t.link=e.placeLink,B.postNewCardData(t).then((e=>{e.myNewCard=!0,U.renderer(e,e.owner._id),V.close()})).catch((e=>{console.log(e)})).finally((function(){V.renderLoading(!1)}))}});V.setEventListeners(),a.addEventListener("click",(()=>{q[L.getAttribute("name")].resetValidation(),V.open()})),u.addEventListener("click",(()=>{q[p.getAttribute("name")].resetValidation(),N.open()})),o.addEventListener("click",(()=>{q[k.getAttribute("name")].resetValidation();const e=D.getUserInfo();I.popupFieldName.value=e.name,I.popupFieldInfo.value=e.about,P.open()})),(async()=>{const e=await B.getMyProfile();D.setUserInfo(e),(await B.getInitialCards()).forEach((t=>{t.owner._id===e._id&&(t.isMine=!0),U.renderer(t,e._id)}))})()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxFQUFpQnRJLGlCQUM3QndJLEVBQVUsR0FDaEJBLEVBQVFySSxLQUFPb0ksRUFBVUUsV0FDekJELEVBQVFySCxLQUFPb0gsRUFBVUcsVUFFekI5RSxFQUFJb0IsZ0JBQWdCd0QsR0FDakI3RCxNQUFNTSxJQUNMQSxFQUFLaEQsV0FBWSxFQUVqQnNGLEVBQWFFLFNBQVN4QyxFQUFNQSxFQUFLMEQsTUFBTXZGLEtBQ3ZDa0YsRUFBaUJ2SixXQUVsQm9JLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE1BRWJnQixTQUFRLFdBQ1BFLEVBQWlCakksZUFBYyxTQUl2Q2lJLEVBQWlCaEosb0JBRWpCMUUsRUFBVW9DLGlCQUFpQixTQUFTLEtBQ2xDNEksRUFBZXBLLEVBQWF3SyxhQUFhLFNBQVNySCxrQkFFbEQySixFQUFpQm5KLFVBR25CaEUsRUFBYzZCLGlCQUFpQixTQUFTLEtBQ3RDNEksRUFBZTFLLEVBQWlCOEssYUFBYSxTQUFTckgsa0JBRXREdUosRUFBd0IvSSxVQUcxQnhFLEVBQVdxQyxpQkFBaUIsU0FBUyxLQUNuQzRJLEVBQWV2SyxFQUFjMkssYUFBYSxTQUFTckgsa0JBRW5ELE1BQU1pSyxFQUFXbEMsRUFBU0ksY0FDMUJ2RCxFQUFlRyxlQUFldEQsTUFBUXdJLEVBQVN6SSxLQUMvQ29ELEVBQWVJLGVBQWV2RCxNQUFRd0ksRUFBU3RELE1BRS9DK0MsRUFBa0JsSixVQUdKMEosV0FDZCxNQUFNNUIsUUFBYXJELEVBQUlnQixlQUV2QjhCLEVBQVNNLFlBQVlDLFVBRURyRCxFQUFJYSxtQkFFbEJwSCxTQUFTNEgsSUFDVEEsRUFBSzBELE1BQU12RixNQUFRNkQsRUFBSzdELE1BQzFCNkIsRUFBS2xELFFBQVMsR0FFaEJ3RixFQUFhRSxTQUFTeEMsRUFBTWdDLEVBQUs3RCxTQUtyQzBGLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZXMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ29uZmlybWF0aW9uUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2UnKTtcblxuY29uc3QgcHJvZmlsZSA9IGJvZHkucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xuY29uc3QgcHJvZmlsZUluZm8gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hYm91dC1tZScpO1xuY29uc3QgZWRpdEJ1dHRvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnRuJyk7XG5jb25zdCBhZGRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnRuJyk7XG5cbmNvbnN0IHBvcHVwRWRpdCA9IGJvZHkucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQnKTtcbmNvbnN0IHBvcHVwQWRkID0gYm9keS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfYWRkJyk7XG5jb25zdCBwb3B1cERlbGV0ZSA9IGJvZHkucXVlcnlTZWxlY3RvcignLnBvcHVwX2RlbGV0ZScpO1xuXG5jb25zdCBwaG90b0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19waG90bycpO1xuY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQtcGhvdG8nKTtcbmNvbnN0IHBvcHVwRWRpdEF2YUZvcm0gPSBwb3B1cEVkaXRBdmF0YXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG5jb25zdCBlZGl0QXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYXZhdGFyLWJ0bicpO1xuXG5jb25zdCBwb3B1cENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfY2FyZCcpO1xuXG5jb25zdCBwb3B1cEF2YXRhckxpbmsgPSBwb3B1cEVkaXRBdmF0YXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF9saW5rJyk7XG5cbmNvbnN0IHBvcHVwRWRpdEZvcm0gPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG5jb25zdCBmaWVsZE5hbWUgPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF9uYW1lJyk7XG5jb25zdCBmaWVsZEFib3V0TWUgPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9maWVsZF9hYm91dC1tZScpO1xuXG5jb25zdCBwb3B1cEFkZEZvcm0gPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbmNvbnN0IHBvcHVwQWRkVGl0bGUgPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2ZpZWxkX3RpdGxlJyk7XG5jb25zdCBwb3B1cEFkZExpbmsgPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2ZpZWxkX2xpbmsnKTtcblxuY29uc3QgY2FyZHNMaXN0ID0gYm9keS5xdWVyeVNlbGVjdG9yKCcuY2FyZHNfX2xpc3QnKTtcblxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlLWJ0bl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXG59O1xuXG5leHBvcnQge1xuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZUluZm8sXG4gIGVkaXRCdXR0b24sXG4gIGFkZEJ1dHRvbixcbiAgcG9wdXBFZGl0LFxuICBwb3B1cEFkZCxcbiAgcG9wdXBDYXJkLFxuICBwb3B1cEVkaXRGb3JtLFxuICBmaWVsZE5hbWUsXG4gIGZpZWxkQWJvdXRNZSxcbiAgcG9wdXBBZGRGb3JtLFxuICBjYXJkc0xpc3QsXG4gIHZhbGlkYXRpb25Db25maWcsXG4gIHBvcHVwRGVsZXRlLFxuICBwaG90b0NvbnRhaW5lcixcbiAgcG9wdXBFZGl0QXZhdGFyLFxuICBlZGl0QXZhdGFyQnRuLFxuICBwb3B1cEVkaXRBdmFGb3JtLFxuICBwb3B1cEFkZFRpdGxlLFxuICBwb3B1cEFkZExpbmssXG4gIHBvcHVwQXZhdGFyTGlua1xufTsiLCJcbmV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3JzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNlbGVjdG9ycy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNlbGVjdG9ycy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNlbGVjdG9ycy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNlbGVjdG9ycy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yKSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4geyBldnQucHJldmVudERlZmF1bHQoKSB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIGJ1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH07XG4gIH07XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH07XG4gIH07XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfTtcblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH07XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihzb21lUG9wdXApIHtcbiAgICB0aGlzLl9wb3B1cCA9IHNvbWVQb3B1cDtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgfVxuXG4gIF9oYW5kbGVDbGlja0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9O1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ0bicpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UpO1xuICB9XG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBzb21lUG9wdXAsIGNhbGxCYWNrIH0pIHtcbiAgICBzdXBlcihzb21lUG9wdXApO1xuICAgIHRoaXMuX2NhbGxCYWNrID0gY2FsbEJhY2s7XG4gICAgdGhpcy5fZmllbGRzID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgIHRoaXMuX3NhdmVCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9zYXZlQnRuLnRleHRDb250ZW50O1xuICB9XG4gIGdldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZpZWxkc0xpc3QgPSB7fTtcblxuICAgIHRoaXMuX2ZpZWxkcy5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgICAgZmllbGRzTGlzdFtmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGZpZWxkc0xpc3Q7XG4gIH1cblxuXG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9jYWxsQmFjaygpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSAnU2F2aW5nLi4uJykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3NhdmVCdG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2F2ZUJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcblxuICBjb25zdHJ1Y3Rvcih7IGNhcmREYXRhLCB1c2VySWQsIGNhcmRUZW1wbGF0ZSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVCaW5DbGljaywgaGFuZGxlTGlrZUNsaWNrIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltZycpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnRuJyk7XG4gICAgdGhpcy5fbGlrZXNBbW91bnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlcy1hbW91bnQnKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnRuJyk7XG4gICAgdGhpcy5faGFuZGxlQmluQ2xpY2sgPSBoYW5kbGVCaW5DbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gICAgdGhpcy5fbWluZUNhcmQgPSBjYXJkRGF0YS5pc01pbmU7XG4gICAgdGhpcy5fbXlOZXdDYXJkID0gY2FyZERhdGEubXlOZXdDYXJkO1xuICAgIHRoaXMuX2NhcmRMaWtlcyA9IGNhcmREYXRhLmxpa2VzO1xuICAgIHRoaXMuX2luaXRpYWxMaWtlcyA9IGNhcmREYXRhLmxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFRlbXBsYXRlKVxuICAgICAgLmNvbnRlbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5faGFuZGxlTGlrZUluaXRBbW91bnQoKTtcbiAgICB0aGlzLl9hZGREZWxldGVCdXR0b24oKTtcbiAgICB0aGlzLl9jaGVja0xpa2VzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlTGlrZUNsaWNrKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVCaW5DbGljayk7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XG4gIH1cblxuICBfdXBkYXRlTGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlc0Ftb3VudC50ZXh0Q29udGVudCA9IGxpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSBsaWtlcztcbiAgfVxuXG4gIGFkZExpa2UobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xuICAgIHRoaXMuX3VwZGF0ZUxpa2VzKGxpa2VzKTtcbiAgfVxuXG4gIHJlbW92ZUxpa2UobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xuICAgIHRoaXMuX3VwZGF0ZUxpa2VzKGxpa2VzKTtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgY29uc3QgaXNNeUxpa2UgPSB0aGlzLl9jYXJkTGlrZXMuc29tZShsaWtlID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICAgIHJldHVybiBpc015TGlrZTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlSW5pdEFtb3VudCgpIHtcbiAgICB0aGlzLl9saWtlc0Ftb3VudC50ZXh0Q29udGVudCA9IHRoaXMuX2luaXRpYWxMaWtlcztcbiAgfVxuXG4gIF9hZGREZWxldGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX21pbmVDYXJkIHx8IHRoaXMuX215TmV3Q2FyZCkge1xuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2RlbGV0ZS1idG5fYWN0aXZlJyk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlRGVsZXRlQnV0dG9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBfY2hlY2tMaWtlcygpIHtcbiAgICB0aGlzLl9jYXJkTGlrZXMuZm9yRWFjaCgobGlrZSkgPT4ge1xuICAgICAgaWYgKGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpIHtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcbiAgICAgIH07XG4gICAgfSlcbiAgfVxufSIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgaGVhZGVyTG9nb1NyYyBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XG5cbmNvbnN0IGhlYWRlckxvZ28gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlYWRlci1sb2dvXCIpO1xuaGVhZGVyTG9nby5zcmMgPSBoZWFkZXJMb2dvU3JjO1xuXG5pbXBvcnQge1xuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZUluZm8sXG4gIGVkaXRCdXR0b24sXG4gIGFkZEJ1dHRvbixcbiAgcG9wdXBFZGl0LFxuICBwb3B1cEFkZCxcbiAgcG9wdXBDYXJkLFxuICBwb3B1cEVkaXRGb3JtLFxuICBmaWVsZE5hbWUsXG4gIGZpZWxkQWJvdXRNZSxcbiAgcG9wdXBBZGRGb3JtLFxuICBjYXJkc0xpc3QsXG4gIHZhbGlkYXRpb25Db25maWcsXG4gIHBvcHVwRGVsZXRlLFxuICBwaG90b0NvbnRhaW5lcixcbiAgcG9wdXBFZGl0QXZhdGFyLFxuICBlZGl0QXZhdGFyQnRuLFxuICBwb3B1cEVkaXRBdmFGb3JtLFxufSBmcm9tICcuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyc7XG5cbmNvbnN0IHVzZXJEYXRhRmllbGRzID0ge307XG51c2VyRGF0YUZpZWxkcy5uYW1lID0gcHJvZmlsZU5hbWU7XG51c2VyRGF0YUZpZWxkcy5pbmZvID0gcHJvZmlsZUluZm87XG51c2VyRGF0YUZpZWxkcy5hdmF0YXIgPSBwaG90b0NvbnRhaW5lcjtcbnVzZXJEYXRhRmllbGRzLnBvcHVwRmllbGROYW1lID0gZmllbGROYW1lO1xudXNlckRhdGFGaWVsZHMucG9wdXBGaWVsZEluZm8gPSBmaWVsZEFib3V0TWU7XG5cbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZXMuanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCB7IENvbmZpcm1hdGlvblBvcHVwIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Db25maXJtYXRpb25Qb3B1cC5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tICcuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzJztcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMmY5MmU2ZjgtZDNiZi00ZjBiLWI3YzktZWNiODQ0YTY1ZDdiXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfVxufSk7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpO1xuXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufTtcblxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcblxuY29uc3QgcG9wdXBDYXJkUmVuZGVyZXIgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBDYXJkKTtcbnBvcHVwQ2FyZFJlbmRlcmVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwRGVsZXRlUmVuZGVyZXIgPSBuZXcgQ29uZmlybWF0aW9uUG9wdXAocG9wdXBEZWxldGUpO1xucG9wdXBEZWxldGVSZW5kZXJlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHVzZXJEYXRhRmllbGRzKTtcblxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0sIHVzZXJJZCkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgIGNhcmREYXRhOiBpdGVtLFxuICAgIHVzZXJJZDogdXNlcklkLFxuICAgIGNhcmRUZW1wbGF0ZTogJyNjYXJkLXRlbXBsYXRlJyxcbiAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcbiAgICAgIHBvcHVwQ2FyZFJlbmRlcmVyLm9wZW4oaXRlbSk7XG4gICAgfSxcbiAgICBoYW5kbGVCaW5DbGljazogKCkgPT4ge1xuICAgICAgcG9wdXBEZWxldGVSZW5kZXJlci5vcGVuKCk7XG5cbiAgICAgIGNvbnN0IG9uRGVsZXRlID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gYXBpLmRlbGV0ZShpdGVtLl9pZClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmhhbmRsZURlbGV0ZUJ1dHRvbigpO1xuICAgICAgICAgICAgcG9wdXBEZWxldGVSZW5kZXJlci5jbG9zZSgpO1xuICAgICAgICAgICAgcG9wdXBEZWxldGVSZW5kZXJlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHBvcHVwRGVsZXRlUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMob25EZWxldGUpO1xuICAgIH0sXG4gICAgaGFuZGxlTGlrZUNsaWNrOiAoKSA9PiB7XG4gICAgICBjb25zdCBpc015TGlrZSA9IGNhcmQuaXNMaWtlZCgpO1xuICAgICAgaWYgKGlzTXlMaWtlKSB7XG4gICAgICAgIGFwaS5yZW1vdmVMaWtlKGl0ZW0uX2lkKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlTGlrZShyZXMubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGkuYWRkTGlrZShpdGVtLl9pZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmFkZExpa2UocmVzLmxpa2VzKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgfSk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5jcmVhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudFxufVxuXG5jb25zdCBjYXJkUmVuZGVyZXIgPSBuZXcgU2VjdGlvbih7XG4gIHJlbmRlcmVyOiAoaXRlbSwgdXNlcklkKSA9PiB7XG4gICAgaWYgKGl0ZW0ubXlOZXdDYXJkKSB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSwgdXNlcklkKTtcbiAgICAgIGNhcmRSZW5kZXJlci5hZGRQcmVwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtLCB1c2VySWQpO1xuICAgICAgY2FyZFJlbmRlcmVyLmFkZEFwcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgIH1cbiAgfVxufSwgY2FyZHNMaXN0KTtcblxuXG5jb25zdCBwb3B1cEVkaXRBdmF0YXJSZW5kZXJlciA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgc29tZVBvcHVwOiBwb3B1cEVkaXRBdmF0YXIsXG4gIGNhbGxCYWNrOiAoKSA9PiB7XG4gICAgcG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBjb25zdCBmaWVsZFZhbHVlID0gcG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIuZ2V0SW5wdXRWYWx1ZXMoKTtcblxuICAgIGFwaS5wYXRjaEF2YXRhcihmaWVsZFZhbHVlKVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XG4gICAgICAgIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG4gIH1cbn0pO1xucG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuXG5cbmNvbnN0IGVkaXRQb3B1cEJlaGF2aW9yID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBzb21lUG9wdXA6IHBvcHVwRWRpdCxcbiAgY2FsbEJhY2s6ICgpID0+IHtcbiAgICBlZGl0UG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKHRydWUpO1xuXG4gICAgY29uc3QgZWRpdEZpZWxkcyA9IGVkaXRQb3B1cEJlaGF2aW9yLmdldElucHV0VmFsdWVzKCk7XG5cbiAgICBhcGkucGF0Y2hQcm9maWxlRGF0YShlZGl0RmllbGRzKVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XG4gICAgICAgIGVkaXRQb3B1cEJlaGF2aW9yLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVkaXRQb3B1cEJlaGF2aW9yLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG5cbiAgfVxuXG59KTtcbmVkaXRQb3B1cEJlaGF2aW9yLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZFBvcHVwQmVoYXZpb3IgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHNvbWVQb3B1cDogcG9wdXBBZGQsXG4gIGNhbGxCYWNrOiAoKSA9PiB7XG4gICAgYWRkUG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKHRydWUsICdDcmVhdGluZy4uLicpO1xuXG4gICAgY29uc3QgYWRkRmllbGRzID0gYWRkUG9wdXBCZWhhdmlvci5nZXRJbnB1dFZhbHVlcygpO1xuICAgIGNvbnN0IG5ld0NhcmQgPSB7fTtcbiAgICBuZXdDYXJkLm5hbWUgPSBhZGRGaWVsZHMucGxhY2VUaXRsZTtcbiAgICBuZXdDYXJkLmxpbmsgPSBhZGRGaWVsZHMucGxhY2VMaW5rO1xuXG4gICAgYXBpLnBvc3ROZXdDYXJkRGF0YShuZXdDYXJkKVxuICAgICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgY2FyZC5teU5ld0NhcmQgPSB0cnVlO1xuXG4gICAgICAgIGNhcmRSZW5kZXJlci5yZW5kZXJlcihjYXJkLCBjYXJkLm93bmVyLl9pZCk7XG4gICAgICAgIGFkZFBvcHVwQmVoYXZpb3IuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYWRkUG9wdXBCZWhhdmlvci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9XG59KTtcbmFkZFBvcHVwQmVoYXZpb3Iuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEFkZEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIGFkZFBvcHVwQmVoYXZpb3Iub3BlbigpO1xufSk7XG5cbmVkaXRBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzW3BvcHVwRWRpdEF2YUZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gIHBvcHVwRWRpdEF2YXRhclJlbmRlcmVyLm9wZW4oKTtcbn0pO1xuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1twb3B1cEVkaXRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcblxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHVzZXJEYXRhRmllbGRzLnBvcHVwRmllbGROYW1lLnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgdXNlckRhdGFGaWVsZHMucG9wdXBGaWVsZEluZm8udmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcblxuICBlZGl0UG9wdXBCZWhhdmlvci5vcGVuKCk7XG59KTtcblxuY29uc3QgaW5pdEFwcCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGFwaS5nZXRNeVByb2ZpbGUoKTtcblxuICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcblxuICBjb25zdCBjYXJkcyA9IGF3YWl0IGFwaS5nZXRJbml0aWFsQ2FyZHMoKTtcblxuICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgaWYgKGNhcmQub3duZXIuX2lkID09PSB1c2VyLl9pZCkge1xuICAgICAgY2FyZC5pc01pbmUgPSB0cnVlO1xuICAgIH1cbiAgICBjYXJkUmVuZGVyZXIucmVuZGVyZXIoY2FyZCwgdXNlci5faWQpXG4gIH0pO1xufTtcblxuXG5pbml0QXBwKCk7IiwiZXhwb3J0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGZldGNoRGF0YSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBmZXRjaERhdGEuYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gZmV0Y2hEYXRhLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRNeVByb2ZpbGUoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBwb3N0TmV3Q2FyZERhdGEoY2FyZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxuICAgICAgICBsaW5rOiBjYXJkLmxpbmtcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcGF0Y2hQcm9maWxlRGF0YShlZGl0RmllbGRzKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZWRpdEZpZWxkcy5wcm9maWxlTmFtZSxcbiAgICAgICAgYWJvdXQ6IGVkaXRGaWVsZHMucHJvZmlsZUFib3V0XG4gICAgICB9KVxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBhdGNoQXZhdGFyKGZpZWxkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogZmllbGQuYXZhdGFyTGluayxcbiAgICAgIH0pXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlTGlrZShpdGVtSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpdGVtSWR9YCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRMaWtlKGl0ZW1JZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2l0ZW1JZH1gLCB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihzb21lUG9wdXApIHtcbiAgICBzdXBlcihzb21lUG9wdXApO1xuICAgIHRoaXMuX3BvcHVwQ2FyZEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXJkLWltZycpO1xuICAgIHRoaXMuX3BvcHVwQ2FyZFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXJkLXRpdGxlJyk7XG4gIH1cblxuICBvcGVuKGl0ZW0pIHtcbiAgICB0aGlzLl9wb3B1cENhcmRJbWFnZS5zcmMgPSBpdGVtLmxpbms7XG4gICAgdGhpcy5fcG9wdXBDYXJkSW1hZ2UuYWx0ID0gaXRlbS5uYW1lO1xuICAgIHRoaXMuX3BvcHVwQ2FyZFRpdGxlLnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfTtcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBDb25maXJtYXRpb25Qb3B1cCBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc29tZVBvcHVwKSB7XG4gICAgc3VwZXIoc29tZVBvcHVwKTtcbiAgICB0aGlzLl95ZXNCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUtYnRuJyk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICBpZiAodGhpcy5fb25EZWxldGUpIHtcbiAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnModGhpcy5fb25EZWxldGUpO1xuICAgICAgdGhpcy5fb25EZWxldGUgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKG9uRGVsZXRlKSB7XG4gICAgdGhpcy5fb25EZWxldGUgPSBvbkRlbGV0ZTtcbiAgICBpZiAodGhpcy5fb25EZWxldGUpIHtcbiAgICAgIHRoaXMuX3llc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uRGVsZXRlKTtcbiAgICB9XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuICB9XG5cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5feWVzQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25EZWxldGUpO1xuICB9XG59IiwiXG5leHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih1c2VyRGF0YUZpZWxkcykge1xuICAgIHRoaXMuX2ZpZWxkTmFtZSA9IHVzZXJEYXRhRmllbGRzLm5hbWU7XG4gICAgdGhpcy5fZmllbGRJbmZvID0gdXNlckRhdGFGaWVsZHMuaW5mbztcbiAgICB0aGlzLl9waG90b0NvbnRhaW5lciA9IHVzZXJEYXRhRmllbGRzLmF2YXRhcjtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJJbmZvTGlzdCA9IHt9O1xuICAgIHVzZXJJbmZvTGlzdC5uYW1lID0gdGhpcy5fZmllbGROYW1lLnRleHRDb250ZW50O1xuICAgIHVzZXJJbmZvTGlzdC5hYm91dCA9IHRoaXMuX2ZpZWxkSW5mby50ZXh0Q29udGVudDtcbiAgICByZXR1cm4gdXNlckluZm9MaXN0O1xuICB9XG5cbiAgc2V0VXNlckluZm8odXNlcikge1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXIuX2lkO1xuICAgIHRoaXMuX3Bob3RvQ29udGFpbmVyLnNyYyA9IHVzZXIuYXZhdGFyO1xuICAgIHRoaXMuX2ZpZWxkTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICB0aGlzLl9maWVsZEluZm8udGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xuICB9XG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7XG4gIH1cblxuICBfY2xlYXIoKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XG4gIH1cblxuICBhZGRQcmVwZW5kSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gIH1cblxuICBhZGRBcHBlbmRJdGVtKGl0ZW0pIHtcblxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XG5cbiAgfVxufTsiXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJwIiwiYm9keSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByb2ZpbGUiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVJbmZvIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsInBvcHVwRWRpdCIsInBvcHVwQWRkIiwicG9wdXBEZWxldGUiLCJwaG90b0NvbnRhaW5lciIsInBvcHVwRWRpdEF2YXRhciIsInBvcHVwRWRpdEF2YUZvcm0iLCJlZGl0QXZhdGFyQnRuIiwicG9wdXBDYXJkIiwicG9wdXBFZGl0Rm9ybSIsImZpZWxkTmFtZSIsImZpZWxkQWJvdXRNZSIsInBvcHVwQWRkRm9ybSIsImNhcmRzTGlzdCIsIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNlbGVjdG9ycyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVuYWJsZVZhbGlkYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImRpc2FibGVCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiX2hhc0ludmFsaWRJbnB1dCIsInJlbW92ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJzb21lUG9wdXAiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVDbGlja0Nsb3NlIiwiUG9wdXBXaXRoRm9ybSIsImNhbGxCYWNrIiwic3VwZXIiLCJfY2FsbEJhY2siLCJfZmllbGRzIiwiX3BvcHVwRm9ybSIsIl9zYXZlQnRuIiwiX3NhdmVCdXR0b25UZXh0IiwiZ2V0SW5wdXRWYWx1ZXMiLCJmaWVsZHNMaXN0IiwiZmllbGQiLCJuYW1lIiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJyZXNldCIsIkNhcmQiLCJjYXJkRGF0YSIsInVzZXJJZCIsImNhcmRUZW1wbGF0ZSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUJpbkNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiX2VsZW1lbnQiLCJfbmFtZSIsIl9saW5rIiwibGluayIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfY2FyZFRlbXBsYXRlIiwiX2dldFRlbXBsYXRlIiwiX2NhcmRJbWFnZSIsIl9jYXJkVGl0bGUiLCJfbGlrZUJ1dHRvbiIsIl9saWtlc0Ftb3VudCIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlQmluQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX21pbmVDYXJkIiwiaXNNaW5lIiwiX215TmV3Q2FyZCIsIm15TmV3Q2FyZCIsIl9jYXJkTGlrZXMiLCJsaWtlcyIsIl9pbml0aWFsTGlrZXMiLCJsZW5ndGgiLCJfdXNlcklkIiwiY29udGVudCIsImNsb25lTm9kZSIsImNyZWF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJfaGFuZGxlTGlrZUluaXRBbW91bnQiLCJfYWRkRGVsZXRlQnV0dG9uIiwiX2NoZWNrTGlrZXMiLCJfdXBkYXRlTGlrZXMiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImlzTGlrZWQiLCJsaWtlIiwiX2lkIiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWFkZXJMb2dvU3JjIiwidXNlckRhdGFGaWVsZHMiLCJpbmZvIiwiYXZhdGFyIiwicG9wdXBGaWVsZE5hbWUiLCJwb3B1cEZpZWxkSW5mbyIsImFwaSIsImZldGNoRGF0YSIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImdldE15UHJvZmlsZSIsImRlbGV0ZSIsImNhcmRJZCIsIm1ldGhvZCIsInBvc3ROZXdDYXJkRGF0YSIsImNhcmQiLCJKU09OIiwic3RyaW5naWZ5IiwicGF0Y2hQcm9maWxlRGF0YSIsImVkaXRGaWVsZHMiLCJhYm91dCIsInByb2ZpbGVBYm91dCIsInBhdGNoQXZhdGFyIiwiYXZhdGFyTGluayIsIml0ZW1JZCIsImF1dGhvcml6YXRpb24iLCJmb3JtVmFsaWRhdG9ycyIsImNvbmZpZyIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwicG9wdXBDYXJkUmVuZGVyZXIiLCJfcG9wdXBDYXJkSW1hZ2UiLCJfcG9wdXBDYXJkVGl0bGUiLCJpdGVtIiwicG9wdXBEZWxldGVSZW5kZXJlciIsIl95ZXNCdG4iLCJfb25EZWxldGUiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsIm9uRGVsZXRlIiwidXNlckluZm8iLCJfZmllbGROYW1lIiwiX2ZpZWxkSW5mbyIsIl9waG90b0NvbnRhaW5lciIsImdldFVzZXJJbmZvIiwidXNlckluZm9MaXN0Iiwic2V0VXNlckluZm8iLCJ1c2VyIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiY2FyZFJlbmRlcmVyIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJfY29udGFpbmVyIiwiX2NsZWFyIiwiaW5uZXJIVE1MIiwiYWRkUHJlcGVuZEl0ZW0iLCJwcmVwZW5kIiwiYWRkQXBwZW5kSXRlbSIsImFwcGVuZCIsImNhcmRFbGVtZW50IiwicG9wdXBFZGl0QXZhdGFyUmVuZGVyZXIiLCJmaWVsZFZhbHVlIiwiZmluYWxseSIsImVkaXRQb3B1cEJlaGF2aW9yIiwiYWRkUG9wdXBCZWhhdmlvciIsImFkZEZpZWxkcyIsIm5ld0NhcmQiLCJwbGFjZVRpdGxlIiwicGxhY2VMaW5rIiwib3duZXIiLCJ1c2VyRGF0YSIsImFzeW5jIiwiaW5pdEFwcCJdLCJzb3VyY2VSb290IjoiIn0=